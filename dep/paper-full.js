/*!
 * Paper.js v0.9.25 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2014, Juerg Lehni & Jonathan Puckey
 * http://scratchdisk.com/ & http://jonathanpuckey.com/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Sun Oct 25 11:23:38 2015 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2013 Juerg Lehni
 * http://scratchdisk.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * http://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */
var paper=new function(t){var e=new function(){var n=/^(statics|enumerable|beans|preserve)$/,i=[].forEach||function(t,e){for(var n=0,i=this.length;n<i;n++)t.call(e,this[n],n,this)},r=function(t,e){for(var n in this)this.hasOwnProperty(n)&&t.call(e,this[n],n,this)},s=Object.create||function(t){return{__proto__:t}},a=Object.getOwnPropertyDescriptor||function(t,e){var n=t.__lookupGetter__&&t.__lookupGetter__(e);return n?{get:n,set:t.__lookupSetter__(e),enumerable:!0,configurable:!0}:t.hasOwnProperty(e)?{value:t[e],enumerable:!0,configurable:!0,writable:!0}:null},o=Object.defineProperty||function(t,e,n){return(n.get||n.set)&&t.__defineGetter__?(n.get&&t.__defineGetter__(e,n.get),n.set&&t.__defineSetter__(e,n.set)):t[e]=n.value,t},h=function(t,e,n){return delete t[e],o(t,e,n)};function u(t,i,r,s,o){var u={};function l(n,l){"string"==typeof(l=l||(l=a(i,n))&&(l.get?l:l.value))&&"#"===l[0]&&(l=t[l.substring(1)]||l);var c,d="function"==typeof l,f=l,_=o||d&&!l.base?l&&l.get?n in t:t[n]:null;o&&_||(d&&_&&(l.base=_),d&&!1!==s&&(c=n.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(u[c[3].toLowerCase()+c[4]]=c[2]),f&&!d&&f.get&&"function"==typeof f.get&&e.isPlainObject(f)||(f={value:f,writable:!0}),(a(t,n)||{configurable:!0}).configurable&&(f.configurable=!0,f.enumerable=r),h(t,n,f))}if(i){for(var c in i)i.hasOwnProperty(c)&&!n.test(c)&&l(c);for(var c in u){var d=u[c],f=t["set"+d],_=t["get"+d]||f&&t["is"+d];!_||!0!==s&&0!==_.length||l(c,{get:_,set:f})}}return t}function l(t,e,n){return t&&("length"in t&&!t.getLength&&"number"==typeof t.length?i:r).call(t,e,n=n||t),n}function c(t,e,n){for(var i in e)!e.hasOwnProperty(i)||n&&n[i]||(t[i]=e[i]);return t}return u((function(){for(var t=0,e=arguments.length;t<e;t++)c(this,arguments[t])}),{inject:function(t){if(t){var e=!0===t.statics?t:t.statics,n=t.beans,i=t.preserve;e!==t&&u(this.prototype,t,t.enumerable,n,i),u(this,e,!0,n,i)}for(var r=1,s=arguments.length;r<s;r++)this.inject(arguments[r]);return this},extend:function(){for(var t,e,n=this,i=0,r=arguments.length;i<r&&!(t=arguments[i].initialize);i++);return t=t||function(){n.apply(this,arguments)},e=t.prototype=s(this.prototype),h(e,"constructor",{value:t,writable:!0,configurable:!0}),u(t,this,!0),arguments.length&&this.inject.apply(t,arguments),t.base=n,t}},!0).inject({inject:function(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&u(this,n,n.enumerable,n.beans,n.preserve)}return this},extend:function(){var t=s(this);return t.inject.apply(t,arguments)},each:function(t,e){return l(this,t,e)},set:function(t){return c(this,t)},clone:function(){return new this.constructor(this)},statics:{each:l,create:s,define:h,describe:a,set:c,clone:function(t){return c(new t.constructor,t)},isPlainObject:function(t){var n=null!=t&&t.constructor;return n&&(n===Object||n===e||"Object"===n.name)},pick:function(e,n){return e!==t?e:n}}})};"undefined"!=typeof module&&(module.exports=e),e.inject({toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+e.each(this,(function(t,e){if(!/^_/.test(e)){var n=typeof t;this.push(e+": "+("number"===n?s.instance.number(t):"string"===n?"'"+t+"'":t))}}),[]).join(", ")+" }"},getClassName:function(){return this._class||""},exportJSON:function(t){return e.exportJSON(this,t)},toJSON:function(){return e.serialize(this)},_set:function(n,i,r){if(n&&(r||e.isPlainObject(n))){for(var s=Object.keys(n._filtering||n),a=0,o=s.length;a<o;a++){var h=s[a];if(!i||!i[h]){var u=n[h];u!==t&&(this[h]=u)}}return!0}},statics:{exports:{enumerable:!0},extend:function t(){var n=t.base.apply(this,arguments),i=n.prototype._class;return i&&!e.exports[i]&&(e.exports[i]=n),n},equals:function(t,n){if(t===n)return!0;if(t&&t.equals)return t.equals(n);if(n&&n.equals)return n.equals(t);if(t&&n&&"object"==typeof t&&"object"==typeof n){if(Array.isArray(t)&&Array.isArray(n)){if((i=t.length)!==n.length)return!1;for(;i--;)if(!e.equals(t[i],n[i]))return!1}else{var i,r=Object.keys(t);if((i=r.length)!==Object.keys(n).length)return!1;for(;i--;){var s=r[i];if(!n.hasOwnProperty(s)||!e.equals(t[s],n[s]))return!1}}return!0}return!1},read:function(n,i,r,s){if(this===e){var a=this.peek(n,i);return n.__index++,a}var o=this.prototype._readIndex,h=i||o&&n.__index||0;s||(s=n.length-h);var u=n[h];return u instanceof this||r&&r.readNull&&null==u&&s<=1?(o&&(n.__index=h+1),u&&r&&r.clone?u.clone():u):(u=e.create(this.prototype),o&&(u.__read=!0),u=u.initialize.apply(u,h>0||s<n.length?Array.prototype.slice.call(n,h,h+s):n)||u,o&&(n.__index=h+u.__read,u.__read=t),u)},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readAll:function(t,e,n){for(var i,r=[],s=e||0,a=t.length;s<a;s++)r.push(Array.isArray(i=t[s])?this.read(i,0,n):this.read(t,s,n,1));return r},readNamed:function(n,i,r,s,a){var o=this.getNamed(n,i),h=o!==t;if(h){var u=n._filtered;u||((u=n._filtered=e.create(n[0]))._filtering=n[0]),u[i]=t}return this.read(h?[o]:n,r,s,a)},getNamed:function(n,i){var r=n[0];if(n._hasObject===t&&(n._hasObject=1===n.length&&e.isPlainObject(r)),n._hasObject)return i?r[i]:n._filtered||r},hasNamed:function(t,e){return!!this.getNamed(t,e)},isPlainValue:function(t,e){return this.isPlainObject(t)||Array.isArray(t)||e&&"string"==typeof t},serialize:function(t,n,i,r){n=n||{};var a,o=!r;if(o&&(n.formatter=new s(n.precision),r={length:0,definitions:{},references:{},add:function(t,e){var n="#"+t._id,i=this.references[n];if(!i){this.length++;var r=e.call(t),s=t._class;s&&r[0]!==s&&r.unshift(s),this.definitions[n]=r,i=this.references[n]=[n]}return i}}),t&&t._serialize){a=t._serialize(n,r);var h=t._class;!h||i||a._compact||a[0]===h||a.unshift(h)}else if(Array.isArray(t)){a=[];for(var u=0,l=t.length;u<l;u++)a[u]=e.serialize(t[u],n,i,r);i&&(a._compact=!0)}else if(e.isPlainObject(t)){a={};var c=Object.keys(t);for(u=0,l=c.length;u<l;u++){var d=c[u];a[d]=e.serialize(t[d],n,i,r)}}else a="number"==typeof t?n.formatter.number(t,n.precision):t;return o&&r.length>0?[["dictionary",r.definitions],a]:a},deserialize:function(t,n,i,r){var s=t,a=!i;if(i=i||{},Array.isArray(t)){var o=t[0],h="dictionary"===o;if(1==t.length&&/^#/.test(o))return i.dictionary[o];o=e.exports[o],s=[],r&&(i.dictionary=s);for(var u=o?1:0,l=t.length;u<l;u++)s.push(e.deserialize(t[u],n,i,h));if(o){var c=s;n?s=n(o,c):(s=e.create(o.prototype),o.apply(s,c))}}else if(e.isPlainObject(t))for(var d in s={},r&&(i.dictionary=s),t)s[d]=e.deserialize(t[d],n,i);return a&&t&&t.length&&"dictionary"===t[0][0]?s[1]:s},exportJSON:function(t,n){var i=e.serialize(t,n);return n&&!1===n.asString?i:JSON.stringify(i)},importJSON:function(t,n){return e.deserialize("string"==typeof t?JSON.parse(t):t,(function(t,i){var r=n&&n.constructor===t?n:e.create(t.prototype),s=r===n;if(1===i.length&&r instanceof m&&(s||!(r instanceof w))){var a=i[0];e.isPlainObject(a)&&(a.insert=!1)}return t.apply(r,i),s&&(n=null),r}))},splice:function(e,n,i,r){var s=n&&n.length,a=i===t;(i=a?e.length:i)>e.length&&(i=e.length);for(var o=0;o<s;o++)n[o]._index=i+o;if(a)return e.push.apply(e,n),[];var h=[i,r];n&&h.push.apply(h,n);for(var u=e.splice.apply(e,h),l=(o=0,u.length);o<l;o++)u[o]._index=t;for(o=i+s,l=e.length;o<l;o++)e[o]._index=o;return u},capitalize:function(t){return t.replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}))},camelize:function(t){return t.replace(/-(.)/g,(function(t,e){return e.toUpperCase()}))},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var n={on:function(t,n){if("string"!=typeof t)e.each(t,(function(t,e){this.on(e,t)}),this);else{var i=this._eventTypes,r=i&&i[t],s=this._callbacks=this._callbacks||{};-1===(s=s[t]=s[t]||[]).indexOf(n)&&(s.push(n),r&&r.install&&1===s.length&&r.install.call(this,t))}return this},off:function(t,n){if("string"==typeof t){var i,r=this._eventTypes,s=r&&r[t],a=this._callbacks&&this._callbacks[t];return a&&(!n||-1!==(i=a.indexOf(n))&&1===a.length?(s&&s.uninstall&&s.uninstall.call(this,t),delete this._callbacks[t]):-1!==i&&a.splice(i,1)),this}e.each(t,(function(t,e){this.off(e,t)}),this)},once:function(t,e){return this.on(t,(function(){e.apply(this,arguments),this.off(t,e)}))},emit:function(t,e){var n=this._callbacks&&this._callbacks[t];if(!n)return!1;for(var i=[].slice.call(arguments,1),r=0,s=(n=n.slice()).length;r<s;r++)if(!1===n[r].apply(this,i)){e&&e.stop&&e.stop();break}return!0},responds:function(t){return!(!this._callbacks||!this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._callbacks,n=t?"install":"uninstall";for(var i in e)if(e[i].length>0){var r=this._eventTypes,s=r&&r[i],a=s&&s[n];a&&a.call(this,i)}},statics:{inject:function t(n){var i=n._events;if(i){var r={};e.each(i,(function(t,i){var s="string"==typeof t,a=s?t:i,o=e.capitalize(a),h=a.substring(2).toLowerCase();r[h]=s?{}:t,a="_"+a,n["get"+o]=function(){return this[a]},n["set"+o]=function(t){var e=this[a];e&&this.off(h,e),t&&this.on(h,t),this[a]=t}})),n._eventTypes=r}return t.base.apply(this,arguments)}}},i=e.extend({_class:"PaperScope",initialize:function t(){paper=this,this.settings=new e({applyMatrix:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this.palettes=[],this._id=t._id++,t._scopes[this._id]=this;var n=t.prototype;if(!this.support){var i=Y.getContext(1,1);n.support={nativeDash:"setLineDash"in i||"mozDash"in i,nativeBlendModes:K.nativeModes},Y.release(i)}if(!this.browser){var r=navigator.userAgent.toLowerCase(),s=(/(win)/.exec(r)||/(mac)/.exec(r)||/(linux)/.exec(r)||[])[0],a=n.browser={platform:s};s&&(a[s]=!0),r.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:([.\d]+))?/g,(function(t,e,n,i,r){if(!a.chrome){var s="opera"===e?i:n;"trident"===e&&(s=r,e="msie"),a.version=s,a.versionNumber=parseFloat(s),a.name=e,a[e]=!0}})),a.chrome&&delete a.webkit,a.atom&&delete a.chrome}},version:"0.9.25",getView:function(){return this.project&&this.project.getView()},getPaper:function(){return this},execute:function(t,e,n){paper.PaperScript.execute(t,this,e,n),V.updateFocus()},install:function(t){var n=this;for(var i in e.each(["project","view","tool"],(function(i){e.define(t,i,{configurable:!0,get:function(){return n[i]}})})),this)!/^_/.test(i)&&this[i]&&(t[i]=this[i])},setup:function(t){return paper=this,this.project=new p(t),this},activate:function(){paper=this},clear:function(){for(var t=this.projects.length-1;t>=0;t--)this.projects[t].remove();for(t=this.tools.length-1;t>=0;t--)this.tools[t].remove();for(t=this.palettes.length-1;t>=0;t--)this.palettes[t].remove()},remove:function(){this.clear(),delete i._scopes[this._id]},statics:new function(){function t(t){return t+="Attribute",function(e,n){return e[t](n)||e[t]("data-paper-"+n)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),r=e.extend(n,{initialize:function(t){this._scope=paper,this._index=this._scope[this._list].push(this)-1,!t&&this._scope[this._reference]||this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null!=this._index&&(e.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)}}),s=e.extend({initialize:function(t){this.precision=t||5,this.multiplier=Math.pow(10,this.precision)},number:function(t){return Math.round(t*this.multiplier)/this.multiplier},pair:function(t,e,n){return this.number(t)+(n||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});s.instance=new s;var a=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],n=Math.abs,i=Math.sqrt,r=Math.pow,s=1e-12,o=112e-18;function h(t,e,n){return t<e?e:t>n?n:t}return{TOLERANCE:1e-6,EPSILON:s,MACHINE_EPSILON:o,CURVETIME_EPSILON:4e-7,GEOMETRIC_EPSILON:2e-7,WINDING_EPSILON:2e-7,TRIGONOMETRIC_EPSILON:1e-7,CLIPPING_EPSILON:1e-7,KAPPA:4*(i(2)-1)/3,isZero:function(t){return t>=-1e-12&&t<=s},integrate:function(n,i,r,s){for(var a=t[s-2],o=e[s-2],h=.5*(r-i),u=h+i,l=0,c=s+1>>1,d=1&s?o[l++]*n(u):0;l<c;){var f=h*a[l];d+=o[l++]*(n(u+f)+n(u-f))}return h*d},findRoot:function(t,e,i,r,s,a,o){for(var h=0;h<a;h++){var u=t(i),l=u/e(i),c=i-l;if(n(l)<o)return c;u>0?(s=i,i=c<=r?.5*(r+s):c):(r=i,i=c>=s?.5*(r+s):c)}return i},solveQuadratic:function(t,e,a,u,l,c){var d,f,_=0,g=l-s,p=c+s,v=1/0,m=e;if(0!==(f=(e/=-2)*e-t*a)&&n(f)<o){var y=r(n(t*e*a),1/3);if(y<1e-8){var w=r(10,n(Math.floor(Math.log(y)*Math.LOG10E)));isFinite(w)||(w=0),f=(e*=w)*e-(t*=w)*(a*=w)}}if(n(t)<s){if(n(m)<s)return n(a)<s?-1:0;d=-a/m}else if(f>=-112e-18){var x=f<0?0:i(f),b=e+(e<0?-x:x);0===b?v=-(d=a/t):(d=b/t,v=a/b)}return isFinite(d)&&(null==l||d>g&&d<p)&&(u[_++]=null==l?d:h(d,l,c)),v!==d&&isFinite(v)&&(null==l||v>g&&v<p)&&(u[_++]=null==l?v:h(v,l,c)),_},solveCubic:function(t,e,u,l,c,d,f){var _,g,p,v=0;if(n(t)<s)t=e,g=u,p=l,_=1/0;else if(n(l)<s)g=e,p=u,_=0;else{var m,y,w,x,b,C,S,P=1+o;if(w=((S=t*(_=-e/t/3))+(g=S+e))*_+(p=g*_+u),b=r(n(x=(y=p*_+l)/t),1/3),(m=_-(C=x<0?-1:1)*(b=(x=-w/t)>0?1.3247179572*Math.max(b,i(x)):b))!==_){do{if(y=(p=(g=(S=t*(_=m))+e)*_+u)*_+l,(m=0===(w=(S+g)*_+p)?_:_-y/w/P)===_){_=m;break}}while(C*m>C*_);n(t)*_*_>n(l/_)&&(g=((p=-l/_)-u)/_)}}v=a.solveQuadratic(t,g,p,c,d,f);return isFinite(_)&&(0===v||_!==c[v-1])&&(null==d||_>d-s&&_<f+s)&&(c[v++]=null==d?_:h(_,d,f)),v}}},o={_id:1,_pools:{},get:function(t){if(t){var e=t._class,n=this._pools[e];return n||(n=this._pools[e]={_id:1}),n._id++}return this._id++}},h=e.extend({_class:"Point",_readIndex:!0,initialize:function(t,e){var n=typeof t;if("number"===n){var i="number"==typeof e;this.x=t,this.y=i?e:t,this.__read&&(this.__read=i?2:1)}else"undefined"===n||null===t?(this.x=this.y=0,this.__read&&(this.__read=null===t?1:0)):(Array.isArray(t)?(this.x=t[0],this.y=t.length>1?t[1]:t[0]):null!=t.x?(this.x=t.x,this.y=t.y):null!=t.width?(this.x=t.width,this.y=t.height):null!=t.angle?(this.x=t.length,this.y=0,this.setAngle(t.angle)):(this.x=this.y=0,this.__read&&(this.__read=0)),this.__read&&(this.__read=1))},set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new h(this.x,this.y)},toString:function(){var t=s.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this.set(Math.cos(e)*t,Math.sin(e)*t)}else{var n=t/this.getLength();a.isZero(n)&&this.getAngle(),this.set(this.x*n,this.y*n)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=h.read(arguments),e=this.getLength()*t.getLength();if(a.isZero(e))return NaN;var n=this.dot(t)/e;return Math.acos(n<-1?-1:n>1?1:n)}return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this.set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=h.read(arguments);return 180*Math.atan2(this.cross(t),this.dot(t))/Math.PI},getDistance:function(){var t=h.read(arguments),n=t.x-this.x,i=t.y-this.y,r=n*n+i*i;return e.read(arguments)?r:Math.sqrt(r)},normalize:function(e){e===t&&(e=1);var n=this.getLength(),i=0!==n?e/n:0,r=new h(this.x*i,this.y*i);return i>=0&&(r._angle=this._angle),r},rotate:function(t,e){if(0===t)return this.clone();t=t*Math.PI/180;var n=e?this.subtract(e):this,i=Math.sin(t),r=Math.cos(t);return n=new h(n.x*r-n.y*i,n.x*i+n.y*r),e?n.add(e):n},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=h.read(arguments);return new h(this.x+t.x,this.y+t.y)},subtract:function(){var t=h.read(arguments);return new h(this.x-t.x,this.y-t.y)},multiply:function(){var t=h.read(arguments);return new h(this.x*t.x,this.y*t.y)},divide:function(){var t=h.read(arguments);return new h(this.x/t.x,this.y/t.y)},modulo:function(){var t=h.read(arguments);return new h(this.x%t.x,this.y%t.y)},negate:function(){return new h(-this.x,-this.y)},isInside:function(){return d.read(arguments).contains(this)},isClose:function(){var t=h.read(arguments),n=e.read(arguments);return this.getDistance(t)<n},isCollinear:function(){var t=h.read(arguments);return h.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=h.read(arguments);return h.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){return a.isZero(this.x)&&a.isZero(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},dot:function(){var t=h.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=h.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=h.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new h(t.x*e,t.y*e)},statics:{min:function(){var t=h.read(arguments),e=h.read(arguments);return new h(Math.min(t.x,e.x),Math.min(t.y,e.y))},max:function(){var t=h.read(arguments),e=h.read(arguments);return new h(Math.max(t.x,e.x),Math.max(t.y,e.y))},random:function(){return new h(Math.random(),Math.random())},isCollinear:function(t,e,n,i){return Math.abs(t*i-e*n)<=1e-7*Math.sqrt((t*t+e*e)*(n*n+i*i))},isOrthogonal:function(t,e,n,i){return Math.abs(t*n+e*i)<=1e-7*Math.sqrt((t*t+e*e)*(n*n+i*i))}}},e.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new h(e(this.x),e(this.y))}}),{})),u=h.extend({initialize:function(t,e,n,i){this._x=t,this._y=e,this._owner=n,this._setter=i},set:function(t,e,n){return this._x=t,this._y=e,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)}}),l=e.extend({_class:"Size",_readIndex:!0,initialize:function(t,e){var n=typeof t;if("number"===n){var i="number"==typeof e;this.width=t,this.height=i?e:t,this.__read&&(this.__read=i?2:1)}else"undefined"===n||null===t?(this.width=this.height=0,this.__read&&(this.__read=null===t?1:0)):(Array.isArray(t)?(this.width=t[0],this.height=t.length>1?t[1]:t[0]):null!=t.width?(this.width=t.width,this.height=t.height):null!=t.x?(this.width=t.x,this.height=t.y):(this.width=this.height=0,this.__read&&(this.__read=0)),this.__read&&(this.__read=1))},set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new l(this.width,this.height)},toString:function(){var t=s.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=l.read(arguments);return new l(this.width+t.width,this.height+t.height)},subtract:function(){var t=l.read(arguments);return new l(this.width-t.width,this.height-t.height)},multiply:function(){var t=l.read(arguments);return new l(this.width*t.width,this.height*t.height)},divide:function(){var t=l.read(arguments);return new l(this.width/t.width,this.height/t.height)},modulo:function(){var t=l.read(arguments);return new l(this.width%t.width,this.height%t.height)},negate:function(){return new l(-this.width,-this.height)},isZero:function(){return a.isZero(this.width)&&a.isZero(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new l(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new l(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new l(Math.random(),Math.random())}}},e.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new l(e(this.width),e(this.height))}}),{})),c=l.extend({initialize:function(t,e,n,i){this._width=t,this._height=e,this._owner=n,this._setter=i},set:function(t,e,n){return this._width=t,this._height=e,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),d=e.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(n,i,r,s){var a=typeof n,o=0;if("number"===a?(this.x=n,this.y=i,this.width=r,this.height=s,o=4):"undefined"===a||null===n?(this.x=this.y=this.width=this.height=0,o=null===n?1:0):1===arguments.length&&(Array.isArray(n)?(this.x=n[0],this.y=n[1],this.width=n[2],this.height=n[3],o=1):n.x!==t||n.width!==t?(this.x=n.x||0,this.y=n.y||0,this.width=n.width||0,this.height=n.height||0,o=1):n.from===t&&n.to===t&&(this.x=this.y=this.width=this.height=0,this._set(n),o=1)),!o){var u=h.readNamed(arguments,"from"),c=e.peek(arguments);if(this.x=u.x,this.y=u.y,c&&c.x!==t||e.hasNamed(arguments,"to")){var d=h.readNamed(arguments,"to");this.width=d.x-u.x,this.height=d.y-u.y,this.width<0&&(this.x=d.x,this.width=-this.width),this.height<0&&(this.y=d.y,this.height=-this.height)}else{var f=l.read(arguments);this.width=f.width,this.height=f.height}o=arguments.__index}this.__read&&(this.__read=o)},set:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},clone:function(){return new d(this.x,this.y,this.width,this.height)},equals:function(t){var n=e.isPlainValue(t)?d.read(arguments):t;return n===this||n&&this.x===n.x&&this.y===n.y&&this.width===n.width&&this.height===n.height||!1},toString:function(){var t=s.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){return new(t?h:u)(this.x,this.y,this,"setPoint")},setPoint:function(){var t=h.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){return new(t?l:c)(this.width,this.height,this,"setSize")},setSize:function(){var t=l.read(arguments);this._fixX&&(this.x+=(this.width-t.width)*this._fixX),this._fixY&&(this.y+=(this.height-t.height)*this._fixY),this.width=t.width,this.height=t.height,this._fixW=1,this._fixH=1},getLeft:function(){return this.x},setLeft:function(t){this._fixW||(this.width-=t-this.x),this.x=t,this._fixX=0},getTop:function(){return this.y},setTop:function(t){this._fixH||(this.height-=t-this.y),this.y=t,this._fixY=0},getRight:function(){return this.x+this.width},setRight:function(e){this._fixX!==t&&1!==this._fixX&&(this._fixW=0),this._fixW?this.x=e-this.width:this.width=e-this.x,this._fixX=1},getBottom:function(){return this.y+this.height},setBottom:function(e){this._fixY!==t&&1!==this._fixY&&(this._fixH=0),this._fixH?this.y=e-this.height:this.height=e-this.y,this._fixY=1},getCenterX:function(){return this.x+.5*this.width},setCenterX:function(t){this.x=t-.5*this.width,this._fixX=.5},getCenterY:function(){return this.y+.5*this.height},setCenterY:function(t){this.y=t-.5*this.height,this._fixY=.5},getCenter:function(t){return new(t?h:u)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=h.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(e){return e&&e.width!==t||4==(Array.isArray(e)?e:arguments).length?this._containsRectangle(d.read(arguments)):this._containsPoint(h.read(arguments))},_containsPoint:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e+t.width<=this.x+this.width&&n+t.height<=this.y+this.height},intersects:function(){var t=d.read(arguments);return t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x+this.width&&t.y<this.y+this.height},touches:function(){var t=d.read(arguments);return t.x+t.width>=this.x&&t.y+t.height>=this.y&&t.x<=this.x+this.width&&t.y<=this.y+this.height},intersect:function(){var t=d.read(arguments),e=Math.max(this.x,t.x),n=Math.max(this.y,t.y),i=Math.min(this.x+this.width,t.x+t.width),r=Math.min(this.y+this.height,t.y+t.height);return new d(e,n,i-e,r-n)},unite:function(){var t=d.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x+t.width),r=Math.max(this.y+this.height,t.y+t.height);return new d(e,n,i-e,r-n)},include:function(){var t=h.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x),r=Math.max(this.y+this.height,t.y);return new d(e,n,i-e,r-n)},expand:function(){var t=l.read(arguments),e=t.width,n=t.height;return new d(this.x-e/2,this.y-n/2,this.width+e,this.height+n)},scale:function(e,n){return this.expand(this.width*e-this.width,this.height*(n===t?e:n)-this.height)}},e.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],(function(t,e){var n=t.join(""),i=/^[RL]/.test(n);e>=4&&(t[1]+=i?"Y":"X");var r=t[i?0:1],s=t[i?1:0],a="get"+r,o="get"+s,l="set"+r,c="set"+s,d="set"+n;this["get"+n]=function(t){return new(t?h:u)(this[a](),this[o](),this,d)},this[d]=function(){var t=h.read(arguments);this[l](t.x),this[c](t.y)}}),{beans:!0})),f=d.extend({initialize:function(t,e,n,i,r,s){this.set(t,e,n,i,!0),this._owner=r,this._setter=s},set:function(t,e,n,i,r){return this._x=t,this._y=e,this._width=n,this._height=i,r||this._owner[this._setter](this),this}},new function(){var t=d.prototype;return e.each(["x","y","width","height"],(function(t){var n=e.capitalize(t),i="_"+t;this["get"+n]=function(){return this[i]},this["set"+n]=function(t){this[i]=t,this._dontNotify||this._owner[this._setter](this)}}),e.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],(function(e){var n="set"+e;this[n]=function(){this._dontNotify=!0,t[n].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}}),{isSelected:function(){return this._owner._boundsSelected},setSelected:function(t){var e=this._owner;e.setSelected&&(e._boundsSelected=t,e.setSelected(t||e._selectedSegmentState>0))}}))}),_=e.extend({_class:"Matrix",initialize:function t(e){var n=arguments.length,i=!0;if(6===n?this.set.apply(this,arguments):1===n?e instanceof t?this.set(e._a,e._c,e._b,e._d,e._tx,e._ty):Array.isArray(e)?this.set.apply(this,e):i=!1:0===n?this.reset():i=!1,!i)throw new Error("Unsupported matrix parameters")},set:function(t,e,n,i,r,s,a){return this._a=t,this._c=e,this._b=n,this._d=i,this._tx=r,this._ty=s,a||this._changed(),this},_serialize:function(t){return e.serialize(this.getValues(),t)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(9))},clone:function(){return new _(this._a,this._c,this._b,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty||!1},toString:function(){var t=s.instance;return"[["+[t.number(this._a),t.number(this._b),t.number(this._tx)].join(", ")+"], ["+[t.number(this._c),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._c=this._b=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,n){var i=this._owner;return!!i&&(i.transform(null,!0,e.pick(t,!0),n),this.isIdentity())},translate:function(){var t=h.read(arguments),e=t.x,n=t.y;return this._tx+=e*this._a+n*this._b,this._ty+=e*this._c+n*this._d,this._changed(),this},scale:function(){var t=h.read(arguments),e=h.read(arguments,0,{readNull:!0});return e&&this.translate(e),this._a*=t.x,this._c*=t.x,this._b*=t.y,this._d*=t.y,e&&this.translate(e.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=h.read(arguments,1),n=e.x,i=e.y,r=Math.cos(t),s=Math.sin(t),a=n-n*r+i*s,o=i-n*s-i*r,u=this._a,l=this._b,c=this._c,d=this._d;return this._a=r*u+s*l,this._b=-s*u+r*l,this._c=r*c+s*d,this._d=-s*c+r*d,this._tx+=a*u+o*l,this._ty+=a*c+o*d,this._changed(),this},shear:function(){var t=h.read(arguments),e=h.read(arguments,0,{readNull:!0});e&&this.translate(e);var n=this._a,i=this._c;return this._a+=t.y*this._b,this._c+=t.y*this._d,this._b+=t.x*n,this._d+=t.x*i,e&&this.translate(e.negate()),this._changed(),this},skew:function(){var t=h.read(arguments),e=h.read(arguments,0,{readNull:!0}),n=Math.PI/180,i=new h(Math.tan(t.x*n),Math.tan(t.y*n));return this.shear(i,e)},concatenate:function(t){var e=this._a,n=this._b,i=this._c,r=this._d,s=t._a,a=t._b,o=t._c,h=t._d,u=t._tx,l=t._ty;return this._a=s*e+o*n,this._b=a*e+h*n,this._c=s*i+o*r,this._d=a*i+h*r,this._tx+=u*e+l*n,this._ty+=u*i+l*r,this._changed(),this},preConcatenate:function(t){var e=this._a,n=this._b,i=this._c,r=this._d,s=this._tx,a=this._ty,o=t._a,h=t._b,u=t._c,l=t._d,c=t._tx,d=t._ty;return this._a=o*e+h*i,this._b=o*n+h*r,this._c=u*e+l*i,this._d=u*n+l*r,this._tx=o*s+h*a+c,this._ty=u*s+l*a+d,this._changed(),this},chain:function(t){var e=this._a,n=this._b,i=this._c,r=this._d,s=this._tx,a=this._ty,o=t._a,h=t._b,u=t._c,l=t._d,c=t._tx,d=t._ty;return new _(o*e+u*n,o*i+u*r,h*e+l*n,h*i+l*r,s+c*e+d*n,a+c*i+d*r)},isIdentity:function(){return 1===this._a&&0===this._c&&0===this._b&&1===this._d&&0===this._tx&&0===this._ty},orNullIfIdentity:function(){return this.isIdentity()?null:this},isInvertible:function(){return!!this._getDeterminant()},isSingular:function(){return!this._getDeterminant()},transform:function(t,e,n){return arguments.length<3?this._transformPoint(h.read(arguments)):this._transformCoordinates(t,e,n)},_transformPoint:function(t,e,n){var i=t.x,r=t.y;return e||(e=new h),e.set(i*this._a+r*this._b+this._tx,i*this._c+r*this._d+this._ty,n)},_transformCoordinates:function(t,e,n){for(var i=0,r=0,s=2*n;i<s;){var a=t[i++],o=t[i++];e[r++]=a*this._a+o*this._b+this._tx,e[r++]=a*this._c+o*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,n=t.y,i=e+t.width,r=n+t.height,s=[e,n,i,n,i,r,e,r];return this._transformCoordinates(s,s,4)},_transformBounds:function(t,e,n){for(var i=this._transformCorners(t),r=i.slice(0,2),s=r.slice(),a=2;a<8;a++){var o=i[a],h=1&a;o<r[h]?r[h]=o:o>s[h]&&(s[h]=o)}return e||(e=new d),e.set(r[0],r[1],s[0]-r[0],s[1]-r[1],n)},inverseTransform:function(){return this._inverseTransform(h.read(arguments))},_getDeterminant:function(){var t=this._a*this._d-this._b*this._c;return isFinite(t)&&!a.isZero(t)&&isFinite(this._tx)&&isFinite(this._ty)?t:null},_inverseTransform:function(t,e,n){var i=this._getDeterminant();if(!i)return null;var r=t.x-this._tx,s=t.y-this._ty;return e||(e=new h),e.set((r*this._d-s*this._b)/i,(s*this._a-r*this._c)/i,n)},decompose:function(){var t=this._a,e=this._b,n=this._c,i=this._d;if(a.isZero(t*i-e*n))return null;var r=Math.sqrt(t*t+e*e),s=(t/=r)*n+(e/=r)*i;n-=t*s,i-=e*s;var o=Math.sqrt(n*n+i*i);return s/=o,t*(i/=o)<e*(n/=o)&&(t=-t,e=-e,s=-s,r=-r),{scaling:new h(r,o),rotation:180*-Math.atan2(e,t)/Math.PI,shearing:s}},getValues:function(){return[this._a,this._c,this._b,this._d,this._tx,this._ty]},getTranslation:function(){return new h(this._tx,this._ty)},getScaling:function(){return(this.decompose()||{}).scaling},getRotation:function(){return(this.decompose()||{}).rotation},inverted:function(){var t=this._getDeterminant();return t&&new _(this._d/t,-this._c/t,-this._b/t,this._a/t,(this._b*this._ty-this._d*this._tx)/t,(this._c*this._tx-this._a*this._ty)/t)},shiftless:function(){return new _(this._a,this._c,this._b,this._d,0,0)},applyToContext:function(t){t.transform(this._a,this._c,this._b,this._d,this._tx,this._ty)}},e.each(["a","c","b","d","tx","ty"],(function(t){var n=e.capitalize(t),i="_"+t;this["get"+n]=function(){return this[i]},this["set"+n]=function(t){this[i]=t,this._changed()}}),{})),g=e.extend({_class:"Line",initialize:function(t,e,n,i,r){var s=!1;arguments.length>=4?(this._px=t,this._py=e,this._vx=n,this._vy=i,s=r):(this._px=t.x,this._py=t.y,this._vx=e.x,this._vy=e.y,s=n),s||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new h(this._px,this._py)},getVector:function(){return new h(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return g.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return g.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(g.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0))},isCollinear:function(t){return h.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return h.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,n,i,r,s,o,u,l,c){l||(n-=t,i-=e,o-=r,u-=s);var d=n*u-i*o;if(!a.isZero(d)){var f=t-r,_=e-s,g=(o*_-u*f)/d,p=(n*_-i*f)/d,v=-1e-12,m=1+1e-12;if(c||v<g&&g<m&&v<p&&p<m)return c||(g=g<=0?0:g>=1?1:g),new h(t+g*n,e+g*i)}},getSide:function(t,e,n,i,r,s,a,o){a||(n-=t,i-=e);var h=r-t,u=h*i-(s-e)*n;return 0!==u||o||(u=(h*n+h*n)/(n*n+i*i))>=0&&u<=1&&(u=0),u<0?-1:u>0?1:0},getSignedDistance:function(t,e,n,i,r,s,a){return a||(n-=t,i-=e),0===n?i>0?r-t:t-r:0===i?n<0?s-e:e-s:((r-t)*i-(s-e)*n)/Math.sqrt(n*n+i*i)}}}),p=r.extend({_class:"Project",_list:"projects",_reference:"project",initialize:function(t){r.call(this,!0),this.layers=[],this._activeLayer=null,this.symbols=[],this._currentStyle=new D(null,null,this),this._view=V.create(this,t||Y.getCanvas(1,1)),this._selectedItems={},this._selectedItemCount=0,this._updateVersion=0},_serialize:function(t,n){return e.serialize(this.layers,t,!0,n)},clear:function(){for(var t=this.layers.length-1;t>=0;t--)this.layers[t].remove();this.symbols=[]},isEmpty:function(){return 0===this.layers.length},remove:function t(){return!!t.base.call(this)&&(this._view&&this._view.remove(),!0)},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.initialize(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getActiveLayer:function(){return this._activeLayer||new w({project:this})},getSelectedItems:function(){var t=[];for(var e in this._selectedItems){var n=this._selectedItems[e];n.isInserted()&&t.push(n)}return t},insertChild:function(t,n,i){return n instanceof w?(n._remove(!1,!0),e.splice(this.layers,[n],t,0),n._setProject(this,!0),this._changes&&n._changed(5),this._activeLayer||(this._activeLayer=n)):n instanceof m?(this._activeLayer||this.insertChild(t,new w(m.NO_INSERT))).insertChild(t,n,i):n=null,n},addChild:function(e,n){return this.insertChild(t,e,n)},_updateSelection:function(t){var e=t._id,n=this._selectedItems;t._selected?n[e]!==t&&(this._selectedItemCount++,n[e]=t):n[e]===t&&(this._selectedItemCount--,delete n[e])},selectAll:function(){for(var t=this.layers,e=0,n=t.length;e<n;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectedItems;for(var e in t)t[e].setFullySelected(!1)},hitTest:function(){for(var t=h.read(arguments),n=S.getOptions(e.read(arguments)),i=this.layers.length-1;i>=0;i--){var r=this.layers[i]._hitTest(t,n);if(r)return r}return null},getItems:function(t){return m._getItems(this.layers,t)},getItem:function(t){return m._getItems(this.layers,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var n=this._activeLayer;return e.importJSON(t,n&&n.isEmpty()&&n)},draw:function(t,n,i){this._updateVersion++,t.save(),n.applyToContext(t);for(var r=new e({offset:new h(0,0),pixelRatio:i,viewMatrix:n.isIdentity()?null:n,matrices:[new _],updateMatrix:!0}),s=0,a=this.layers,o=a.length;s<o;s++)a[s].draw(t,r);if(t.restore(),this._selectedItemCount>0){t.save(),t.strokeWidth=1;var u=this._selectedItems,l=this._scope.settings.handleSize,c=this._updateVersion;for(var d in u)u[d]._drawSelection(t,n,l,u,c);t.restore()}}}),v=e.extend({_class:"Symbol",initialize:function(t,e){this._id=o.get(),this.project=paper.project,this.project.symbols.push(this),t&&this.setDefinition(t,e)},_serialize:function(t,n){return n.add(this,(function(){return e.serialize([this._class,this._definition],t,!1,n)}))},_changed:function(t){8&t&&m._clearBoundsCache(this),1&t&&(this.project._needsUpdate=!0)},getDefinition:function(){return this._definition},setDefinition:function(t,e){t._parentSymbol&&(t=t.clone()),this._definition&&(this._definition._parentSymbol=null),this._definition=t,t.remove(),t.setSelected(!1),e||t.setPosition(new h),t._parentSymbol=this,this._changed(9)},place:function(t){return new C(this,t)},clone:function(){return new v(this._definition.clone(!1))},equals:function(t){return t===this||t&&this.definition.equals(t.definition)||!1}}),m=e.extend(n,{statics:{extend:function t(n){return n._serializeFields&&(n._serializeFields=new e(this.prototype._serializeFields,n._serializeFields)),t.base.apply(this,arguments)},NO_INSERT:{insert:!1}},_class:"Item",_applyMatrix:!0,_canApplyMatrix:!0,_boundsSelected:!1,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new _,pivot:null,locked:!1,visible:!0,blendMode:"normal",opacity:1,guide:!1,selected:!1,clipMask:!1,data:{}},initialize:function(){},_initialize:function(t,n){var i=t&&e.isPlainObject(t),r=i&&!0===t.internal,s=this._matrix=new _,a=i&&t.project||paper.project;return r||(this._id=o.get()),this._applyMatrix=this._canApplyMatrix&&paper.settings.applyMatrix,n&&s.translate(n),s._owner=this,this._style=new D(a._currentStyle,this,a),this._project||(r||i&&!1===t.insert?this._setProject(a):i&&t.parent?this.setParent(t.parent):(a._activeLayer||new w).addChild(this)),i&&t!==m.NO_INSERT&&this._set(t,{insert:!0,project:!0,parent:!0},!0),i},_events:e.each(["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"],(function(t){this[t]={install:function(t){this.getView()._installEvent(t)},uninstall:function(t){this.getView()._uninstallEvent(t)}}}),{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{}}),_serialize:function(t,n){var i={},r=this;function s(s){for(var a in s){var o=r[a];e.equals(o,"leading"===a?1.2*s.fontSize:s[a])||(i[a]=e.serialize(o,t,"data"!==a,n))}}return s(this._serializeFields),this instanceof y||s(this._style._defaults),[this._class,i]},_changed:function(e){var n=this._parentSymbol,i=this._parent||n,r=this._project;if(8&e&&(this._bounds=this._position=this._decomposed=this._globalMatrix=this._currentPath=t),i&&40&e&&m._clearBoundsCache(i),2&e&&m._clearBoundsCache(this),r&&(1&e&&(r._needsUpdate=!0),r._changes)){var s=r._changesById[this._id];s?s.flags|=e:(s={item:this,flags:e},r._changesById[this._id]=s,r._changes.push(s))}n&&n._changed(e)},set:function(t){return t&&this._set(t),this},getId:function(){return this._id},getName:function(){return this._name},setName:function(e,n){if(this._name&&this._removeNamed(),e===+e+"")throw new Error("Names consisting only of numbers are not supported.");var i=this._parent;if(e&&i){for(var r=i._children,s=i._namedChildren,a=e,o=1;n&&r[e];)e=a+" "+o++;(s[e]=s[e]||[]).push(this),r[e]=this}this._name=e||t,this._changed(128)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},e.each(["locked","visible","blendMode","opacity","guide"],(function(t){var n=e.capitalize(t);t="_"+t;this["get"+n]=function(){return this[t]},this["set"+n]=function(e){e!=this[t]&&(this[t]=e,this._changed("_locked"===t?128:129))}}),{}),{beans:!0,_locked:!1,_visible:!0,_blendMode:"normal",_opacity:1,_guide:!1,isSelected:function(){if(this._selectChildren)for(var t=this._children,e=0,n=t.length;e<n;e++)if(t[e].isSelected())return!0;return this._selected},setSelected:function(t,e){if(!e&&this._selectChildren)for(var n=this._children,i=0,r=n.length;i<r;i++)n[i].setSelected(t);(t=!!t)^this._selected&&(this._selected=t,this._project._updateSelection(this),this._changed(129))},_selected:!1,isFullySelected:function(){var t=this._children;if(t&&this._selected){for(var e=0,n=t.length;e<n;e++)if(!t[e].isFullySelected())return!1;return!0}return this._selected},setFullySelected:function(t){var e=this._children;if(e)for(var n=0,i=e.length;n<i;n++)e[n].setFullySelected(t);this.setSelected(t,!0)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(129),this._parent&&this._parent._changed(1024))},_clipMask:!1,getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=this._position,n=t?h:u;if(!e){var i=this._pivot;e=this._position=i?this._matrix._transformPoint(i):this.getBounds().getCenter(!0)}return new n(e.x,e.y,this,"setPosition")},setPosition:function(){this.translate(h.read(arguments).subtract(this.getPosition(!0)))},getPivot:function(t){var e=this._pivot;e&&(e=new(t?h:u)(e.x,e.y,this,"setPivot"));return e},setPivot:function(){this._pivot=h.read(arguments,0,{clone:!0,readNull:!0}),this._position=t},_pivot:null},e.each(["bounds","strokeBounds","handleBounds","roughBounds","internalBounds","internalRoughBounds"],(function(t){var n="get"+e.capitalize(t),i=t.match(/^internal(.*)$/),r=i?"get"+i[1]:null;this[n]=function(e){var i=this._boundsGetter,s=!r&&("string"==typeof i?i:i&&i[n])||n,a=this._getCachedBounds(s,e,this,r);return"bounds"===t?new f(a.x,a.y,a.width,a.height,this,"setBounds"):a}}),{beans:!0,_getBounds:function(t,e,n){var i=this._children;if(!i||0==i.length)return new d;m._updateBoundsCache(this,n);for(var r=1/0,s=-r,a=r,o=s,h=0,u=i.length;h<u;h++){var l=i[h];if(l._visible&&!l.isEmpty()){var c=l._getCachedBounds(t,e&&e.chain(l._matrix),n);r=Math.min(c.x,r),a=Math.min(c.y,a),s=Math.max(c.x+c.width,s),o=Math.max(c.y+c.height,o)}}return isFinite(r)?new d(r,a,s-r,o-a):new d},setBounds:function(){var t=d.read(arguments),e=this.getBounds(),n=new _,i=t.getCenter();n.translate(i),t.width==e.width&&t.height==e.height||n.scale(0!=e.width?t.width/e.width:1,0!=e.height?t.height/e.height:1),i=e.getCenter(),n.translate(-i.x,-i.y),this.transform(n)},_getCachedBounds:function(t,e,n,i){e=e&&e.orNullIfIdentity();var r=i?null:this._matrix.orNullIfIdentity(),s=(!e||e.equals(r))&&t;if(m._updateBoundsCache(this._parent||this._parentSymbol,n),s&&this._bounds&&this._bounds[s])return this._bounds[s].clone();var a=this._getBounds(i||t,e||r,n);s&&(this._bounds||(this._bounds={}),(this._bounds[s]=a.clone())._internal=!!i);return a},statics:{_updateBoundsCache:function(t,e){if(t){var n=e._id,i=t._boundsCache=t._boundsCache||{ids:{},list:[]};i.ids[n]||(i.list.push(e),i.ids[n]=e)}},_clearBoundsCache:function(e){var n=e._boundsCache;if(n){e._bounds=e._position=e._boundsCache=t;for(var i=0,r=n.list,s=r.length;i<s;i++){var a=r[i];a!==e&&(a._bounds=a._position=t,a._boundsCache&&m._clearBoundsCache(a))}}}}}),{beans:!0,_decompose:function(){return this._decomposed=this._matrix.decompose()},getRotation:function(){var t=this._decomposed||this._decompose();return t&&t.rotation},setRotation:function(t){var e=this.getRotation();if(null!=e&&null!=t){var n=this._decomposed;this.rotate(t-e),n.rotation=t,this._decomposed=n}},getScaling:function(t){var e=this._decomposed||this._decompose(),n=e&&e.scaling;return n&&new(t?h:u)(n.x,n.y,this,"setScaling")},setScaling:function(){var t=this.getScaling();if(t){var e=h.read(arguments,0,{clone:!0}),n=this._decomposed;this.scale(e.x/t.x,e.y/t.y),n.scaling=e,this._decomposed=n}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.initialize.apply(t,arguments),this._applyMatrix?this.transform(null,!0):this._changed(9)},getGlobalMatrix:function(t){var e=this._globalMatrix,n=this._project._updateVersion;if(e&&e._updateVersion!==n&&(e=null),!e){e=this._globalMatrix=this._matrix.clone();var i=this._parent;i&&e.preConcatenate(i.getGlobalMatrix(!0)),e._updateVersion=n}return t?e:e.clone()},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project.getView()},_installEvents:function t(e){t.base.call(this,e);for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof w)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){return this._parent&&this._parent._children[this._index+1]||null},getPreviousSibling:function(){return this._parent&&this._parent._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return e.equals(this._children,t._children)},clone:function(t){return this._clone(new this.constructor(m.NO_INSERT),t)},_clone:function(n,i,r){var s=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],a=this._children;n.setStyle(this._style);for(var o=0,h=a&&a.length;o<h;o++)n.addChild(a[o].clone(!1),!0);for(o=0,h=s.length;o<h;o++){var u=s[o];this.hasOwnProperty(u)&&(n[u]=this[u])}return!1!==r&&n._matrix.initialize(this._matrix),n.setApplyMatrix(this._applyMatrix),n.setPivot(this._pivot),n.setSelected(this._selected),n._data=this._data?e.clone(this._data):null,(i||i===t)&&n.insertAbove(this),this._name&&n.setName(this._name,!0),n},copyTo:function(t){return t.addChild(this.clone(!1))},rasterize:function(t){var n=this.getStrokeBounds(),i=(t||this.getView().getResolution())/72,r=n.getTopLeft().floor(),s=n.getBottomRight().ceil(),a=new l(s.subtract(r)),o=Y.getCanvas(a.multiply(i)),h=o.getContext("2d"),u=(new _).scale(i).translate(r.negate());h.save(),u.applyToContext(h),this.draw(h,new e({matrices:[u]})),h.restore();var c=new b(m.NO_INSERT);return c.setCanvas(o),c.transform((new _).translate(r.add(a.divide(2))).scale(1/i)),c.insertAbove(this),c},contains:function(){return!!this._contains(this._matrix._inverseTransform(h.read(arguments)))},_contains:function(t){if(this._children){for(var e=this._children.length-1;e>=0;e--)if(this._children[e].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return d.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new A.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof m&&this._asPathItem().getIntersections(t._asPathItem(),null,e||t._matrix,!0).length>0},hitTest:function(){return this._hitTest(h.read(arguments),S.getOptions(e.read(arguments)))},_hitTest:function(t,n){if(this._locked||!this._visible||this._guide&&!n.guides||this.isEmpty())return null;var i=this._matrix,r=n._totalMatrix,s=this.getView(),a=n._totalMatrix=r?r.chain(i):this.getGlobalMatrix().preConcatenate(s._matrix),o=n._tolerancePadding=new l(A._getPenPadding(1,a.inverted())).multiply(Math.max(n.tolerance,1e-6));if(t=i._inverseTransform(t),!this._children&&!this.getInternalRoughBounds().expand(o.multiply(2))._containsPoint(t))return null;var h,u=!(n.guides&&!this._guide||n.selected&&!this._selected||n.type&&n.type!==e.hyphenate(this._class)||n.class&&!(this instanceof n.class)),c=this;function d(n,i){var r=f["get"+i]();if(t.subtract(r).divide(o).length<=1)return new S(n,c,{name:e.hyphenate(i),point:r})}if(u&&(n.center||n.bounds)&&this._parent){var f=this.getInternalBounds();if(n.center&&(h=d("center","Center")),!h&&n.bounds)for(var _=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],g=0;g<8&&!h;g++)h=d("bounds",_[g])}var p=!h&&this._children;if(p){var v=this._getChildHitTestOptions(n);for(g=p.length-1;g>=0&&!h;g--)h=p[g]._hitTest(t,v)}return!h&&u&&(h=this._hitTestSelf(t,n)),h&&h.point&&(h.point=i.transform(h.point)),n._totalMatrix=r,h},_getChildHitTestOptions:function(t){return t},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new S("fill",this)},matches:function(t,n){var i=typeof t;if("object"===i){for(var r in t)if(t.hasOwnProperty(r)&&!this.matches(r,t[r]))return!1}else{if("function"===i)return t(this);var s=/^(empty|editable)$/.test(t)?this["is"+e.capitalize(t)]():"type"===t?e.hyphenate(this._class):this[t];if(/^(constructor|class)$/.test(t)){if(!(this instanceof n))return!1}else if(n instanceof RegExp){if(!n.test(s))return!1}else if("function"==typeof n){if(!n(s))return!1}else if(e.isPlainObject(n)){if(!function t(n,i){for(var r in n)if(n.hasOwnProperty(r)){var s=n[r],a=i[r];if(e.isPlainObject(s)&&e.isPlainObject(a)){if(!t(s,a))return!1}else if(!e.equals(s,a))return!1}return!0}(n,s))return!1}else if(!e.equals(s,n))return!1}return!0},getItems:function(t){return m._getItems(this._children,t,this._matrix)},getItem:function(t){return m._getItems(this._children,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(n,i,r,s,a){if(!s&&"object"==typeof i){var o=i.overlapping,h=i.inside;s={items:[],inside:!!h,overlapping:!!o,rect:u=(m=o||h)&&d.read([m]),path:o&&new A.Rectangle({rectangle:u,insert:!1})},m&&(i=e.set({},i,{inside:!0,overlapping:!0}))}var u,l=s&&s.items;r=(u=s&&s.rect)&&(r||new _);for(var c=0,f=n&&n.length;c<f;c++){var g=n[c],p=r&&r.chain(g._matrix),v=!0;if(u){var m=g.getBounds(p);if(!u.intersects(m))continue;s.inside&&u.contains(m)||s.overlapping&&(m.contains(u)||s.path.intersects(g,p))||(v=!1)}if(v&&g.matches(i)&&(l.push(g),a))break;if(t(g._children,i,p,s,a),a&&l.length>0)break}return l}}},{importJSON:function(t){var n=e.importJSON(t,this);return n!==this?this.addChild(n):n},addChild:function(e,n){return this.insertChild(t,e,n)},insertChild:function(t,e,n){var i=e?this.insertChildren(t,[e],n):null;return i&&i[0]},addChildren:function(t,e){return this.insertChildren(this._children.length,t,e)},insertChildren:function(t,n,i,r){var s=this._children;if(s&&n&&n.length>0){for(var a=(n=Array.prototype.slice.apply(n)).length-1;a>=0;a--){var o=n[a];if(!r||o instanceof r){var h=o._parent===this&&o._index<t;o._remove(!1,!0)&&h&&t--}else n.splice(a,1)}e.splice(s,n,t,0);for(var u=this._project,l=u&&u._changes,c=(a=0,n.length);a<c;a++){(o=n[a])._parent=this,o._setProject(this._project,!0),o._name&&o.setName(o._name),l&&this._changed(5)}this._changed(11)}else n=null;return n},_insertSibling:function(t,e,n){return this._parent?this._parent.insertChild(t,e,n):null},insertAbove:function(t,e){return t._insertSibling(t._index+1,this,e)},insertBelow:function(t,e){return t._insertSibling(t._index,this,e)},sendToBack:function(){return(this._parent||this instanceof w&&this._project).insertChild(0,this)},bringToFront:function(){return(this._parent||this instanceof w&&this._project).addChild(this)},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",reduce:function(){if(this._children&&1===this._children.length){var t=this._children[0].reduce();return t.insertAbove(this),t.setStyle(this._style),this.remove(),t}return this},_removeNamed:function(){var t=this._parent;if(t){var e=t._children,n=t._namedChildren,i=this._name,r=n[i],s=r?r.indexOf(this):-1;-1!==s&&(e[i]==this&&delete e[i],r.splice(s,1),r.length?e[i]=r[r.length-1]:delete n[i])}},_remove:function(t,n){var i=this._parent;if(i){if(this._name&&this._removeNamed(),null!=this._index&&e.splice(i._children,null,this._index,1),this._installEvents(!1),t){var r=this._project;r&&r._changes&&this._changed(5)}return n&&i._changed(11),this._parent=null,!0}return!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,n){if(!this._children)return null;t=t||0,n=e.pick(n,this._children.length);for(var i=e.splice(this._children,null,t,n-t),r=i.length-1;r>=0;r--)i[r]._remove(!0,!1);return i.length>0&&this._changed(11),i},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(){return!this._children||0===this._children.length},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(t){var e=[];do{e.unshift(t)}while(t=t._parent);return e}for(var n=e(this),i=e(t),r=0,s=Math.min(n.length,i.length);r<s;r++)if(n[r]!=i[r])return n[r]._index<i[r]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return!!this._parent&&this._parent.isInserted()},isAbove:function(t){return-1===this._getOrder(t)},isBelow:function(t){return 1===this._getOrder(t)},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e==t)return!0;return!1},isAncestor:function(t){return!!t&&t.isDescendant(this)},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1},translate:function(){var t=new _;return this.transform(t.translate.apply(t,arguments))},rotate:function(t){return this.transform((new _).rotate(t,h.read(arguments,1,{readNull:!0})||this.getPosition(!0)))}},e.each(["scale","shear","skew"],(function(t){this[t]=function(){var e=h.read(arguments),n=h.read(arguments,0,{readNull:!0});return this.transform((new _)[t](e,n||this.getPosition(!0)))}}),{}),{transform:function(t,e,n,i){t&&t.isIdentity()&&(t=null);var r=this._matrix,s=(e||this._applyMatrix)&&(!r.isIdentity()||t||e&&n&&this._children);if(!t&&!s)return this;if(t&&r.preConcatenate(t),s=s&&this._transformContent(r,n,i)){var a=this._pivot,o=this._style,h=o.getFillColor(!0),u=o.getStrokeColor(!0);a&&r._transformPoint(a,a,!0),h&&h.transform(r),u&&u.transform(r),r.reset(!0),i&&this._canApplyMatrix&&(this._applyMatrix=!0)}var l=this._bounds,c=this._position;this._changed(9);var d=l&&t&&t.decompose();if(d&&!d.shearing&&d.rotation%90==0){for(var f in l){var _=l[f];!s&&_._internal||t._transformBounds(_,_)}var g=this._boundsGetter;(_=l[g&&g.getBounds||g||"getBounds"])&&(this._position=_.getCenter(!0)),this._bounds=l}else t&&c&&(this._position=t._transformPoint(c,c));return this},_transformContent:function(t,e,n){var i=this._children;if(i){for(var r=0,s=i.length;r<s;r++)i[r].transform(t,!0,e,n);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(h.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(h.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(h.read(arguments))},localToParent:function(){return this._matrix._transformPoint(h.read(arguments))},fitBounds:function(t,e){t=d.read(arguments);var n=this.getBounds(),i=n.height/n.width,r=t.height/t.width,s=(e?i>r:i<r)?t.width/n.width:t.height/n.height,a=new d(new h,new l(n.width*s,n.height*s));a.setCenter(t.getCenter()),this.setBounds(a)},_setStyles:function(t){var e=this._style,n=e.getFillColor(),i=e.getStrokeColor(),r=e.getShadowColor();if(n&&(t.fillStyle=n.toCanvasStyle(t)),i){var s=e.getStrokeWidth();if(s>0){t.strokeStyle=i.toCanvasStyle(t),t.lineWidth=s;var a=e.getStrokeJoin(),o=e.getStrokeCap(),h=e.getMiterLimit();if(a&&(t.lineJoin=a),o&&(t.lineCap=o),h&&(t.miterLimit=h),paper.support.nativeDash){var u=e.getDashArray(),l=e.getDashOffset();u&&u.length&&("setLineDash"in t?(t.setLineDash(u),t.lineDashOffset=l):(t.mozDash=u,t.mozDashOffset=l))}}}if(r){var c=e.getShadowBlur();if(c>0){t.shadowColor=r.toCanvasStyle(t),t.shadowBlur=c;var d=this.getShadowOffset();t.shadowOffsetX=d.x,t.shadowOffsetY=d.y}}},draw:function(t,e,n){var i=this._updateVersion=this._project._updateVersion;if(this._visible&&0!==this._opacity){var r=e.matrices,s=e.viewMatrix,a=this._matrix,o=r[r.length-1].chain(a);if(o.isInvertible()){r.push(o),e.updateMatrix&&(o._updateVersion=i,this._globalMatrix=o);var h,u,l,c=this._blendMode,d=this._opacity,f="normal"===c,_=K.nativeModes[c],g=f&&1===d||e.dontStart||e.clip||(_||f&&d<1)&&this._canComposite(),p=e.pixelRatio||1;if(!g){var v=this.getStrokeBounds(b(o));if(!v.width||!v.height)return;l=e.offset,u=e.offset=v.getTopLeft().floor(),h=t,t=Y.getContext(v.getSize().ceil().add(1).multiply(p)),1!==p&&t.scale(p,p)}t.save();var m=n?n.chain(a):!this.getStrokeScaling(!0)&&b(o),y=!g&&e.clipItem,w=!m||y;if(g?(t.globalAlpha=d,_&&(t.globalCompositeOperation=c)):w&&t.translate(-u.x,-u.y),w&&(g?a:b(o)).applyToContext(t),y&&e.clipItem.draw(t,e.extend({clip:!0})),m){t.setTransform(p,0,0,p,0,0);var x=e.offset;x&&t.translate(-x.x,-x.y)}this._draw(t,e,m),t.restore(),r.pop(),e.clip&&!e.dontFinish&&t.clip(),g||(K.process(c,t,h,d,u.subtract(l).multiply(p)),Y.release(t),e.offset=l)}}function b(t){return s?s.chain(t):t}},_isUpdated:function(t){var e=this._parent;if(e instanceof O)return e._isUpdated(t);var n=this._updateVersion===t;return!n&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,n=!0),n},_drawSelection:function(t,e,n,i,r){if((this._drawSelected||this._boundsSelected)&&this._isUpdated(r)){var s=this.getSelectedColor(!0)||this.getLayer().getSelectedColor(!0),a=e.chain(this.getGlobalMatrix(!0));if(t.strokeStyle=t.fillStyle=s?s.toCanvasStyle(t):"#009dec",this._drawSelected&&this._drawSelected(t,a,i),this._boundsSelected){var o=n/2,h=a._transformCorners(this.getInternalBounds());t.beginPath();for(var u=0;u<8;u++)t[0===u?"moveTo":"lineTo"](h[u],h[++u]);t.closePath(),t.stroke();for(u=0;u<8;u++)t.fillRect(h[u]-o,h[++u]-o,n,n)}}},_canComposite:function(){return!1}},e.each(["down","drag","up","move"],(function(t){this["removeOn"+e.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}}),{removeOn:function(t){for(var e in t)if(t[e]){var n="mouse"+e,i=this._project,r=i._removeSets=i._removeSets||{};r[n]=r[n]||{},r[n][this._id]=this}return this}})),y=m.extend({_class:"Group",_selectChildren:!0,_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function e(n){e.base.call(this,n),1026&n&&(this._clipItem=t)},_getClipItem:function(){var e=this._clipItem;if(e===t){e=null;for(var n=0,i=this._children.length;n<i;n++){var r=this._children[n];if(r._clipMask){e=r;break}}this._clipItem=e}return e},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_draw:function(t,e){var n=e.clip,i=!n&&this._getClipItem(),r=!0;if(e=e.extend({clipItem:i,clip:!1}),n?this._currentPath?(t.currentPath=this._currentPath,r=!1):(t.beginPath(),e.dontStart=e.dontFinish=!0):i&&i.draw(t,e.extend({clip:!0})),r)for(var s=0,a=this._children.length;s<a;s++){var o=this._children[s];o!==i&&o.draw(t,e)}n&&(this._currentPath=t.currentPath)}}),w=y.extend({_class:"Layer",initialize:function(n){var i=e.isPlainObject(n)?new e(n):{children:Array.isArray(n)?n:arguments},r=i.insert;i.insert=!1,y.call(this,i),(r||r===t)&&(this._project.addChild(this),this.activate())},_remove:function t(n,i){if(this._parent)return t.base.call(this,n,i);if(null!=this._index){var r=this._project;return r._activeLayer===this&&(r._activeLayer=this.getNextSibling()||this.getPreviousSibling()),e.splice(r.layers,null,this._index,1),this._installEvents(!1),n&&r._changes&&this._changed(5),i&&(r._needsUpdate=!0),!0}return!1},getNextSibling:function t(){return this._parent?t.base.call(this):this._project.layers[this._index+1]||null},getPreviousSibling:function t(){return this._parent?t.base.call(this):this._project.layers[this._index-1]||null},isInserted:function t(){return this._parent?t.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_insertSibling:function t(e,n,i){return this._parent?t.base.call(this,e,n,i):this._project.insertChild(e,n,i)}}),x=m.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_boundsSelected:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(t){this._initialize(t)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&e.equals(this._radius,t._radius)},clone:function(t){var e=new x(m.NO_INSERT);return e.setType(this._type),e.setSize(this._size),e.setRadius(this._radius),this._clone(e,t)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new c(t.width,t.height,this,"setSize")},setSize:function(){var t=l.read(arguments);if(this._size){if(!this._size.equals(t)){var e=this._type,n=t.width,i=t.height;if("rectangle"===e){var r=l.min(this._radius,t.divide(2));this._radius.set(r.width,r.height)}else"circle"===e?(n=i=(n+i)/2,this._radius=n/2):"ellipse"===e&&this._radius.set(n/2,i/2);this._size.set(n,i),this._changed(9)}}else this._size=t.clone()},getRadius:function(){var t=this._radius;return"circle"===this._type?t:new c(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if("circle"===e){if(t===this._radius)return;var n=2*t;this._radius=t,this._size.set(n,n)}else if(t=l.read(arguments),this._radius){if(this._radius.equals(t))return;if(this._radius.set(t.width,t.height),"rectangle"===e){n=l.max(this._size,t.multiply(2));this._size.set(n.width,n.height)}else"ellipse"===e&&this._size.set(2*t.width,2*t.height)}else this._radius=t.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var n=this._clone(new(A[e.capitalize(this._type)])({center:new h,size:this._size,radius:this._radius,insert:!1}),t);return paper.settings.applyMatrix&&n.setApplyMatrix(!0),n},_draw:function(t,e,n){var i=this._style,r=i.hasFill(),s=i.hasStroke(),a=e.dontFinish||e.clip,o=!n;if(r||s||a){var h=this._type,u=this._radius,l="circle"===h;if(e.dontStart||t.beginPath(),o&&l)t.arc(0,0,u,0,2*Math.PI,!0);else{var c=l?u:u.width,d=l?u:u.height,f=this._size,_=f.width,g=f.height;if(o&&"rectangle"===h&&0===c&&0===d)t.rect(-_/2,-g/2,_,g);else{var p=_/2,v=g/2,m=.44771525016920644,y=c*m,w=d*m,x=[-p,-v+d,-p,-v+w,-p+y,-v,-p+c,-v,p-c,-v,p-y,-v,p,-v+w,p,-v+d,p,v-d,p,v-w,p-y,v,p-c,v,-p+c,v,-p+y,v,-p,v-w,-p,v-d];n&&n.transform(x,x,32),t.moveTo(x[0],x[1]),t.bezierCurveTo(x[2],x[3],x[4],x[5],x[6],x[7]),p!==c&&t.lineTo(x[8],x[9]),t.bezierCurveTo(x[10],x[11],x[12],x[13],x[14],x[15]),v!==d&&t.lineTo(x[16],x[17]),t.bezierCurveTo(x[18],x[19],x[20],x[21],x[22],x[23]),p!==c&&t.lineTo(x[24],x[25]),t.bezierCurveTo(x[26],x[27],x[28],x[29],x[30],x[31])}}t.closePath()}a||!r&&!s||(this._setStyles(t),r&&(t.fill(i.getWindingRule()),t.shadowColor="rgba(0,0,0,0)"),s&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var n=new d(this._size).setCenter(0,0);return"getBounds"!==t&&this.hasStroke()&&(n=n.expand(this.getStrokeWidth())),e?e._transformBounds(n):n}},new function(){function t(t,e,n){var i=t._radius;if(!i.isZero())for(var r=t._size.divide(2),s=0;s<4;s++){var a=new h(1&s?1:-1,s>1?1:-1),o=a.multiply(r),u=o.subtract(a.multiply(i)),l=new d(o,u);if((n?l.expand(n):l).contains(e))return u}}function e(t,e){var n=t.getAngleInRadians(),i=2*e.width,r=2*e.height,s=i*Math.sin(n),a=r*Math.cos(n);return i*r/(2*Math.sqrt(s*s+a*a))}return{_contains:function e(n){if("rectangle"===this._type){var i=t(this,n);return i?n.subtract(i).divide(this._radius).getLength()<=1:e.base.call(this,n)}return n.divide(this.size).getLength()<=.5},_hitTestSelf:function n(i,r){var s=!1;if(this.hasStroke()){var a=this._type,o=this._radius,h=this.getStrokeWidth()+2*r.tolerance;if("rectangle"===a){var u=t(this,i,h);if(u){var l=i.subtract(u);s=2*Math.abs(l.getLength()-e(l,o))<=h}else{var c=new d(this._size).setCenter(0,0),f=c.expand(h),_=c.expand(-h);s=f._containsPoint(i)&&!_._containsPoint(i)}}else"ellipse"===a&&(o=e(i,o)),s=2*Math.abs(i.getLength()-o)<=h}return s?new S("stroke",this):n.base.apply(this,arguments)}}},{statics:new function(){function t(t,n,i,r,s){var a=new x(e.getNamed(s));return a._type=t,a._size=i,a._radius=r,a.translate(n)}return{Circle:function(){var n=h.readNamed(arguments,"center"),i=e.readNamed(arguments,"radius");return t("circle",n,new l(2*i),i,arguments)},Rectangle:function(){var e=d.readNamed(arguments,"rectangle"),n=l.min(l.readNamed(arguments,"radius"),e.getSize(!0).divide(2));return t("rectangle",e.getCenter(!0),e.getSize(!0),n,arguments)},Ellipse:function(){var e=x._readEllipse(arguments),n=e.radius;return t("ellipse",e.center,n.multiply(2),n,arguments)},_readEllipse:function(t){var n,i;if(e.hasNamed(t,"radius"))n=h.readNamed(t,"center"),i=l.readNamed(t,"radius");else{var r=d.readNamed(t,"rectangle");n=r.getCenter(!0),i=r.getSize(!0).divide(2)}return{center:n,radius:i}}}}}),b=m.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsGetter:"getBounds",_boundsSelected:!0,_serializeFields:{crossOrigin:null,source:null},initialize:function(e,n){this._initialize(e,n!==t&&h.read(arguments,1))||("string"==typeof e?this.setSource(e):this.setImage(e)),this._size||(this._size=new l,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},clone:function(t){var e=new b(m.NO_INSERT),n=this._image,i=this._canvas;if(n)e.setImage(n);else if(i){var r=Y.getCanvas(this._size);r.getContext("2d").drawImage(i,0,0),e.setImage(r)}return e._crossOrigin=this._crossOrigin,this._clone(e,t)},getSize:function(){var t=this._size;return new c(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(){var t=l.read(arguments);if(!t.equals(this._size))if(t.width>0&&t.height>0){var e=this.getElement();this.setImage(Y.getCanvas(t)),e&&this.getContext(!0).drawImage(e,0,0,t.width,t.height)}else this._canvas&&Y.release(this._canvas),this._size=t.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},isEmpty:function(){var t=this._size;return!t||0===t.width&&0===t.height},getResolution:function(){var t=this._matrix,e=new h(0,0).transform(t),n=new h(1,0).transform(t).subtract(e),i=new h(0,1).transform(t).subtract(e);return new l(72/n.getLength(),72/i.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){this._canvas&&Y.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=t&&t.complete),this._size=new l(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(521)},getCanvas:function(){if(!this._canvas){var t=Y.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch(e){Y.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(513)),this._context},setContext:function(t){this._context=t},getSource:function(){return this._image&&this._image.src||this.toDataURL()},setSource:function(t){var e,n=this,i=this._crossOrigin;function r(){var t=n.getView();t&&(paper=t._scope,n.setImage(e),n.emit("load"),t.update())}e=document.getElementById(t)||new Image,i&&(e.crossOrigin=i),e.naturalWidth&&e.naturalHeight?setTimeout(r,0):(q.add(e,{load:r}),e.src||(e.src=t)),this.setImage(e)},getCrossOrigin:function(){return this._image&&this._image.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t,this._image&&(this._image.crossOrigin=t)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=d.read(arguments),e=Y.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=d.read(arguments),e=new b(m.NO_INSERT);return e.setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.preConcatenate(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image&&this._image.src;if(/^data:/.test(t))return t;var e=this.getCanvas();return e?e.toDataURL.apply(e,arguments):null},drawImage:function(t){var e=h.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){var n,i;t?t instanceof z?(i=t,n=t.getBounds()):t.width?n=new d(t):t.x&&(n=new d(t.x-.5,t.y-.5,1,1)):n=this.getBounds();var r=Math.min(n.width,32),s=Math.min(n.height,32),a=b._sampleContext;a?a.clearRect(0,0,33,33):a=b._sampleContext=Y.getContext(new l(32)),a.save();var o=(new _).scale(r/n.width,s/n.height).translate(-n.x,-n.y);o.applyToContext(a),i&&i.draw(a,new e({clip:!0,matrices:[o]})),this._matrix.applyToContext(a);var h=this.getElement(),u=this._size;h&&a.drawImage(h,-u.width/2,-u.height/2),a.restore();for(var c=a.getImageData(.5,.5,Math.ceil(r),Math.ceil(s)).data,f=[0,0,0],g=0,p=0,v=c.length;p<v;p+=4){var m=c[p+3];g+=m,m/=255,f[0]+=c[p]*m,f[1]+=c[p+1]*m,f[2]+=c[p+2]*m}for(p=0;p<3;p++)f[p]/=g;return g?j.read(f):null},getPixel:function(){var t=h.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new j("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=h.read(arguments),e=j.read(arguments),n=e._convert("rgb"),i=e._alpha,r=this.getContext(!0),s=r.createImageData(1,1),a=s.data;a[0]=255*n[0],a[1]=255*n[1],a[2]=255*n[2],a[3]=null!=i?255*i:255,r.putImageData(s,t.x,t.y)},createImageData:function(){var t=l.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=d.read(arguments);return t.isEmpty()&&(t=new d(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},setImageData:function(t){var e=h.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},_getBounds:function(t,e){var n=new d(this._size).setCenter(0,0);return e?e._transformBounds(n):n},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new S("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t){var e=this.getElement();e&&(t.globalAlpha=this._opacity,t.drawImage(e,-this._size.width/2,-this._size.height/2))},_canComposite:function(){return!0}}),C=m.extend({_class:"PlacedSymbol",_applyMatrix:!1,_canApplyMatrix:!1,_boundsGetter:{getBounds:"getStrokeBounds"},_boundsSelected:!0,_serializeFields:{symbol:null},initialize:function(e,n){this._initialize(e,n!==t&&h.read(arguments,1))||this.setSymbol(e instanceof v?e:new v(e))},_equals:function(t){return this._symbol===t._symbol},getSymbol:function(){return this._symbol},setSymbol:function(t){this._symbol=t,this._changed(9)},clone:function(t){var e=new C(m.NO_INSERT);return e.setSymbol(this._symbol),this._clone(e,t)},isEmpty:function(){return this._symbol._definition.isEmpty()},_getBounds:function(t,e,n){var i=this.symbol._definition;return i._getCachedBounds(t,e&&e.chain(i._matrix),n)},_hitTestSelf:function(t,e){var n=this._symbol._definition._hitTest(t,e);return n&&(n.item=this),n},_draw:function(t,e){this.symbol._definition.draw(t,e)}}),S=e.extend({_class:"HitResult",initialize:function(t,e,n){this.type=t,this.item=e,n&&(n.enumerable=!0,this.inject(n))},statics:{getOptions:function(t){return new e({type:null,tolerance:paper.settings.hitTolerance,fill:!t,stroke:!t,segments:!t,handles:!1,ends:!1,center:!1,bounds:!1,guides:!1,selected:!1},t)}}}),P=e.extend({_class:"Segment",beans:!0,initialize:function(e,n,i,r,s,a){var o,h,u,l=arguments.length;0===l||(1===l?"point"in e?(o=e.point,h=e.handleIn,u=e.handleOut):o=e:2===l&&"number"==typeof e?o=arguments:l<=3?(o=e,h=n,u=i):(o=e!==t?[e,n]:null,h=i!==t?[i,r]:null,u=s!==t?[s,a]:null)),new k(o,this,"_point"),new k(h,this,"_handleIn"),new k(u,this,"_handleOut")},_serialize:function(t){return e.serialize(this.hasHandles()?[this._point,this._handleIn,this._handleOut]:this._point,t,!0)},_changed:function(t){var e=this._path;if(e){var n,i=e._curves,r=this._index;i&&(t&&t!==this._point&&t!==this._handleIn||!(n=r>0?i[r-1]:e._closed?i[i.length-1]:null)||n._changed(),t&&t!==this._point&&t!==this._handleOut||!(n=i[r])||n._changed()),e._changed(25)}},getPoint:function(){return this._point},setPoint:function(){var t=h.read(arguments);this._point.set(t.x,t.y)},getHandleIn:function(){return this._handleIn},setHandleIn:function(){var t=h.read(arguments);this._handleIn.set(t.x,t.y)},getHandleOut:function(){return this._handleOut},setHandleOut:function(){var t=h.read(arguments);this._handleOut.set(t.x,t.y)},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},clearHandles:function(){this._handleIn.set(0,0),this._handleOut.set(0,0)},_selectionState:0,isSelected:function(t){var e=this._selectionState;return t?t===this._point?!!(4&e):t===this._handleIn?!!(1&e):t===this._handleOut&&!!(2&e):!!(7&e)},setSelected:function(t,e){var n=this._path,i=(t=!!t,this._selectionState),r=i,s=e?e===this._point?4:e===this._handleIn?1:e===this._handleOut?2:0:7;t?i|=s:i&=~s,this._selectionState=i,n&&i!==r&&(n._updateSelection(this,r,i),n._changed(129))},getIndex:function(){return this._index!==t?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new M(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return 0===this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,n=t._x,i=t._y;t.set(e._x,e._y),e.set(n,i)},reversed:function(){return new P(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new P(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},_transformCoordinates:function(t,e,n){var i=this._point,r=n&&this._handleIn.isZero()?null:this._handleIn,s=n&&this._handleOut.isZero()?null:this._handleOut,a=i._x,o=i._y,h=2;return e[0]=a,e[1]=o,r&&(e[h++]=r._x+a,e[h++]=r._y+o),s&&(e[h++]=s._x+a,e[h++]=s._y+o),t&&(t._transformCoordinates(e,e,h/2),a=e[0],o=e[1],n?(i._x=a,i._y=o,h=2,r&&(r._x=e[h++]-a,r._y=e[h++]-o),s&&(s._x=e[h++]-a,s._y=e[h++]-o)):(r||(e[h++]=a,e[h++]=o),s||(e[h++]=a,e[h++]=o))),e}}),k=h.extend({initialize:function(e,n,i){var r,s,a;if(e)if((r=e[0])!==t)s=e[1];else{var o=e;(r=o.x)===t&&(r=(o=h.read(arguments)).x),s=o.y,a=o.selected}else r=s=0;this._x=r,this._y=s,this._owner=n,n[i]=this,a&&this.setSelected(!0)},set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},_serialize:function(t){var e=t.formatter,n=e.number(this._x),i=e.number(this._y);return this.isSelected()?{x:n,y:i,selected:!0}:[n,i]},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){return a.isZero(this._x)&&a.isZero(this._y)},setSelected:function(t){this._owner.setSelected(t,this)},isSelected:function(){return this._owner.isSelected(this)}}),I=e.extend({_class:"Curve",initialize:function(t,e,n,i,r,s,a,o){var h,u,l,c,d,f,_=arguments.length;3===_?(this._path=t,h=e,u=n):0===_?(h=new P,u=new P):1===_?"segment1"in t?(h=new P(t.segment1),u=new P(t.segment2)):"point1"in t?(l=t.point1,d=t.handle1,f=t.handle2,c=t.point2):Array.isArray(t)&&(l=[t[0],t[1]],c=[t[6],t[7]],d=[t[2]-t[0],t[3]-t[1]],f=[t[4]-t[6],t[5]-t[7]]):2===_?(h=new P(t),u=new P(e)):4===_?(l=t,d=e,f=n,c=i):8===_&&(l=[t,e],c=[a,o],d=[n-t,i-e],f=[r-a,s-o]),this._segment1=h||new P(l,null,d),this._segment2=u||new P(c,f,null)},_serialize:function(t){return e.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0)},_changed:function(){this._length=this._bounds=t},clone:function(){return new I(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},remove:function(){var t=!1;if(this._path){var e=this._segment2,n=e._handleOut;(t=e.remove())&&this._segment1._handleOut.set(n.x,n.y)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){var t=h.read(arguments);this._segment1._point.set(t.x,t.y)},getPoint2:function(){return this._segment2._point},setPoint2:function(){var t=h.read(arguments);this._segment2._point.set(t.x,t.y)},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){var t=h.read(arguments);this._segment1._handleOut.set(t.x,t.y)},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){var t=h.read(arguments);this._segment2._handleIn.set(t.x,t.y)},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return 0===this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle2().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return I.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],n=0;n<8;n+=2)e.push(new h(t[n],t[n+1]));return e},getLength:function(){return null==this._length&&(this._length=I.getLength(this.getValues(),0,1)),this._length},getArea:function(){return I.getArea(this.getValues())},getLine:function(){return new g(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new I(I.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return I.getLength(this.getValues(),t,e)},getIntersections:function(t){return I._getIntersections(this.getValues(),t&&t!==this?t.getValues():null,this,t,[],{})},_getParameter:function(e,n){return n?e:e&&e.curve===this?e.parameter:e===t&&n===t?.5:this.getParameterAt(e,0)},divide:function(t,e,n){var i=this._getParameter(t,e),r=null;if(i>=4e-7&&i<=.9999996){var s=I.subdivide(this.getValues(),i),a=s[0],o=s[1],u=n||this.hasHandles(),l=this._segment1,c=this._segment2,d=this._path;u&&(l._handleOut.set(a[2]-a[0],a[3]-a[1]),c._handleIn.set(o[4]-o[6],o[5]-o[7]));var f=a[6],_=a[7],g=new P(new h(f,_),u&&new h(a[4]-f,a[5]-_),u&&new h(o[2]-f,o[3]-_));d?(d.insert(l._index+1,g),r=this.getNext()):(this._segment2=g,r=new I(g,c))}return r},split:function(t,e){return this._path?this._path.split(this._segment1._index,this._getParameter(t,e)):null},reversed:function(){return new I(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut.set(0,0),this._segment2._handleIn.set(0,0)},statics:{getValues:function(t,e,n){var i=t._point,r=t._handleOut,s=e._handleIn,a=e._point,o=[i._x,i._y,i._x+r._x,i._y+r._y,a._x+s._x,a._y+s._y,a._x,a._y];return n&&n._transformCoordinates(o,o,4),o},subdivide:function(e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],u=e[6],l=e[7];n===t&&(n=.5);var c=1-n,d=c*i+n*s,f=c*r+n*a,_=c*s+n*o,g=c*a+n*h,p=c*o+n*u,v=c*h+n*l,m=c*d+n*_,y=c*f+n*g,w=c*_+n*p,x=c*g+n*v,b=c*m+n*w,C=c*y+n*x;return[[i,r,d,f,m,y,b,C],[b,C,w,x,p,v,u,l]]},solveCubic:function(t,e,n,i,r,s){var o=t[e],h=t[e+2],u=3*(h-o),l=3*(t[e+4]-h)-u,c=t[e+6]-o-u-l;return a.solveCubic(c,l,u,o-n,i,r,s)},getParameterOf:function(t,e){var n=new h(t[0],t[1]),i=new h(t[6],t[7]),r=e.isClose(n,1e-12)?0:e.isClose(i,1e-12)?1:null;if(null!==r)return r;for(var s=[e.x,e.y],a=[],o=2e-7,u=0;u<2;u++)for(var l=I.solveCubic(t,u,s[u],a,0,1),c=0;c<l;c++)if(r=a[c],e.isClose(I.getPoint(t,r),o))return r;return e.isClose(n,o)?0:e.isClose(i,o)?1:null},getNearestParameter:function(t,e){if(I.isStraight(t)){var n=t[0],i=t[1],r=t[6]-n,s=t[7]-i,a=r*r+s*s;if(0===a)return 0;var o=((e.x-n)*r+(e.y-i)*s)/a;return o<1e-12?0:o>.999999999999?1:I.getParameterOf(t,new h(n+o*r,i+o*s))}var u=1/0,l=0;function c(n){if(n>=0&&n<=1){var i=e.getDistance(I.getPoint(t,n),!0);if(i<u)return u=i,l=n,!0}}for(var d=0;d<=100;d++)c(d/100);for(var f=.005;f>4e-7;)c(l-f)||c(l+f)||(f/=2);return l},getPart:function(t,e,n){var i=e>n;if(i){var r=e;e=n,n=r}return e>0&&(t=I.subdivide(t,e)[1]),n<1&&(t=I.subdivide(t,(n-e)/(1-e))[0]),i?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},hasHandles:function(t){var e=a.isZero;return!(e(t[0]-t[2])&&e(t[1]-t[3])&&e(t[4]-t[6])&&e(t[5]-t[7]))},isFlatEnough:function(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],h=t[6],u=t[7],l=3*r-2*n-h,c=3*s-2*i-u,d=3*a-2*h-n,f=3*o-2*u-i;return Math.max(l*l,d*d)+Math.max(c*c,f*f)<10*e*e},getArea:function(t){var e=t[0],n=t[1],i=t[6],r=t[7],s=(t[2]+e)/2,a=(t[3]+n)/2,o=(t[4]+t[6])/2,h=(t[5]+t[7])/2;return 6*((e-s)*(a+n)+(s-o)*(h+a)+(o-i)*(r+h))/10},getBounds:function(t){for(var e=t.slice(0,2),n=e.slice(),i=[0,0],r=0;r<2;r++)I._addBounds(t[r],t[r+2],t[r+4],t[r+6],r,0,e,n,i);return new d(e[0],e[1],n[0]-e[0],n[1]-e[1])},_addBounds:function(t,e,n,i,r,s,o,h,u){function l(t,e){var n=t-e,i=t+e;n<o[r]&&(o[r]=n),i>h[r]&&(h[r]=i)}var c=3*(e-n)-t+i,d=2*(t+n)-4*e,f=e-t,_=a.solveQuadratic(c,d,f,u);l(i,0);for(var g=0;g<_;g++){var p=u[g],v=1-p;4e-7<p&&p<.9999996&&l(v*v*v*t+3*v*v*p*e+3*v*p*p*n+p*p*p*i,s)}}}},e.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],(function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];if(!e){var n=this._path;e=this._bounds[t]=A[t]([this._segment1,this._segment2],!1,n&&n.getStyle())}return e.clone()}}),{}),e.each({isStraight:function(t,e,n){if(e.isZero()&&n.isZero())return!0;if(t.isZero())return!1;if(e.isCollinear(t)&&n.isCollinear(t)){var i=t.dot(t),r=t.dot(e)/i,s=t.dot(n)/i;return r>=0&&r<=1&&s<=0&&s>=-1}return!1},isLinear:function(t,e,n){var i=t.divide(3);return e.equals(i)&&n.negate().equals(i)}},(function(t,e){this[e]=function(){var e=this._segment1,n=this._segment2;return t(n._point.subtract(e._point),e._handleOut,n._handleIn)},this.statics[e]=function(e){var n=e[0],i=e[1],r=e[6],s=e[7];return t(new h(r-n,s-i),new h(e[2]-n,e[3]-i),new h(e[4]-r,e[5]-s))}}),{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAt(.5,!0).y)<1e-7},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAt(.5,!0).x)<1e-7}}),{beans:!1,getParameterAt:function(t,e){return I.getParameterAt(this.getValues(),t,e)},getParameterOf:function(){return I.getParameterOf(this.getValues(),h.read(arguments))},getLocationAt:function(t,e){var n=e?t:this.getParameterAt(t);return null!=n&&n>=0&&n<=1?new M(this,n):null},getLocationOf:function(){return this.getLocationAt(this.getParameterOf(h.read(arguments)),!0)},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getNearestLocation:function(){var t=h.read(arguments),e=this.getValues(),n=I.getNearestParameter(e,t),i=I.getPoint(e,n);return new M(this,n,i,null,t.getDistance(i))},getNearestPoint:function(){return this.getNearestLocation.apply(this,arguments).getPoint()}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return e.each(t,(function(t){this[t+"At"]=function(e,n){var i=this.getValues();return I[t](i,n?e:I.getParameterAt(i,e,0))}}),{statics:{evaluateMethods:t}})},new function(){function e(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],h=t[7],u=9*(i-s)+3*(o-e),l=6*(e+s)-12*i,c=3*(i-e),d=9*(r-a)+3*(h-n),f=6*(n+a)-12*r,_=3*(r-n);return function(t){var e=(u*t+l)*t+c,n=(d*t+f)*t+_;return Math.sqrt(e*e+n*n)}}function n(t,e){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(e-t))))}function i(t,e,n,i){if(null==e||e<0||e>1)return null;var r,s,a=t[0],o=t[1],u=t[2],l=t[3],c=t[4],d=t[5],f=t[6],_=t[7],g=4e-7,p=1-g;if(0===n&&(e<g||e>p)){var v=e<g;r=v?a:f,s=v?o:_}else{var m=3*(u-a),y=3*(c-u)-m,w=f-a-m-y,x=3*(l-o),b=3*(d-l)-x,C=_-o-x-b;if(0===n)r=((w*e+y)*e+m)*e+a,s=((C*e+b)*e+x)*e+o;else{if(e<g?(r=m,s=x):e>p?(r=3*(f-c),s=3*(_-d)):(r=(3*w*e+2*y)*e+m,s=(3*C*e+2*b)*e+x),i){0===r&&0===s&&(e<g||e>p)&&(r=c-u,s=d-l);var S=Math.sqrt(r*r+s*s);S&&(r/=S,s/=S)}if(3===n){var P=6*w*e+2*y,k=6*C*e+2*b,I=Math.pow(r*r+s*s,1.5);r=0!==I?(r*k-s*P)/I:0,s=0}}}return 2===n?new h(s,-r):new h(r,s)}return{statics:{getLength:function(i,r,s){if(r===t&&(r=0),s===t&&(s=1),0===r&&1===s&&I.isStraight(i)){var o=i[6]-i[0],h=i[7]-i[1];return Math.sqrt(o*o+h*h)}var u=e(i);return a.integrate(u,r,s,n(r,s))},getParameterAt:function(i,r,s){if(s===t&&(s=r<0?1:0),0===r)return s;var o=Math.abs,h=r>0,u=h?s:0,l=h?1:s,c=e(i),d=a.integrate(c,u,l,n(u,l));if(o(r-d)<1e-12)return h?l:u;if(o(r)>d)return null;var f=r/d,_=0;return a.findRoot((function(t){return _+=a.integrate(c,s,t,n(s,t)),s=t,_-r}),c,s+f,u,l,32,1e-12)},getPoint:function(t,e){return i(t,e,0,!1)},getTangent:function(t,e){return i(t,e,1,!0)},getWeightedTangent:function(t,e){return i(t,e,1,!1)},getNormal:function(t,e){return i(t,e,2,!0)},getWeightedNormal:function(t,e){return i(t,e,2,!1)},getCurvature:function(t,e){return i(t,e,3,!1).x}}}},new function(){function t(t,e,n,i,r,s,a,o,h,u,l){var c=e.startConnected,d=e.endConnected,f=4e-7,_=1-f;if(null==r&&(r=I.getParameterOf(n,s)),null!==r&&r>=(c?f:0)&&r<=(d?_:1)&&(null==h&&(h=I.getParameterOf(a,u)),null!==h&&h>=(d?f:0)&&h<=(c?_:1))){var g=e.renormalize;if(g){var p=g(r,h);r=p[0],h=p[1]}var v=new M(i,r,s||I.getPoint(n,r),l),m=new M(o,h,u||I.getPoint(a,h),l),y=v.getPath()===m.getPath()&&v.getIndex()>m.getIndex()?m:v,w=e.include;v._intersection=m,m._intersection=v,w&&!w(y)||M.insert(t,y,!0)}}function e(i,r,s,a,o,h,u,l,c,d,f,_,p){if(!(++p>=24)){var v,m,y=r[0],w=r[1],x=r[6],b=r[7],C=g.getSignedDistance,S=C(y,w,x,b,r[2],r[3]),P=C(y,w,x,b,r[4],r[5]),k=S*P>0?3/4:4/9,M=k*Math.min(0,S,P),z=k*Math.max(0,S,P),A=function(t,e,n,i){var r,s=[0,t],a=[1/3,e],o=[2/3,n],h=[1,i],u=e-(2*t+i)/3,l=n-(t+2*i)/3;if(u*l<0)r=[[s,a,h],[s,o,h]];else{var c=u/l;r=[c>=2?[s,a,h]:c<=.5?[s,o,h]:[s,a,o,h],[s,h]]}return(u||l)<0?r.reverse():r}(C(y,w,x,b,i[0],i[1]),C(y,w,x,b,i[2],i[3]),C(y,w,x,b,i[4],i[5]),C(y,w,x,b,i[6],i[7])),O=A[0],T=A[1];if(null!=(v=n(O,T,M,z))&&null!=(m=n(O.reverse(),T.reverse(),M,z))){i=I.getPart(i,v,m);var E=m-v,L=u+(l-u)*v,N=u+(l-u)*m;if(f>.5&&E>.5)if(N-L>d-c){var j=L+(N-L)/2;e(r,(B=I.subdivide(i,.5))[0],a,s,o,h,c,d,L,j,E,!_,p),e(r,B[1],a,s,o,h,c,d,j,N,E,!_,p)}else{var B;j=c+(d-c)/2;e((B=I.subdivide(r,.5))[0],i,a,s,o,h,c,j,L,N,E,!_,p),e(B[1],i,a,s,o,h,j,d,L,N,E,!_,p)}else if(Math.max(d-c,N-L)<1e-7){var R=L+(N-L)/2,D=c+(d-c)/2;i=s.getValues(),r=a.getValues(),t(o,h,_?r:i,_?a:s,_?D:R,null,_?i:r,_?s:a,_?R:D,null)}else E>1e-12&&e(r,i,a,s,o,h,c,d,L,N,E,!_,p)}}}function n(t,e,n,r){return t[0][1]<n?i(t,!0,n):e[0][1]>r?i(e,!1,r):t[0][0]}function i(t,e,n){for(var i=t[0][0],r=t[0][1],s=1,a=t.length;s<a;s++){var o=t[s][0],h=t[s][1];if(e?h>=n:h<=n)return h===n?o:i+(n-r)*(o-i)/(h-r);i=o,r=h}return null}function r(e,n,i,r,s,o){for(var h=I.isStraight(e),u=h?n:e,l=h?e:n,c=l[0],d=l[1],f=l[6]-c,_=l[7]-d,g=Math.atan2(-_,f),p=Math.sin(g),v=Math.cos(g),m=[],y=0;y<8;y+=2){var w=u[y]-c,x=u[y+1]-d;m.push(w*v-x*p,w*p+x*v)}var b=[],C=I.solveCubic(m,1,0,b,0,1);for(y=0;y<C;y++){var S=b[y],P=I.getPoint(u,S),k=I.getParameterOf(l,P);if(null!==k){var M=I.getPoint(l,k),z=h?k:S,A=h?S:k;(!o.endConnected||A>a.CURVETIME_EPSILON)&&t(s,o,e,i,z,h?M:P,n,r,A,h?P:M)}}}function s(e,n,i,r,s,a){var o=g.intersect(e[0],e[1],e[6],e[7],n[0],n[1],n[6],n[7]);o&&t(s,a,e,i,null,o,n,r,null,o)}return{statics:{_getIntersections:function(n,i,a,o,u,l){if(!i)return I._getSelfIntersection(n,a,u,l);var c=n[0],d=n[1],f=n[6],_=n[7],g=i[0],p=i[1],v=i[6],m=i[7],y=(3*n[2]+c)/4,w=(3*n[3]+d)/4,x=(3*n[4]+f)/4,b=(3*n[5]+_)/4,C=(3*i[2]+g)/4,S=(3*i[3]+p)/4,P=(3*i[4]+v)/4,k=(3*i[5]+m)/4,M=Math.min,z=Math.max;if(!(z(c,y,x,f)>=M(g,C,P,v)&&M(c,y,x,f)<=z(g,C,P,v)&&z(d,w,b,_)>=M(p,S,k,m)&&M(d,w,b,_)<=z(p,S,k,m)))return u;if(!l.startConnected&&!l.endConnected){var A=I.getOverlaps(n,i);if(A){for(var O=0;O<2;O++){var T=A[O];t(u,l,n,a,T[0],null,i,o,T[1],null,!0)}return u}}var E=I.isStraight(n),L=I.isStraight(i),N=E&&L,j=1e-12,B=u.length;if((N?s:E||L?r:e)(n,i,a,o,u,l,0,1,0,1,0,!1,0),N&&u.length>B)return u;var R=new h(c,d),D=new h(f,_),F=new h(g,p),q=new h(v,m);return R.isClose(F,j)&&t(u,l,n,a,0,R,i,o,0,F),!l.startConnected&&R.isClose(q,j)&&t(u,l,n,a,0,R,i,o,1,q),!l.endConnected&&D.isClose(F,j)&&t(u,l,n,a,1,D,i,o,0,F),D.isClose(q,j)&&t(u,l,n,a,1,D,i,o,1,q),u},_getSelfIntersection:function(t,e,n,i){var r=t[0],s=t[1],o=t[2],u=t[3],l=t[4],c=t[5],d=t[6],f=t[7],_=new g(r,s,d,f,!1),p=_.getSide(new h(o,u),!0);if(p===_.getSide(new h(l,c),!0)&&((r-l)*(u-f)+(o-d)*(c-s))*p>0)return n;var v=d-3*l+3*o-r,m=l-2*o+r,y=o-r,w=f-3*c+3*u-s,x=c-2*u+s,b=u-s,C=w*y-v*b;if(C*C-4*(w*m-v*x)*(x*y-m*b)<0){var S,P=[],k=a.solveCubic(v*v+w*w,3*(v*m+w*x),2*(m*m+x*x)+v*y+w*b,m*y+x*b,P,0,1);if(k>0){for(var M=0,z=0;M<k;M++){var A=Math.abs(e.getCurvatureAt(P[M],!0));A>z&&(z=A,S=P[M])}var O=I.subdivide(t,S);i.endConnected=!0,i.renormalize=function(t,e){return[t*S,e*(1-S)+S]},I._getIntersections(O[0],O[1],e,e,n,i)}}return n},getOverlaps:function(t,e){var n=Math.abs,i=2e-7,r=I.isStraight(t),s=I.isStraight(e),a=r&&s;function o(t){var e=t[6]-t[0],n=t[7]-t[1];return e*e+n*n}if(a){var u=o(t)<o(e),l=u?e:t,c=u?t:e,d=new g(l[0],l[1],l[6],l[7]);if(d.getDistance(new h(c[0],c[1]))>i||d.getDistance(new h(c[6],c[7]))>i)return null}else if(r^s)return null;for(var f=[t,e],_=[],p=0,v=0;p<2&&_.length<2;p+=0===v?0:1,v^=1){var m=I.getParameterOf(f[1^p],new h(f[p][0===v?0:6],f[p][0===v?1:7]));if(null!=m){var y=0===p?[v,m]:[m,v];(0===_.length||n(y[0]-_[0][0])>4e-7&&n(y[1]-_[0][1])>4e-7)&&_.push(y)}if(1===p&&0===_.length)break}if(2!==_.length)_=null;else if(!a){var w=I.getPart(t,_[0][0],_[1][0]),x=I.getPart(e,_[0][1],_[1][1]);(n(x[2]-w[2])>i||n(x[3]-w[3])>i||n(x[4]-w[4])>i||n(x[5]-w[5])>i)&&(_=null)}return _}}}}),M=e.extend({_class:"CurveLocation",beans:!0,initialize:function t(e,n,i,r,s){if(n>.9999996){var a=e.getNext();a&&(n=0,e=a)}this._id=o.get(t),this._setCurve(e),this._parameter=n,this._point=i||e.getPointAt(n,!0),this._overlap=r,this._distance=s,this._intersection=this._next=this._prev=null},_setCurve:function(t){var e=t._path;this._version=e?e._version:0,this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){this._setCurve(t.getCurve()),this._segment=t,this._parameter=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this.getCurve(),e=this._segment;if(!e){var n=this.getParameter();0===n?e=t._segment1:1===n?e=t._segment2:null!=n&&(e=t.getPartLength(0,n)<t.getPartLength(n,1)?t._segment1:t._segment2),this._segment=e}return e},getCurve:function(){var t=this._curve,e=t&&t._path,n=this;function i(t){var e=t&&t.getCurve();if(e&&null!=(n._parameter=e.getParameterOf(n._point)))return n._setCurve(e),n._segment=t,e}return e&&e._version!==this._version&&(t=this._parameter=this._curve=this._offset=null),t||i(this._segment)||i(this._segment1)||i(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getParameter:function(){var t=this.getCurve(),e=this._parameter;return t&&null==e?this._parameter=t.getParameterOf(this._point):e},getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(null==t){t=0;var e=this.getPath(),n=this.getIndex();if(e&&null!=n)for(var i=e.getCurves(),r=0;r<n;r++)t+=i[r].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this.getCurve(),e=this.getParameter();return null!=e&&t&&t.getPartLength(0,e)},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=null;return t&&(e=t.divide(this.getParameter(),!0))&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve();return t?t.split(this.getParameter(),!0):null},equals:function(t,e){var n=this===t,i=2e-7;if(!n&&t instanceof M&&this.getPath()===t.getPath()&&this.getPoint().isClose(t.getPoint(),i)){var r=this.getCurve(),s=t.getCurve(),a=Math.abs,o=a((r.isLast()&&s.isFirst()?-1:r.getIndex())+this.getParameter()-((s.isLast()&&r.isFirst()?-1:s.getIndex())+t.getParameter()));n=(o<4e-7||(o=a(this.getOffset()-t.getOffset()))<i||a(this.getPath().getLength()-o)<i)&&(e||!this._intersection&&!t._intersection||this._intersection&&this._intersection.equals(t._intersection,!0))}return n},toString:function(){var t=[],e=this.getPoint(),n=s.instance;e&&t.push("point: "+e);var i=this.getIndex();null!=i&&t.push("index: "+i);var r=this.getParameter();return null!=r&&t.push("parameter: "+n.number(r)),null!=this._distance&&t.push("distance: "+n.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),n=t.getCurve();return!(e.isStraight()&&n.isStraight()&&e.getLine().intersect(n.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getParameter(),n=t.getParameter(),i=4e-7,r=1-i;if(e>=i&&e<=r||n>=i&&n<=r)return!this.isTouching();var s=this.getCurve(),a=s.getPrevious(),o=t.getCurve(),h=o.getPrevious(),u=Math.PI;if(!a||!h)return!1;function l(t,e,n){return e<n?t>e&&t<n:t>e&&t<=u||t>=-u&&t<n}var c=a.getTangentAt(r,!0).negate().getAngleInRadians(),d=s.getTangentAt(i,!0).getAngleInRadians(),f=h.getTangentAt(r,!0).negate().getAngleInRadians(),_=o.getTangentAt(i,!0).getAngleInRadians();return l(f,c,d)^l(_,c,d)&&l(f,d,c)^l(_,d,c)},isOverlap:function(){return!!this._overlap}},e.each(I.evaluateMethods,(function(t){var e=t+"At";this[t]=function(){var t=this.getParameter(),n=this.getCurve();return null!=t&&n&&n[e](t,!0)}}),{preserve:!0}),new function(){function t(t,e,n){var i=t.length,r=0,s=i-1;function a(n,r){for(var s=n+r;s>=-1&&s<=i;s+=r){var a=t[(s%i+i)%i];if(!e.getPoint().isClose(a.getPoint(),2e-7))break;if(e.equals(a))return a}return null}for(;r<=s;){var o,h=r+s>>>1,u=t[h];if(n&&(o=e.equals(u)?u:a(h,-1)||a(h,1)))return e._overlap&&(o._overlap=o._intersection._overlap=!0),o;var l=e.getPath(),c=u.getPath();(l===c?e.getIndex()+e.getParameter()-(u.getIndex()+u.getParameter()):l._id-c._id)<0?s=h-1:r=h+1}return t.splice(r,0,e),e}return{statics:{insert:t,expand:function(e){for(var n=e.slice(),i=0,r=e.length;i<r;i++)t(n,e[i]._intersection,!1);return n}}}}),z=m.extend({_class:"PathItem",initialize:function(){},getIntersections:function(t,e,n,i){var r=this===t||!t,s=this._matrix.orNullIfIdentity(),a=r?s:(n||t._matrix).orNullIfIdentity();if(!r&&!this.getBounds(s).touches(t.getBounds(a)))return[];for(var o,h=this.getCurves(),u=r?h:t.getCurves(),l=h.length,c=r?l:u.length,d=[],f=[],_=0;_<c;_++)d[_]=u[_].getValues(a);for(_=0;_<l;_++){var g=h[_],p=r?d[_]:g.getValues(s),v=g.getPath();v!==t&&(t=v,o=[],f.push(o)),r&&I._getSelfIntersection(p,g,o,{include:e,startConnected:1===l&&g.getPoint1().equals(g.getPoint2())});for(var m=r?_+1:0;m<c;m++){if(i&&o.length)return o;var y=u[m];I._getIntersections(p,d[m],g,y,o,{include:e,startConnected:r&&g.getPrevious()===y,endConnected:r&&g.getNext()===y})}}o=[];_=0;for(var w=f.length;_<w;_++)o.push.apply(o,f[_]);return o},getCrossings:function(t){return this.getIntersections(t,(function(t){return t.isCrossing()}))},_asPathItem:function(){return this},setPathData:function(t){var e,n,i,r=t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),s=!1,a=new h,o=new h;function u(t,n){var i=+e[t];return s&&(i+=a[n]),i}function c(t){return new h(u(t,"x"),u(t+1,"y"))}this.clear();for(var d=0,f=r&&r.length;d<f;d++){var _=r[d],g=_[0],p=g.toLowerCase(),v=(e=_.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&e.length;switch(s=g===p,"z"!==n||/[mz]/.test(p)||this.moveTo(a=o),p){case"m":case"l":for(var m="m"===p,y=0;y<v;y+=2)this[0===y&&m?"moveTo":"lineTo"](a=c(y));i=a,m&&(o=a);break;case"h":case"v":var w="h"===p?"x":"y";for(y=0;y<v;y++)a[w]=u(y,w),this.lineTo(a);i=a;break;case"c":for(y=0;y<v;y+=6)this.cubicCurveTo(c(y),i=c(y+2),a=c(y+4));break;case"s":for(y=0;y<v;y+=4)this.cubicCurveTo(/[cs]/.test(n)?a.multiply(2).subtract(i):a,i=c(y),a=c(y+2)),n=p;break;case"q":for(y=0;y<v;y+=4)this.quadraticCurveTo(i=c(y),a=c(y+2));break;case"t":for(y=0;y<v;y+=2)this.quadraticCurveTo(i=/[qt]/.test(n)?a.multiply(2).subtract(i):a,a=c(y)),n=p;break;case"a":for(y=0;y<v;y+=7)this.arcTo(a=c(y+5),new l(+e[y],+e[y+1]),+e[y+2],+e[y+4],+e[y+3]);break;case"z":this.closePath(!0)}n=p}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=this._getWinding(t,!1,!0);return!!("evenodd"===this.getWindingRule()?1&e:e)}}),A=z.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(e){this._closed=!1,this._segments=[],this._version=0;var n=Array.isArray(e)?"object"==typeof e[0]?e:arguments:!e||e.size!==t||e.x===t&&e.point===t?null:arguments;n&&n.length>0?this.setSegments(n):(this._curves=t,this._selectedSegmentState=0,n||"string"!=typeof e||(this.setPathData(e),e=null)),this._initialize(!n&&e)},_equals:function(t){return this._closed===t._closed&&e.equals(this._segments,t._segments)},clone:function(e){var n=new A(m.NO_INSERT);return n.setSegments(this._segments),n._closed=this._closed,this._clockwise!==t&&(n._clockwise=this._clockwise),this._clone(n,e)},_changed:function e(n){if(e.base.call(this,n),8&n){var i=this._parent;if(i&&(i._currentPath=t),this._length=this._area=this._clockwise=this._monoCurves=t,16&n)this._version++;else if(this._curves)for(var r=0,s=this._curves.length;r<s;r++)this._curves[r]._changed()}else 32&n&&(this._bounds=t)},getStyle:function(){var t=this._parent;return(t instanceof O?t:this)._style},getSegments:function(){return this._segments},setSegments:function(e){var n=this.isFullySelected();this._segments.length=0,this._selectedSegmentState=0,this._curves=t,e&&e.length>0&&this._add(P.readAll(e)),n&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var n=this._countCurves();t=this._curves=new Array(n);for(var i=0;i<n;i++)t[i]=new I(this,e[i],e[i+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new I(this,this._segments[e-1],this._segments[0]))}this._changed(25)}}},{beans:!0,getPathData:function(t,e){var n,i,r,a,o,h,u,l,c=this._segments,d=c.length,f=new s(e),_=new Array(6),g=!0,p=[];function v(e,s){e._transformCoordinates(t,_,!1),n=_[0],i=_[1],g?(p.push("M"+f.pair(n,i)),g=!1):(o=_[2],h=_[3],o===n&&h===i&&u===r&&l===a?s||p.push("l"+f.pair(n-r,i-a)):p.push("c"+f.pair(u-r,l-a)+" "+f.pair(o-r,h-a)+" "+f.pair(n-r,i-a))),r=n,a=i,u=_[4],l=_[5]}if(0===d)return"";for(var m=0;m<d;m++)v(c[m]);return this._closed&&d>0&&(v(c[0],!0),p.push("z")),p.join("")}},{isEmpty:function(){return 0===this._segments.length},_transformContent:function(t){for(var e=new Array(6),n=0,i=this._segments.length;n<i;n++)this._segments[n]._transformCoordinates(t,e,!0);return!0},_add:function(t,e){for(var n=this._segments,i=this._curves,r=t.length,s=null==e,a=(e=s?n.length:e,0);a<r;a++){var o=t[a];o._path&&(o=t[a]=o.clone()),o._path=this,o._index=e+a,o._selectionState&&this._updateSelection(o,0,o._selectionState)}if(s)n.push.apply(n,t);else{n.splice.apply(n,[e,0].concat(t));a=e+r;for(var h=n.length;a<h;a++)n[a]._index=a}if(i){var u=this._countCurves(),l=e+r-1===u?e-1:e,c=l,d=Math.min(l+r,u);t._curves&&(i.splice.apply(i,[l,0].concat(t._curves)),c+=t._curves.length);for(a=c;a<d;a++)i.splice(a,0,new I(this,null,null));this._adjustCurves(l,d)}return this._changed(25),t},_adjustCurves:function(t,e){for(var n,i=this._segments,r=this._curves,s=t;s<e;s++)(n=r[s])._path=this,n._segment1=i[s],n._segment2=i[s+1]||i[0],n._changed();(n=r[this._closed&&0===t?i.length-1:t-1])&&(n._segment2=i[t]||i[0],n._changed()),(n=r[e])&&(n._segment1=i[e],n._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){return arguments.length>1&&"number"!=typeof t?this._add(P.readAll(arguments)):this._add([P.read(arguments)])[0]},insert:function(t,e){return arguments.length>2&&"number"!=typeof e?this._add(P.readAll(arguments,1),t):this._add([P.read(arguments,1)],t)[0]},addSegment:function(){return this._add([P.read(arguments)])[0]},insertSegment:function(t){return this._add([P.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(P.readAll(t))},insertSegments:function(t,e){return this._add(P.readAll(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,n,i){t=t||0,n=e.pick(n,this._segments.length);var r=this._segments,s=this._curves,a=r.length,o=r.splice(t,n-t),h=o.length;if(!h)return o;for(var u=0;u<h;u++){var l=o[u];l._selectionState&&this._updateSelection(l,l._selectionState,0),l._index=l._path=null}u=t;for(var c=r.length;u<c;u++)r[u]._index=u;if(s){var d=t>0&&n===a+(this._closed?1:0)?t-1:t;s=s.splice(d,h);i&&(o._curves=s.slice(1)),this._adjustCurves(d,d)}return this._changed(25),o},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)t[e].clearHandles()},getLength:function(){if(null==this._length){for(var t=this.getCurves(),e=0,n=0,i=t.length;n<i;n++)e+=t[n].getLength();this._length=e}return this._length},getArea:function(){if(null==this._area){for(var t=this._segments,e=t.length,n=e-1,i=0,r=0,s=this._closed?e:n;r<s;r++)i+=I.getArea(I.getValues(t[r],t[r<n?r+1:0]));this._area=i}return this._area},isClockwise:function(){return this._clockwise!==t?this._clockwise:this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse(),this._clockwise=t},isFullySelected:function(){var t=this._segments.length;return this._selected&&t>0&&this._selectedSegmentState===7*t},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelected:function t(e){e||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments.length;this._selectedSegmentState=t?7*e:0;for(var n=0;n<e;n++)this._segments[n]._selectionState=t?7:0},_updateSelection:function(t,e,n){t._selectionState=n,(this._selectedSegmentState+=n-e)>0&&this.setSelected(!0)},flatten:function(t){for(var e=new T(this,64,.1),n=0,i=e.length/Math.ceil(e.length/t),r=e.length+(this._closed?-i:i)/2,s=[];n<=r;)s.push(new P(e.getPointAt(n))),n+=i;this.setSegments(s)},reduce:function(){for(var t=this.getCurves(),e=t.length-1;e>=0;e--){var n=t[e];n.hasHandles()||0!==n.getLength()&&!n.isCollinear(n.getNext())||n.remove()}return this},simplify:function(t){if(this._segments.length>2){var e=new E(this,t||2.5);this.setSegments(e.fit())}},split:function(t,e){if(null===e)return null;if(1===arguments.length){var n=t;if("number"==typeof n&&(n=this.getLocationAt(n)),!n)return null;t=n.index,e=n.parameter}e>=.9999996&&(t++,e--);var i=this.getCurves();if(t>=0&&t<i.length){e>=4e-7&&i[t++].divide(e,!0);var r,s=this.removeSegments(t,this._segments.length,!0);return this._closed?(this.setClosed(!1),r=this):((r=new A(m.NO_INSERT)).insertAbove(this,!0),this._clone(r)),r._add(s,0),this.addSegment(s[0]),r}return null},reverse:function(){this._segments.reverse();for(var e=0,n=this._segments.length;e<n;e++){var i=this._segments[e],r=i._handleIn;i._handleIn=i._handleOut,i._handleOut=r,i._index=e}this._curves=null,this._clockwise!==t&&(this._clockwise=!this._clockwise),this._changed(9)},join:function(t){if(t){var e=t._segments,n=this.getLastSegment(),i=t.getLastSegment();if(!i)return this;n&&n._point.equals(i._point)&&t.reverse();var r=t.getFirstSegment();if(n&&n._point.equals(r._point))n.setHandleOut(r._handleOut),this._add(e.slice(1));else{var s=this.getFirstSegment();s&&s._point.equals(r._point)&&t.reverse(),i=t.getLastSegment(),s&&s._point.equals(i._point)?(s.setHandleIn(i._handleIn),this._add(e.slice(0,e.length-1),0)):this._add(e.slice())}t._closed&&this._add([e[0]]),t.remove()}var a=this.getFirstSegment(),o=this.getLastSegment();return a!==o&&a._point.equals(o._point)&&(a.setHandleIn(o._handleIn),o.remove(),this.setClosed(!0)),this},toShape:function(t){if(!this._closed)return null;var e,n,i,r,s,o,h,u=this._segments;function c(t,e){var n=u[t],i=n.getNext(),r=u[e],s=r.getNext();return n._handleOut.isZero()&&i._handleIn.isZero()&&r._handleOut.isZero()&&s._handleIn.isZero()&&i._point.subtract(n._point).isCollinear(s._point.subtract(r._point))}function d(t){var e=u[t],n=e.getNext(),i=e._handleOut,r=n._handleIn,s=.5522847498307936;if(i.isOrthogonal(r)){var o=e._point,h=n._point,l=new g(o,i,!0).intersect(new g(h,r,!0),!0);return l&&a.isZero(i.getLength()/l.subtract(o).getLength()-s)&&a.isZero(r.getLength()/l.subtract(h).getLength()-s)}return!1}function f(t,e){return u[t]._point.getDistance(u[e]._point)}if(!this.hasHandles()&&4===u.length&&c(0,2)&&c(1,3)&&(s=u[1],o=s.getPrevious(),h=s.getNext(),o._handleOut.isZero()&&s._handleIn.isZero()&&s._handleOut.isZero()&&h._handleIn.isZero()&&s._point.subtract(o._point).isOrthogonal(h._point.subtract(s._point)))?(e=x.Rectangle,n=new l(f(0,3),f(0,1)),r=u[1]._point.add(u[2]._point).divide(2)):8===u.length&&d(0)&&d(2)&&d(4)&&d(6)&&c(1,5)&&c(3,7)?(e=x.Rectangle,i=(n=new l(f(1,6),f(0,3))).subtract(new l(f(0,7),f(1,2))).divide(2),r=u[3]._point.add(u[4]._point).divide(2)):4===u.length&&d(0)&&d(1)&&d(2)&&d(3)&&(a.isZero(f(0,2)-f(1,3))?(e=x.Circle,i=f(0,2)/2):(e=x.Ellipse,i=new l(f(2,0)/2,f(3,1)/2)),r=u[1]._point),e){var _=this.getPosition(!0),p=this._clone(new e({center:_,size:n,radius:i,insert:!1}),t,!1);return p.rotate(r.subtract(_).getAngle()+90),p}return null},_hitTestSelf:function(t,e){var n,i,r,s,a,o,u=this,l=this.getStyle(),c=this._segments,d=c.length,f=this._closed,_=e._tolerancePadding,g=_,p=e.stroke&&l.hasStroke(),v=e.fill&&l.hasFill(),m=e.curves,y=p?l.getStrokeWidth()/2:v&&e.tolerance>0||m?0:null;function w(e,n){return t.subtract(e).divide(n).length<=1}function x(t,n,i){if(!e.selected||n.isSelected()){var r=t._point;if(n!==r&&(n=n.add(r)),w(n,g))return new S(i,u,{segment:t,point:n})}}function b(t,n){return(n||e.segments)&&x(t,t._point,"segment")||!n&&e.handles&&(x(t,t._handleIn,"handle-in")||x(t,t._handleOut,"handle-out"))}function C(t){s.add(t)}function P(e){var a;if(("round"!==n||"round"!==i)&&(s=new A({internal:!0,closed:!0}),f||e._index>0&&e._index<d-1?"round"!==n&&(e._handleIn.isZero()||e._handleOut.isZero())&&A._addBevelJoin(e,n,y,r,C,!0):"round"!==i&&A._addSquareCap(e,i,y,C,!0),!s.isEmpty()))return s.contains(t)||(a=s.getNearestLocation(t))&&w(a.getPoint(),_);return w(e._point,g)}if(null!==y&&(y>0?(n=l.getStrokeJoin(),i=l.getStrokeCap(),r=y*l.getMiterLimit(),g=_.add(new h(y,y))):n=i="round"),!e.ends||e.segments||f){if(e.segments||e.handles)for(var k=0;k<d;k++)if(o=b(c[k]))return o}else if(o=b(c[0],!0)||b(c[d-1],!0))return o;if(null!==y){if(a=this.getNearestLocation(t)){var I=a.getParameter();0===I||1===I&&d>1?P(a.getSegment())||(a=null):w(a.getPoint(),g)||(a=null)}if(!a&&"miter"===n&&d>1)for(k=0;k<d;k++){var M=c[k];if(t.getDistance(M._point)<=r&&P(M)){a=M.getLocation();break}}}return!a&&v&&this._contains(t)||a&&!p&&!m?new S("fill",this):a?new S(p?"stroke":"curve",this,{location:a,point:a.getPoint()}):null}},e.each(I.evaluateMethods,(function(t){this[t+"At"]=function(e,n){var i=this.getLocationAt(e,n);return i&&i[t]()}}),{beans:!1,getLocationOf:function(){for(var t=h.read(arguments),e=this.getCurves(),n=0,i=e.length;n<i;n++){var r=e[n].getLocationOf(t);if(r)return r}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t,e){var n=this.getCurves(),i=0;if(e){var r=~~t;return(o=n[r])?o.getLocationAt(t-r,!0):null}for(var s=0,a=n.length;s<a;s++){var o,h=i;if((i+=(o=n[s]).getLength())>t)return o.getLocationAt(t-h)}return n.length>0&&t<=this.getLength()?new M(n[n.length-1],1):null},getNearestLocation:function(){for(var t=h.read(arguments),e=this.getCurves(),n=1/0,i=null,r=0,s=e.length;r<s;r++){var a=e[r].getNearestLocation(t);a._distance<n&&(n=a._distance,i=a)}return i},getNearestPoint:function(){return this.getNearestLocation.apply(this,arguments).getPoint()}}),new function(){function t(t,e,n){var i,r,s,a,o,h,u,l,c=e._segments,d=c.length,f=new Array(6),_=!0;function g(e){if(n)e._transformCoordinates(n,f,!1),i=f[0],r=f[1];else{var c=e._point;i=c._x,r=c._y}if(_)t.moveTo(i,r),_=!1;else{if(n)o=f[2],h=f[3];else{var d=e._handleIn;o=i+d._x,h=r+d._y}o===i&&h===r&&u===s&&l===a?t.lineTo(i,r):t.bezierCurveTo(u,l,o,h,i,r)}if(s=i,a=r,n)u=f[4],l=f[5];else{d=e._handleOut;u=s+d._x,l=a+d._y}}for(var p=0;p<d;p++)g(c[p]);e._closed&&d>0&&g(c[0])}return{_draw:function(e,n,i){var r=n.dontStart,s=n.dontFinish||n.clip,a=this.getStyle(),o=a.hasFill(),h=a.hasStroke(),u=a.getDashArray(),l=!paper.support.nativeDash&&h&&u&&u.length;function c(t){return u[(t%l+l)%l]}if(r||e.beginPath(),!r&&this._currentPath?e.currentPath=this._currentPath:(o||h&&!l||s)&&(t(e,this,i),this._closed&&e.closePath(),r||(this._currentPath=e.currentPath)),!s&&(o||h)&&(this._setStyles(e),o&&(e.fill(a.getWindingRule()),e.shadowColor="rgba(0,0,0,0)"),h)){if(l){r||e.beginPath();var d,f=new T(this,32,.25,i),_=f.length,g=-a.getDashOffset(),p=0;for(g%=_;g>0;)g-=c(p--)+c(p--);for(;g<_;)d=g+c(p++),(g>0||d>0)&&f.drawPart(e,Math.max(g,0),Math.max(d,0)),g=d+c(p++)}e.stroke()}},_drawSelected:function(e,n){e.beginPath(),t(e,this,n),e.stroke(),function(t,e,n,i){var r=i/2;function s(e){var n=a[e],i=a[e+1];c==n&&d==i||(t.beginPath(),t.moveTo(c,d),t.lineTo(n,i),t.stroke(),t.beginPath(),t.arc(n,i,r,0,2*Math.PI,!0),t.fill())}for(var a=new Array(6),o=0,h=e.length;o<h;o++){var u=e[o];u._transformCoordinates(n,a,!1);var l=u._selectionState,c=a[0],d=a[1];if(1&l&&s(2),2&l&&s(4),t.fillRect(c-r,d-r,i,i),!(4&l)){var f=t.fillStyle;t.fillStyle="#ffffff",t.fillRect(c-r+1,d-r+1,i-2,i-2),t.fillStyle=f}}}(e,this._segments,n,paper.settings.handleSize)}}},new function(){function t(t){var e=t.length,n=[],i=[],r=2;n[0]=t[0]/r;for(var s=1;s<e;s++)i[s]=1/r,r=(s<e-1?4:2)-i[s],n[s]=(t[s]-n[s-1])/r;for(s=1;s<e;s++)n[e-s-1]-=i[e-s]*n[e-s];return n}return{smooth:function(){var e=this._segments,n=e.length,i=this._closed,r=n,s=0;if(!(n<=2)){i&&(s=Math.min(n,4),r+=2*Math.min(n,s));for(var a=[],o=0;o<n;o++)a[o+s]=e[o]._point;if(i)for(o=0;o<s;o++)a[o]=e[o+n-s]._point,a[o+n+s]=e[o]._point;else r--;var u=[];for(o=1;o<r-1;o++)u[o]=4*a[o]._x+2*a[o+1]._x;u[0]=a[0]._x+2*a[1]._x,u[r-1]=3*a[r-1]._x;var l=t(u);for(o=1;o<r-1;o++)u[o]=4*a[o]._y+2*a[o+1]._y;u[0]=a[0]._y+2*a[1]._y,u[r-1]=3*a[r-1]._y;var c=t(u);if(i){o=0;for(var d=n;o<s;o++,d++){var f=o/s,_=1-f,g=o+s,p=d+s;l[d]=l[o]*f+l[d]*_,c[d]=c[o]*f+c[d]*_,l[p]=l[g]*_+l[p]*f,c[p]=c[g]*_+c[p]*f}r--}var v=null;for(o=s;o<=r-s;o++){var m=e[o-s];v&&m.setHandleIn(v.subtract(m._point)),o<r&&(m.setHandleOut(new h(l[o],c[o]).subtract(m._point)),v=o<r-1?new h(2*a[o+1]._x-l[o+1],2*a[o+1]._y-c[o+1]):new h((a[r]._x+l[r-1])/2,(a[r]._y+c[r-1])/2))}if(i&&v)(m=this._segments[0]).setHandleIn(v.subtract(m._point))}}}},new function(){function t(t){var e=t._segments;if(0===e.length)throw new Error("Use a moveTo() command first");return e[e.length-1]}return{moveTo:function(){var t=this._segments;1===t.length&&this.removeSegment(0),t.length||this._add([new P(h.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new P(h.read(arguments))])},cubicCurveTo:function(){var e=h.read(arguments),n=h.read(arguments),i=h.read(arguments),r=t(this);r.setHandleOut(e.subtract(r._point)),this._add([new P(i,n.subtract(i))])},quadraticCurveTo:function(){var e=h.read(arguments),n=h.read(arguments),i=t(this)._point;this.cubicCurveTo(e.add(i.subtract(e).multiply(1/3)),e.add(n.subtract(e).multiply(1/3)),n)},curveTo:function(){var n=h.read(arguments),i=h.read(arguments),r=e.pick(e.read(arguments),.5),s=1-r,a=t(this)._point,o=n.subtract(a.multiply(s*s)).subtract(i.multiply(r*r)).divide(2*r*s);if(o.isNaN())throw new Error("Cannot put a curve through points with parameter = "+r);this.quadraticCurveTo(o,i)},arcTo:function(){var n,i,r,s,a=t(this),o=a._point,u=h.read(arguments),c=e.peek(arguments);if("boolean"==typeof(v=e.pick(c,!0)))var d=(y=o.add(u).divide(2)).add(y.subtract(o).rotate(v?-90:90));else if(e.remain(arguments)<=2)d=u,u=h.read(arguments);else{var f=l.read(arguments);if(f.isZero())return this.lineTo(u);var p=e.read(arguments),v=!!e.read(arguments),m=!!e.read(arguments),y=o.add(u).divide(2),w=(H=o.subtract(y).rotate(-p)).x,x=H.y,b=Math.abs,C=b(f.width),S=b(f.height),k=C*C,I=S*S,M=w*w,z=x*x,A=Math.sqrt(M/k+z/I);if(A>1&&(k=(C*=A)*C,I=(S*=A)*S),b(A=(k*I-k*z-I*M)/(k*z+I*M))<1e-12&&(A=0),A<0)throw new Error("Cannot create an arc with the given arguments");n=new h(C*x/S,-S*w/C).multiply((m===v?-1:1)*Math.sqrt(A)).rotate(p).add(y),i=(r=(s=(new _).translate(n).rotate(p).scale(C,S))._inverseTransform(o)).getDirectedAngle(s._inverseTransform(u)),!v&&i>0?i-=360:v&&i<0&&(i+=360)}if(d){var O=new g(o.add(d).divide(2),d.subtract(o).rotate(90),!0),T=new g(d.add(u).divide(2),u.subtract(d).rotate(90),!0),E=new g(o,u),L=E.getSide(d);if(!(n=O.intersect(T,!0))){if(!L)return this.lineTo(u);throw new Error("Cannot create an arc with the given arguments")}i=(r=o.subtract(n)).getDirectedAngle(u.subtract(n));var N=E.getSide(n);0===N?i=L*Math.abs(i):L===N&&(i+=i<0?360:-360)}for(var j=Math.abs(i),B=j>=360?4:Math.ceil(j/90),R=i/B,D=R*Math.PI/360,F=4/3*Math.sin(D)/(1+Math.cos(D)),q=[],V=0;V<=B;V++){var H=u,Z=null;if(V<B&&(Z=r.rotate(90).multiply(F),s?(H=s._transformPoint(r),Z=s._transformPoint(r.add(Z)).subtract(H)):H=n.add(r)),0===V)a.setHandleOut(Z);else{var U=r.rotate(-90).multiply(F);s&&(U=s._transformPoint(r.add(U)).subtract(H)),q.push(new P(H,U,Z))}r=r.rotate(R)}this._add(q)},lineBy:function(){var e=h.read(arguments),n=t(this)._point;this.lineTo(n.add(e))},curveBy:function(){var n=h.read(arguments),i=h.read(arguments),r=e.read(arguments),s=t(this)._point;this.curveTo(s.add(n),s.add(i),r)},cubicCurveBy:function(){var e=h.read(arguments),n=h.read(arguments),i=h.read(arguments),r=t(this)._point;this.cubicCurveTo(r.add(e),r.add(n),r.add(i))},quadraticCurveBy:function(){var e=h.read(arguments),n=h.read(arguments),i=t(this)._point;this.quadraticCurveTo(i.add(e),i.add(n))},arcBy:function(){var n=t(this)._point,i=n.add(h.read(arguments)),r=e.pick(e.peek(arguments),!0);"boolean"==typeof r?this.arcTo(i,r):this.arcTo(i,n.add(h.read(arguments)))},closePath:function(t){this.setClosed(!0),t&&this.join()}}},{_getBounds:function(t,e){return A[t](this._segments,this._closed,this.getStyle(),e)},statics:{getBounds:function(t,e,n,i,r){var s=t[0];if(!s)return new d;var a=new Array(6),o=s._transformCoordinates(i,new Array(6),!1),h=o.slice(0,2),u=h.slice(),l=new Array(2);function c(t){t._transformCoordinates(i,a,!1);for(var e=0;e<2;e++)I._addBounds(o[e],o[e+4],a[e+2],a[e],e,r?r[e]:0,h,u,l);var n=o;o=a,a=n}for(var f=1,_=t.length;f<_;f++)c(t[f]);return e&&c(s),new d(h[0],h[1],u[0]-h[0],u[1]-h[1])},getStrokeBounds:function(t,e,n,i){if(!n.hasStroke())return A.getBounds(t,e,n,i);var r=t.length-(e?0:1),s=n.getStrokeWidth()/2,a=A._getPenPadding(s,i),o=A.getBounds(t,e,n,i,a),h=n.getStrokeJoin(),u=n.getStrokeCap(),c=s*n.getMiterLimit(),f=new d(new l(a).multiply(2));function _(t){o=o.include(i?i._transformPoint(t,t):t)}function g(t){o=o.unite(f.setCenter(i?i._transformPoint(t._point):t._point))}function p(t,e){var n=t._handleIn,i=t._handleOut;"round"===e||!n.isZero()&&!i.isZero()&&n.isCollinear(i)?g(t):A._addBevelJoin(t,e,s,c,_)}function v(t,e){"round"===e?g(t):A._addSquareCap(t,e,s,_)}for(var m=1;m<r;m++)p(t[m],h);return e?p(t[0],h):r>0&&(v(t[0],u),v(t[t.length-1],u)),o},_getPenPadding:function(t,e){if(!e)return[t,t];var n=e.shiftless(),i=n.transform(new h(t,0)),r=n.transform(new h(0,t)),s=i.getAngleInRadians(),a=i.getLength(),o=r.getLength(),u=Math.sin(s),l=Math.cos(s),c=Math.tan(s),d=-Math.atan(o*c/a),f=Math.atan(o/(c*a));return[Math.abs(a*Math.cos(d)*l-o*Math.sin(d)*u),Math.abs(o*Math.sin(f)*l+a*Math.cos(f)*u)]},_addBevelJoin:function(t,e,n,i,r,s){var a=t.getCurve(),o=a.getPrevious(),u=a.getPointAt(0,!0),l=o.getNormalAt(1,!0),c=a.getNormalAt(0,!0),d=l.getDirectedAngle(c)<0?-n:n;if(l.setLength(d),c.setLength(d),s&&(r(u),r(u.add(l))),"miter"===e){var f=new g(u.add(l),new h(-l.y,l.x),!0).intersect(new g(u.add(c),new h(-c.y,c.x),!0),!0);if(f&&u.getDistance(f)<=i&&(r(f),!s))return}s||r(u.add(l)),r(u.add(c))},_addSquareCap:function(t,e,n,i,r){var s=t._point,a=t.getLocation(),o=a.getNormal().multiply(n);r&&(i(s.subtract(o)),i(s.add(o))),"square"===e&&(s=s.add(o.rotate(0===a.getParameter()?-90:90))),i(s.add(o)),i(s.subtract(o))},getHandleBounds:function(t,e,n,i,r,s){for(var a=new Array(6),o=1/0,h=-o,u=o,l=h,c=0,f=t.length;c<f;c++){t[c]._transformCoordinates(i,a,!1);for(var _=0;_<6;_+=2){var g=0===_?s:r,p=g?g[0]:0,v=g?g[1]:0,m=a[_],y=a[_+1],w=m-p,x=m+p,b=y-v,C=y+v;w<o&&(o=w),x>h&&(h=x),b<u&&(u=b),C>l&&(l=C)}}return new d(o,u,h-o,l-u)},getRoughBounds:function(t,e,n,i){var r=n.hasStroke()?n.getStrokeWidth()/2:0,s=r;return r>0&&("miter"===n.getStrokeJoin()&&(s=r*n.getMiterLimit()),"square"===n.getStrokeCap()&&(s=Math.max(s,r*Math.sqrt(2)))),A.getHandleBounds(t,e,n,i,A._getPenPadding(r,i),A._getPenPadding(s,i))}}});A.inject({statics:new function(){var t=.5522847498307936,n=[new P([-1,0],[0,t],[0,-t]),new P([0,-1],[-t,0],[t,0]),new P([1,0],[0,-t],[0,t]),new P([0,1],[t,0],[-t,0])];function i(t,n,i){var r=e.getNamed(i),s=new A(r&&!1===r.insert&&m.NO_INSERT);return s._add(t),s._closed=n,s.set(r)}function r(t,e,r){for(var s=new Array(4),a=0;a<4;a++){var o=n[a];s[a]=new P(o._point.multiply(e).add(t),o._handleIn.multiply(e),o._handleOut.multiply(e))}return i(s,!0,r)}return{Line:function(){return i([new P(h.readNamed(arguments,"from")),new P(h.readNamed(arguments,"to"))],!1,arguments)},Circle:function(){var t=h.readNamed(arguments,"center"),n=e.readNamed(arguments,"radius");return r(t,new l(n),arguments)},Rectangle:function(){var e,n=d.readNamed(arguments,"rectangle"),r=l.readNamed(arguments,"radius",0,{readNull:!0}),s=n.getBottomLeft(!0),a=n.getTopLeft(!0),o=n.getTopRight(!0),h=n.getBottomRight(!0);if(!r||r.isZero())e=[new P(s),new P(a),new P(o),new P(h)];else{var u=(r=l.min(r,n.getSize(!0).divide(2))).width,c=r.height,f=u*t,_=c*t;e=[new P(s.add(u,0),null,[-f,0]),new P(s.subtract(0,c),[0,_]),new P(a.add(0,c),null,[0,-_]),new P(a.add(u,0),[-f,0],null),new P(o.subtract(u,0),null,[f,0]),new P(o.add(0,c),[0,-_],null),new P(h.subtract(0,c),null,[0,_]),new P(h.subtract(u,0),[f,0])]}return i(e,!0,arguments)},RoundRectangle:"#Rectangle",Ellipse:function(){var t=x._readEllipse(arguments);return r(t.center,t.radius,arguments)},Oval:"#Ellipse",Arc:function(){var t=h.readNamed(arguments,"from"),n=h.readNamed(arguments,"through"),i=h.readNamed(arguments,"to"),r=e.getNamed(arguments),s=new A(r&&!1===r.insert&&m.NO_INSERT);return s.moveTo(t),s.arcTo(n,i),s.set(r)},RegularPolygon:function(){for(var t=h.readNamed(arguments,"center"),n=e.readNamed(arguments,"sides"),r=e.readNamed(arguments,"radius"),s=360/n,a=!(n%3),o=new h(0,a?-r:r),u=a?-1:.5,l=new Array(n),c=0;c<n;c++)l[c]=new P(t.add(o.rotate((c+u)*s)));return i(l,!0,arguments)},Star:function(){for(var t=h.readNamed(arguments,"center"),n=2*e.readNamed(arguments,"points"),r=e.readNamed(arguments,"radius1"),s=e.readNamed(arguments,"radius2"),a=360/n,o=new h(0,-1),u=new Array(n),l=0;l<n;l++)u[l]=new P(t.add(o.rotate(a*l).multiply(l%2?s:r)));return i(u,!0,arguments)}}}});var O=z.extend({_class:"CompoundPath",_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||("string"==typeof t?this.setPathData(t):this.addChildren(Array.isArray(t)?t:arguments))},insertChildren:function e(n,i,r){for(var s=i.length-1;s>=0;s--){(o=i[s])instanceof O&&(i.splice.apply(i,[s,1].concat(o.removeChildren())),o.remove())}i=e.base.call(this,n,i,r,A);s=0;for(var a=!r&&i&&i.length;s<a;s++){var o;(o=i[s])._clockwise===t&&o.setClockwise(0===o._index)}return i},reverse:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)t[e].reverse()},smooth:function(){for(var t=0,e=this._children.length;t<e;t++)this._children[t].smooth()},reduce:function t(){for(var e=this._children,n=e.length-1;n>=0;n--){var i;(i=e[n].reduce()).isEmpty()&&e.splice(n,1)}return 0===e.length?((i=new A(m.NO_INSERT)).insertAbove(this),i.setStyle(this._style),this.remove(),i):t.base.call(this)},isClockwise:function(){var t=this.getFirstChild();return t&&t.isClockwise()},setClockwise:function(t){this.isClockwise()!==!!t&&this.reverse()},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],n=0,i=t.length;n<i;n++)e.push.apply(e,t[n].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getFirstCurve()},getArea:function(){for(var t=this._children,e=0,n=0,i=t.length;n<i;n++)e+=t[n].getArea();return e}},{beans:!0,getPathData:function(t,e){for(var n=this._children,i=[],r=0,s=n.length;r<s;r++){var a=n[r],o=a._matrix;i.push(a.getPathData(t&&!o.isIdentity()?t.chain(o):t,e))}return i.join(" ")}},{_getChildHitTestOptions:function(t){return t.class===A||"path"===t.type?t:new e(t,{fill:!1})},_draw:function(t,e,n){var i=this._children;if(0!==i.length){if(this._currentPath)t.currentPath=this._currentPath;else{e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var r=0,s=i.length;r<s;r++)i[r].draw(t,e,n);this._currentPath=t.currentPath}if(!e.clip){this._setStyles(t);var a=this._style;a.hasFill()&&(t.fill(a.getWindingRule()),t.shadowColor="rgba(0,0,0,0)"),a.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,n){for(var i=this._children,r=0,s=i.length;r<s;r++){var a=i[r],o=a._matrix;n[a._id]||a._drawSelected(t,o.isIdentity()?e:e.chain(o))}}},new function(){function t(t,e){var n=t._children;if(e&&0===n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}var n={moveTo:function(){var e=t(this),n=e&&e.isEmpty()?e:new A(m.NO_INSERT);n!==e&&this.addChild(n),n.moveTo.apply(n,arguments)},moveBy:function(){var e=t(this,!0),n=e&&e.getLastSegment(),i=h.read(arguments);this.moveTo(n?i.add(n._point):i)},closePath:function(e){t(this,!0).closePath(e)}};return e.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],(function(e){n[e]=function(){var n=t(this,!0);n[e].apply(n,arguments)}})),n});z.inject(new function(){var t={unite:function(t){return 1===t||0===t},intersect:function(t){return 2===t},subtract:function(t){return 1===t},exclude:function(t){return 1===t}};function e(t,e){var n=t.clone(!1).reduce().transform(null,!0,!0);return e?n.resolveCrossings().reorient():n}function n(t,e,n,i,r){var s=new t(m.NO_INSERT);return s.addChildren(e,!0),r&&(s=s.reduce()),s.insertAbove(i&&n.isSibling(i)&&n.getIndex()<i.getIndex()?i:n),s.setStyle(n._style),s}function i(t,i,r){if(!t._children&&!t._closed)return function(t,i,r){if(!i||!i._children&&!i._closed||!/^(subtract|intersect)$/.test(r))return null;var s=e(t,!1),a=e(i,!1),o=s.getIntersections(a,(function(t){return t.isOverlap()||t.isCrossing()})),h="subtract"===r,u=[];function l(t){if(a.contains(t.getPointAt(t.getLength()/2))^h)return u.unshift(t),!0}for(var c=o.length-1;c>=0;c--){var d=o[c].split();d&&(l(d)&&d.getFirstSegment().setHandleIn(0,0),s.getLastSegment().setHandleOut(0,0))}return l(s),n(y,u,t,i)}(t,i,r);var a=e(t,!0),o=i&&t!==i&&e(i,!0);o&&/^(subtract|exclude)$/.test(r)^o.isClockwise()!==a.isClockwise()&&o.reverse();var h=M.expand(a.getIntersections(o,(function(t){return o&&t.isOverlap()||t.isCrossing()})));s(h);var c=[],d=[];function f(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];c.push.apply(c,i._segments),d.push.apply(d,i._getMonoCurves())}}f(a._children||[a]),o&&f(o._children||[o]);for(var _=0,g=h.length;_<g;_++)u(h[_]._segment,a,o,d,r);for(_=0,g=c.length;_<g;_++){var p=c[_];null==p._winding&&u(p,a,o,d,r)}return n(O,l(c,r),t,i,!0)}function r(t,e){for(var n=t;n;){if(n===e)return;n=n._prev}for(;t._next&&t._next!==e;)t=t._next;if(!t._next){for(;e._prev;)e=e._prev;t._next=e,e._prev=t}}function s(t){for(var e,n,i=!1,s=[],a=t.length-1;a>=0;a--){var o,h=t[a],u=h._curve,l=h._parameter,c=l;u!==e?i=!u.hasHandles():n>0&&(l/=n),l<4e-7?o=u._segment1:l>.9999996?o=u._segment2:(o=u.divide(l,!0,!0)._segment1,i&&s.push(o)),h._setSegment(o);var d=o._intersection,f=h._intersection;if(d){r(d,f);for(var _=d;_;)r(_._intersection,d),_=_._next}else o._intersection=f;e=u,n=c}a=0;for(var g=s.length;a<g;a++)s[a].clearHandles()}function o(t,e,n,i){var r=2e-7,s=4e-7,u=1-s,l=t.x,c=t.y,d=0,f=0,_=[],g=Math.abs;if(n){for(var p=-1/0,v=1/0,m=c-r,y=c+r,w=0,x=e.length;w<x;w++){var b=e[w].values;if(I.solveCubic(b,0,l,_,0,1)>0)for(var C=_.length-1;C>=0;C--){var S=I.getPoint(b,_[C]).y;S<m&&S>p?p=S:S>y&&S<v&&(v=S)}}v=(v+c)/2,(p=(p+c)/2)>-1/0&&(d=o(new h(l,p),e,!1,i)),v<1/0&&(f=o(new h(l,v),e,!1,i))}else{var P,k,M=l-r,z=l+r,A=!1;for(w=0,x=e.length;w<x;w++){var O=e[w],T=(b=O.values,O.winding);if(T&&(1===T&&c>=b[1]&&c<=b[7]||c>=b[7]&&c<=b[1])&&1===I.solveCubic(b,1,c,_,0,1)){var E=_[0];if(!(E>u&&A&&O.next!==e[w+1]||E<s&&k>u&&O.previous===P)){var L=I.getPoint(b,E).x,N=I.getTangent(b,E).y,j=!1;a.isZero(N)&&!I.isStraight(b)||E<s&&N*I.getTangent(O.previous.values,1).y<0||E>u&&N*I.getTangent(O.next.values,0).y<0?i&&L>=M&&L<=z&&(++d,++f,j=!0):L<=M?(d+=T,j=!0):L>=z&&(f+=T,j=!0),O.previous!==e[w-1]&&(A=E<s&&j)}P=O,k=E}}}return Math.max(g(d),g(f))}function u(t,e,n,i,r){var s=[],a=t,h=0,u=0;do{var l=(p=t.getCurve()).getLength();s.push({segment:t,curve:p,length:l}),h+=l,t=t.getNext()}while(t&&!t._intersection&&t!==a);for(var c=0;c<3;c++){l=h*(c+1)/4;for(var d=0,f=s.length;d<f;d++){var _=s[d],g=_.length;if(l<=g){(l<2e-7||g-l<2e-7)&&(l=g/2);var p,v=(p=_.curve)._path,m=v._parent,y=p.getPointAt(l),w=p.isHorizontal();m instanceof O&&(v=m),u+="subtract"===r&&n&&(v===e&&n._getWinding(y,w)||v===n&&!e._getWinding(y,w))?0:o(y,i,w);break}l-=g}}for(var x=Math.round(u/3),b=s.length-1;b>=0;b--)s[b].segment._winding=x}function l(e,n){var i,r,s=[],o=t[n],h={unite:{1:2},intersect:{2:1}}[n];function u(t,e){if(t._visited)return!1;if(!o)return!0;var n=t._winding,i=t._intersection;return i&&e&&h&&i.isOverlap()&&(n=h[n]||n),o(n)}function l(t){return t===i||t===r}function c(t,e){if(!t._next)return t;for(;t;){var n=t._segment,i=n.getNext(),r=i._intersection;if(l(i)||!n._visited&&!i._visited&&(!o||(!e||u(n))&&(!(e&&r&&r.isOverlap())&&u(i)||!e&&r&&u(r._segment))))return t;t=t._next}return null}function d(t,e){for(;t;){var n=t._segment;if(l(n))return n;t=t[e?"_next":"_prev"]}}for(var f=0,_=e.length;f<_;f++){var g=e[f],p=null,v=!1;if(u(g,!0)){for(i=r=null;!v;){var y=g._intersection,w=p&&g._handleIn,x=(y=y&&(c(y,!0)||c(y,!1))||y)&&y._segment;if(x&&u(x)&&(g=x),g._visited){if(!(v=l(g))&&y){var b=d(y,!0)||d(y,!1);b&&(g=b,v=!0)}break}p||(p=new A(m.NO_INSERT),i=g,r=x),p.add(new P(g._point,w,g._handleOut)),g._visited=!0,v=l(g=g.getNext())}v?(p.firstSegment.setHandleIn(g._handleIn),p.setClosed(!0)):p&&(console.error("Boolean operation resulted in open path","segments =",p._segments.length,"length =",p.getLength()),p=null),p&&(p._segments.length>8||!a.isZero(p.getArea()))&&(s.push(p),p=null)}}return s}return{_getWinding:function(t,e,n){return o(t,this._getMonoCurves(),e,n)},unite:function(t){return i(this,t,"unite")},intersect:function(t){return i(this,t,"intersect")},subtract:function(t){return i(this,t,"subtract")},exclude:function(t){return i(this,t,"exclude")},divide:function(t){return n(y,[this.subtract(t),this.intersect(t)],this,t,!0)},resolveCrossings:function(){var t=this.getCrossings();if(!t.length)return this;s(M.expand(t));for(var e=this._children||[this],i=[],r=0,a=e.length;r<a;r++)i.push.apply(i,e[r]._segments);return n(O,l(i),this,null,!1)}}}),A.inject({_getMonoCurves:function(){var t,e=this._monoCurves;function n(n){var i=n[1],r=n[7],s={values:n,winding:i===r?0:i>r?-1:1,previous:t,next:null};t&&(t.next=s),e.push(s),t=s}function i(t){if(0!==I.getLength(t)){var e=t[1],i=t[3],r=t[5],s=t[7];if(I.isStraight(t))n(t);else{var o=3*(i-r)-e+s,h=2*(e+r)-4*i,u=i-e,l=[],c=a.solveQuadratic(o,h,u,l,4e-7,.9999996);if(0===c)n(t);else{l.sort();var d=l[0],f=I.subdivide(t,d);n(f[0]),c>1&&(d=(l[1]-d)/(1-d),n((f=I.subdivide(f[1],d))[0])),n(f[1])}}}}if(!e){e=this._monoCurves=[];for(var r=this.getCurves(),s=this._segments,o=0,h=r.length;o<h;o++)i(r[o].getValues());if(!this._closed&&s.length>1){var u=s[s.length-1]._point,l=s[0]._point,c=u._x,d=u._y,f=l._x,_=l._y;i([c,d,c,d,f,_,f,_])}if(e.length>0){var g=e[0],p=e[e.length-1];g.previous=p,p.next=g}}return e},getInteriorPoint:function(){var t=this.getBounds().getCenter(!0);if(!this.contains(t)){for(var e=this._getMonoCurves(),n=[],i=t.y,r=[],s=0,a=e.length;s<a;s++){var o=e[s].values;if((1===e[s].winding&&i>=o[1]&&i<=o[7]||i>=o[7]&&i<=o[1])&&I.solveCubic(o,1,i,n,0,1)>0)for(var h=n.length-1;h>=0;h--)r.push(I.getPoint(o,n[h]).x);if(r.length>1)break}t.x=(r[0]+r[1])/2}return t},reorient:function(){return this.setClockwise(!0),this}}),O.inject({_getMonoCurves:function(){for(var t=this._children,e=[],n=0,i=t.length;n<i;n++)e.push.apply(e,t[n]._getMonoCurves());return e},reorient:function(){var t=this.removeChildren().sort((function(t,e){return e.getBounds().getArea()-t.getBounds().getArea()}));if(t.length>0){this.addChildren(t);for(var e=t[0].isClockwise(),n=1,i=t.length;n<i;n++){for(var r=t[n].getInteriorPoint(),s=0,a=n-1;a>=0;a--)t[a].contains(r)&&s++;t[n].setClockwise(s%2==0&&e)}}return this}});var T=e.extend({_class:"PathIterator",initialize:function(t,e,n,i){var r,s=[],a=[],o=0,h=1/(e||32),u=t._segments,l=u[0];function c(t,e){var n=I.getValues(t,e,i);s.push(n),d(n,t._index,0,1)}function d(t,e,i,r){if(r-i>h&&!I.isFlatEnough(t,n||.25)){var s=I.subdivide(t,.5),u=(i+r)/2;d(s[0],e,i,u),d(s[1],e,u,r)}else{var l=t[6]-t[0],c=t[7]-t[1],f=Math.sqrt(l*l+c*c);f>1e-6&&(o+=f,a.push({offset:o,value:r,index:e}))}}for(var f=1,_=u.length;f<_;f++)c(l,r=u[f]),l=r;t._closed&&c(r,u[0]),this.curves=s,this.parts=a,this.length=o,this.index=0},getParameterAt:function(t){for(var e,n=this.index;e=n,!(0==n||this.parts[--n].offset<t););for(var i=this.parts.length;e<i;e++){if((o=this.parts[e]).offset>=t){this.index=e;var r=this.parts[e-1],s=r&&r.index==o.index?r.value:0,a=r?r.offset:0;return{value:s+(o.value-s)*(t-a)/(o.offset-a),index:o.index}}}var o;return{value:1,index:(o=this.parts[this.parts.length-1]).index}},drawPart:function(t,e,n){e=this.getParameterAt(e),n=this.getParameterAt(n);for(var i=e.index;i<=n.index;i++){var r=I.getPart(this.curves[i],i==e.index?e.value:0,i==n.index?n.value:1);i==e.index&&t.moveTo(r[0],r[1]),t.bezierCurveTo.apply(t,r.slice(2))}}},e.each(I.evaluateMethods,(function(t){this[t+"At"]=function(e,n){var i=this.getParameterAt(e);return I[t](this.curves[i.index],i.value,n)}}),{})),E=e.extend({initialize:function(t,e){for(var n,i=this.points=[],r=t._segments,s=0,a=r.length;s<a;s++){var o=r[s].point.clone();n&&n.equals(o)||(i.push(o),n=o)}t._closed&&(this.closed=!0,i.unshift(i[i.length-1]),i.push(i[1])),this.error=e},fit:function(){var t=this.points,e=t.length,n=this.segments=e>0?[new P(t[0])]:[];return e>1&&this.fitCubic(0,e-1,t[1].subtract(t[0]).normalize(),t[e-2].subtract(t[e-1]).normalize()),this.closed&&(n.shift(),n.pop()),n},fitCubic:function(t,e,n,i){if(e-t!=1){for(var r,s=this.chordLengthParameterize(t,e),a=Math.max(this.error,this.error*this.error),o=!0,h=0;h<=4;h++){var u=this.generateBezier(t,e,s,n,i),l=this.findMaxError(t,e,u,s);if(l.error<this.error&&o)return void this.addCurve(u);if(r=l.index,l.error>=a)break;o=this.reparameterize(t,e,s,u),a=l.error}var c=this.points[r-1].subtract(this.points[r]),d=this.points[r].subtract(this.points[r+1]),f=c.add(d).divide(2).normalize();this.fitCubic(t,r,n,f),this.fitCubic(r,e,f.negate(),i)}else{var _=this.points[t],g=this.points[e],p=_.getDistance(g)/3;this.addCurve([_,_.add(n.normalize(p)),g.add(i.normalize(p)),g])}},addCurve:function(t){this.segments[this.segments.length-1].setHandleOut(t[1].subtract(t[0])),this.segments.push(new P(t[3],t[2].subtract(t[3])))},generateBezier:function(t,e,n,i,r){for(var s=1e-12,a=this.points[t],o=this.points[e],h=[[0,0],[0,0]],u=[0,0],l=0,c=e-t+1;l<c;l++){var d=n[l],f=1-d,_=3*d*f,g=f*f*f,p=_*f,v=_*d,m=d*d*d,y=i.normalize(p),w=r.normalize(v),x=this.points[t+l].subtract(a.multiply(g+p)).subtract(o.multiply(v+m));h[0][0]+=y.dot(y),h[0][1]+=y.dot(w),h[1][0]=h[0][1],h[1][1]+=w.dot(w),u[0]+=y.dot(x),u[1]+=w.dot(x)}var b,C,S=h[0][0]*h[1][1]-h[1][0]*h[0][1];if(Math.abs(S)>s){var P=h[0][0]*u[1]-h[1][0]*u[0];b=(u[0]*h[1][1]-u[1]*h[0][1])/S,C=P/S}else{var k=h[0][0]+h[0][1],I=h[1][0]+h[1][1];b=C=Math.abs(k)>s?u[0]/k:Math.abs(I)>s?u[1]/I:0}var M,z,A=o.getDistance(a),O=s*A;if(b<O||C<O)b=C=A/3;else{var T=o.subtract(a);M=i.normalize(b),z=r.normalize(C),M.dot(T)-z.dot(T)>A*A&&(b=C=A/3,M=z=null)}return[a,a.add(M||i.normalize(b)),o.add(z||r.normalize(C)),o]},reparameterize:function(t,e,n,i){for(var r=t;r<=e;r++)n[r-t]=this.findRoot(i,this.points[r],n[r-t]);r=1;for(var s=n.length;r<s;r++)if(n[r]<=n[r-1])return!1;return!0},findRoot:function(t,e,n){for(var i=[],r=[],s=0;s<=2;s++)i[s]=t[s+1].subtract(t[s]).multiply(3);for(s=0;s<=1;s++)r[s]=i[s+1].subtract(i[s]).multiply(2);var a=this.evaluate(3,t,n),o=this.evaluate(2,i,n),h=this.evaluate(1,r,n),u=a.subtract(e),l=o.dot(o)+u.dot(h);return Math.abs(l)<1e-6?n:n-u.dot(o)/l},evaluate:function(t,e,n){for(var i=e.slice(),r=1;r<=t;r++)for(var s=0;s<=t-r;s++)i[s]=i[s].multiply(1-n).add(i[s+1].multiply(n));return i[0]},chordLengthParameterize:function(t,e){for(var n=[0],i=t+1;i<=e;i++)n[i-t]=n[i-t-1]+this.points[i].getDistance(this.points[i-1]);i=1;for(var r=e-t;i<=r;i++)n[i]/=n[r];return n},findMaxError:function(t,e,n,i){for(var r=Math.floor((e-t+1)/2),s=0,a=t+1;a<e;a++){var o=this.evaluate(3,n,i[a-t]).subtract(this.points[a]),h=o.x*o.x+o.y*o.y;h>=s&&(s=h,r=a)}return{error:s,index:r}}}),L=m.extend({_class:"TextItem",_boundsSelected:!0,_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsGetter:"getBounds",initialize:function(n){this._content="",this._lines=[];var i=n&&e.isPlainObject(n)&&n.x===t&&n.y===t;this._initialize(i&&n,!i&&h.read(arguments))},_equals:function(t){return this._content===t._content},_clone:function t(e,n,i){return e.setContent(this._content),t.base.call(this,e,n,i)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/gm),this._changed(265)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),N=L.extend({_class:"PointText",initialize:function(){L.apply(this,arguments)},clone:function(t){return this._clone(new N(m.NO_INSERT),t)},getPoint:function(){var t=this._matrix.getTranslation();return new u(t.x,t.y,this,"setPoint")},setPoint:function(){var t=h.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t){if(this._content){this._setStyles(t);var e=this._style,n=this._lines,i=e.getLeading(),r=t.shadowColor;t.font=e.getFontStyle(),t.textAlign=e.getJustification();for(var s=0,a=n.length;s<a;s++){t.shadowColor=r;var o=n[s];e.hasFill()&&(t.fillText(o,0,0),t.shadowColor="rgba(0,0,0,0)"),e.hasStroke()&&t.strokeText(o,0,0),t.translate(0,i)}}},_getBounds:function(t,e){var n=this._style,i=this._lines,r=i.length,s=n.getJustification(),a=n.getLeading(),o=this.getView().getTextWidth(n.getFontStyle(),i),h=0;"left"!==s&&(h-=o/("center"===s?2:1));var u=new d(h,r?-.75*a:0,o,r*a);return e?e._transformBounds(u,u):u}}),j=e.extend(new function(){var t,n={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},i={},r={};var a=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],u={"rgb-hsb":function(t,e,n){var i=Math.max(t,e,n),r=i-Math.min(t,e,n);return[0===r?0:60*(i==t?(e-n)/r+(e<n?6:0):i==e?(n-t)/r+2:(t-e)/r+4),0===i?0:r/i,i]},"hsb-rgb":function(t,e,n){var i,r=(t=(t/60%6+6)%6)-(i=Math.floor(t)),s=[n,n*(1-e),n*(1-e*r),n*(1-e*(1-r))];return[s[(i=a[i])[0]],s[i[1]],s[i[2]]]},"rgb-hsl":function(t,e,n){var i=Math.max(t,e,n),r=Math.min(t,e,n),s=i-r,a=0===s,o=(i+r)/2;return[a?0:60*(i==t?(e-n)/s+(e<n?6:0):i==e?(n-t)/s+2:(t-e)/s+4),a?0:o<.5?s/(i+r):s/(2-i-r),o]},"hsl-rgb":function(t,e,n){if(0===e)return[n,n,n];for(var i=[(t=(t/360%1+1)%1)+1/3,t,t-1/3],r=n<.5?n*(1+e):n+e-n*e,s=2*n-r,a=[],o=0;o<3;o++){var h=i[o];h<0&&(h+=1),h>1&&(h-=1),a[o]=6*h<1?s+6*(r-s)*h:2*h<1?r:3*h<2?s+(r-s)*(2/3-h)*6:s}return a},"rgb-gray":function(t,e,n){return[.2989*t+.587*e+.114*n]},"gray-rgb":function(t){return[t,t,t]},"gray-hsb":function(t){return[0,0,t]},"gray-hsl":function(t){return[0,0,t]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return e.each(n,(function(t,r){i[r]=[],e.each(t,(function(t,s){var a=e.capitalize(t),o=/^(hue|saturation)$/.test(t),u=i[r][s]="gradient"===t?function(t){var e=this._components[0];return e!==(t=B.read(Array.isArray(t)?t:arguments,0,{readNull:!0}))&&(e&&e._removeOwner(this),t&&t._addOwner(this)),t}:"gradient"===r?function(){return h.read(arguments,0,{readNull:"highlight"===t,clone:!0})}:function(t){return null==t||isNaN(t)?0:t};this["get"+a]=function(){return this._type===r||o&&/^hs[bl]$/.test(this._type)?this._components[s]:this._convert(r)[s]},this["set"+a]=function(t){this._type===r||o&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(r),this._properties=n[r],this._type=r),this._components[s]=u.call(this,t),this._changed()}}),this)}),{_class:"Color",_readIndex:!0,initialize:function e(s){var a,h,u,l,c=Array.prototype.slice,d=arguments,f=0;Array.isArray(s)&&(s=(d=s)[0]);var _=null!=s&&typeof s;if("string"===_&&s in n&&(a=s,s=d[1],Array.isArray(s)?(h=s,u=d[2]):(this.__read&&(f=1),d=c.call(d,1),_=typeof s)),!h){if(l="number"===_?d:"object"===_&&null!=s.length?s:null){a||(a=l.length>=3?"rgb":"gray");var g=n[a].length;u=l[g],this.__read&&(f+=l===arguments?g+(null!=u?1:0):1),l.length>g&&(l=c.call(l,0,g))}else if("string"===_)a="rgb",h=function(e){var n,i=e.match(/^#(\w{1,2})(\w{1,2})(\w{1,2})$/);if(i){n=[0,0,0];for(var s=0;s<3;s++){var a=i[s+1];n[s]=parseInt(1==a.length?a+a:a,16)/255}}else if(i=e.match(/^rgba?\((.*)\)$/)){s=0;for(var o=(n=i[1].split(",")).length;s<o;s++)a=+n[s],n[s]=s<3?a/255:a}else{var h=r[e];if(!h){t||((t=Y.getContext(1,1)).globalCompositeOperation="copy"),t.fillStyle="rgba(0,0,0,0)",t.fillStyle=e,t.fillRect(0,0,1,1);var u=t.getImageData(0,0,1,1).data;h=r[e]=[u[0]/255,u[1]/255,u[2]/255]}n=h.slice()}return n}(s),4===h.length&&(u=h[3],h.length--);else if("object"===_)if(s.constructor===e){if(a=s._type,h=s._components.slice(),u=s._alpha,"gradient"===a)for(var p=1,v=h.length;p<v;p++){var m=h[p];m&&(h[p]=m.clone())}}else if(s.constructor===B)a="gradient",l=d;else{var y=n[a="hue"in s?"lightness"in s?"hsl":"hsb":"gradient"in s||"stops"in s||"radial"in s?"gradient":"gray"in s?"gray":"rgb"],w=i[a];this._components=h=[];for(p=0,v=y.length;p<v;p++){null==(x=s[y[p]])&&0===p&&"gradient"===a&&"stops"in s&&(x={stops:s.stops,radial:s.radial}),null!=(x=w[p].call(this,x))&&(h[p]=x)}u=s.alpha}this.__read&&a&&(f=1)}if(this._type=a||"rgb",this._id=o.get(e),!h){this._components=h=[];for(p=0,v=(w=i[this._type]).length;p<v;p++){var x;null!=(x=w[p].call(this,l&&l[p]))&&(h[p]=x)}}this._components=h,this._properties=n[this._type],this._alpha=u,this.__read&&(this.__read=f)},_serialize:function(t,n){var i=this.getComponents();return e.serialize(/^(gray|rgb)$/.test(this._type)?i:[this._type].concat(i),t,!0,n)},_changed:function(){this._canvasStyle=null,this._owner&&this._owner._changed(65)},_convert:function(t){var e;return this._type===t?this._components.slice():(e=u[this._type+"-"+t])?e.apply(this,this._components):u["rgb-"+t].apply(this,u[this._type+"-rgb"].apply(this,this._components))},convert:function(t){return new j(t,this._convert(t),this._alpha)},getType:function(){return this._type},setType:function(t){this._components=this._convert(t),this._properties=n[t],this._type=t},getComponents:function(){var t=this._components.slice();return null!=this._alpha&&t.push(this._alpha),t},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(t){this._alpha=null==t?null:Math.min(Math.max(t,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(t){var n=e.isPlainValue(t,!0)?j.read(arguments):t;return n===this||n&&this._class===n._class&&this._type===n._type&&this._alpha===n._alpha&&e.equals(this._components,n._components)||!1},toString:function(){for(var t=this._properties,e=[],n="gradient"===this._type,i=s.instance,r=0,a=t.length;r<a;r++){var o=this._components[r];null!=o&&e.push(t[r]+": "+(n?o:i.number(o)))}return null!=this._alpha&&e.push("alpha: "+i.number(this._alpha)),"{ "+e.join(", ")+" }"},toCSS:function(t){var e=this._convert("rgb"),n=t||null==this._alpha?1:this._alpha;function i(t){return Math.round(255*(t<0?0:t>1?1:t))}return e=[i(e[0]),i(e[1]),i(e[2])],n<1&&e.push(n<0?0:n),t?"#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1):(4==e.length?"rgba(":"rgb(")+e.join(",")+")"},toCanvasStyle:function(t){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var e,n=this._components,i=n[0],r=i._stops,s=n[1],a=n[2];if(i._radial){var o=a.getDistance(s),h=n[3];if(h){var u=h.subtract(s);u.getLength()>o&&(h=s.add(u.normalize(o-.1)))}var l=h||s;e=t.createRadialGradient(l.x,l.y,0,s.x,s.y,o)}else e=t.createLinearGradient(s.x,s.y,a.x,a.y);for(var c=0,d=r.length;c<d;c++){var f=r[c];e.addColorStop(f._rampPoint,f._color.toCanvasStyle())}return this._canvasStyle=e},transform:function(t){if("gradient"===this._type){for(var e=this._components,n=1,i=e.length;n<i;n++){var r=e[n];t._transformPoint(r,r,!0)}this._changed()}},statics:{_types:n,random:function(){var t=Math.random;return new j(t(),t(),t())}}})},new function(){return e.each({add:function(t,e){return t+e},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e}},(function(t,e){this[e]=function(e){e=j.read(arguments);for(var n=this._type,i=this._components,r=e._convert(n),s=0,a=i.length;s<a;s++)r[s]=t(i[s],r[s]);return new j(n,r,null!=this._alpha?t(this._alpha,e.getAlpha()):null)}}),{})}),B=e.extend({_class:"Gradient",initialize:function(t,e){this._id=o.get(),t&&this._set(t)&&(t=e=null),this._stops||this.setStops(t||["white","black"]),null==this._radial&&this.setRadial("string"==typeof e&&"radial"===e||e||!1)},_serialize:function(t,n){return n.add(this,(function(){return e.serialize([this._stops,this._radial],t,!0,n)}))},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(e){var n=this._owners?this._owners.indexOf(e):-1;-1!=n&&(this._owners.splice(n,1),0===this._owners.length&&(this._owners=t))},clone:function(){for(var t=[],e=0,n=this._stops.length;e<n;e++)t[e]=this._stops[e].clone();return new B(t,this._radial)},getStops:function(){return this._stops},setStops:function(e){if(this.stops)for(var n=0,i=this._stops.length;n<i;n++)this._stops[n]._owner=t;if(e.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");this._stops=R.readAll(e,0,{clone:!0});for(n=0,i=this._stops.length;n<i;n++){var r=this._stops[n];r._owner=this,r._defaultRamp&&r.setRampPoint(n/(i-1))}this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class&&this._stops.length===t._stops.length){for(var e=0,n=this._stops.length;e<n;e++)if(!this._stops[e].equals(t._stops[e]))return!1;return!0}return!1}}),R=e.extend({_class:"GradientStop",initialize:function(e,n){var i,r;e&&(n===t&&Array.isArray(e)?(i=e[0],r=e[1]):e.color?(i=e.color,r=e.rampPoint):(i=e,r=n),this.setColor(i),this.setRampPoint(r))},clone:function(){return new R(this._color.clone(),this._rampPoint)},_serialize:function(t,n){return e.serialize([this._color,this._rampPoint],t,!0,n)},_changed:function(){this._owner&&this._owner._changed(65)},getRampPoint:function(){return this._rampPoint},setRampPoint:function(t){this._defaultRamp=null==t,this._rampPoint=t||0,this._changed()},getColor:function(){return this._color},setColor:function(t){this._color=j.read(arguments),this._color===t&&(this._color=t.clone()),this._color._owner=this,this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._rampPoint==t._rampPoint||!1}}),D=e.extend(new function(){var n={fillColor:t,strokeColor:t,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],windingRule:"nonzero",shadowColor:t,shadowBlur:0,shadowOffset:new h,selectedColor:t,fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,font:"sans-serif",leading:null,justification:"left"},i={strokeWidth:97,strokeCap:97,strokeJoin:97,strokeScaling:105,miterLimit:97,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},r={beans:!0},s={_defaults:n,_textDefaults:new e(n,{fillColor:new j}),beans:!0};return e.each(n,(function(n,a){var o=/Color$/.test(a),u="shadowOffset"===a,l=e.capitalize(a),c=i[a],d="set"+l,f="get"+l;s[d]=function(e){var n=this._owner,i=n&&n._children;if(i&&i.length>0&&!(n instanceof O))for(var r=0,s=i.length;r<s;r++)i[r]._style[d](e);else{var h=this._values[a];h!==e&&(o&&(h&&(h._owner=t),e&&e.constructor===j&&(e._owner&&(e=e.clone()),e._owner=n)),this._values[a]=e,n&&n._changed(c||65))}},s[f]=function(n){var i=this._owner,r=i&&i._children;if(!r||0===r.length||n||i instanceof O){var s;if((s=this._values[a])===t)(s=this._defaults[a])&&s.clone&&(s=s.clone());else{var l=o?j:u?h:null;!l||s&&s.constructor===l||(this._values[a]=s=l.read([s],0,{readNull:!0,clone:!0}),s&&o&&(s._owner=i))}return s}for(var c=0,d=r.length;c<d;c++){var _=r[c]._style[f]();if(0===c)s=_;else if(!e.equals(s,_))return t}return s},r[f]=function(t){return this._style[f](t)},r[d]=function(t){this._style[d](t)}})),m.inject(r),s},{_class:"Style",initialize:function(t,e,n){this._values={},this._owner=e,this._project=e&&e._project||n||paper.project,e instanceof L&&(this._defaults=this._textDefaults),t&&this.set(t)},set:function(t){var e=t instanceof D,n=e?t._values:t;if(n)for(var i in n)if(i in this._defaults){var r=n[i];this[i]=r&&e&&r.clone?r.clone():r}},equals:function(t){return t===this||t&&this._class===t._class&&e.equals(this._values,t._values)||!1},hasFill:function(){return!!this.getFillColor()},hasStroke:function(){return!!this.getStrokeColor()&&this.getStrokeWidth()>0},hasShadow:function(){return!!this.getShadowColor()&&this.getShadowBlur()>0},getView:function(){return this._project.getView()},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),n=this.getFontSize();return/pt|em|%|px/.test(n)&&(n=this.getView().getPixelSize(n)),null!=e?e:1.2*n}}),F=new function(){function t(t,e,n,i){for(var r=["","webkit","moz","Moz","ms","o"],s=e[0].toUpperCase()+e.substring(1),a=0;a<6;a++){var o=r[a],h=o?o+s:e;if(h in t){if(!n)return t[h];t[h]=i;break}}}return{getStyles:function(t){var e=t&&9!==t.nodeType?t.ownerDocument:t,n=e&&e.defaultView;return n&&n.getComputedStyle(t,"")},getBounds:function(t,e){var n,i=t.ownerDocument,r=i.body,s=i.documentElement;try{n=t.getBoundingClientRect()}catch(t){n={left:0,top:0,width:0,height:0}}var a=n.left-(s.clientLeft||r.clientLeft||0),o=n.top-(s.clientTop||r.clientTop||0);if(!e){var h=i.defaultView;a+=h.pageXOffset||s.scrollLeft||r.scrollLeft,o+=h.pageYOffset||s.scrollTop||r.scrollTop}return new d(a,o,n.width,n.height)},getViewportBounds:function(t){var e=t.ownerDocument,n=e.defaultView,i=e.documentElement;return new d(0,0,n.innerWidth||i.clientWidth,n.innerHeight||i.clientHeight)},getOffset:function(t,e){return F.getBounds(t,e).getPoint()},getSize:function(t){return F.getBounds(t,!0).getSize()},isInvisible:function(t){return F.getSize(t).equals(new l(0,0))},isInView:function(t){return!F.isInvisible(t)&&F.getViewportBounds(t).intersects(F.getBounds(t,!0))},getPrefixed:function(e,n){return t(e,n)},setPrefixed:function(e,n,i){if("object"==typeof n)for(var r in n)t(e,r,!0,n[r]);else t(e,n,!0,i)}}},q={add:function(t,e){for(var n in e)for(var i=e[n],r=n.split(/[\s,]+/g),s=0,a=r.length;s<a;s++)t.addEventListener(r[s],i,!1)},remove:function(t,e){for(var n in e)for(var i=e[n],r=n.split(/[\s,]+/g),s=0,a=r.length;s<a;s++)t.removeEventListener(r[s],i,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new h(e.pageX||e.clientX+document.documentElement.scrollLeft,e.pageY||e.clientY+document.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return q.getPoint(t).subtract(F.getOffset(e||q.getTarget(t)))},stop:function(t){t.stopPropagation(),t.preventDefault()}};q.requestAnimationFrame=new function(){var t,e=F.getPrefixed(window,"requestAnimationFrame"),n=!1,r=[],s=!0;function a(){for(var t=r.length-1;t>=0;t--){var o=r[t],h=o[0],u=o[1];(!u||("true"==i.getAttribute(u,"keepalive")||s)&&F.isInView(u))&&(r.splice(t,1),h())}e&&(r.length?e(a):n=!1)}return q.add(window,{focus:function(){s=!0},blur:function(){s=!1}}),function(i,s){r.push([i,s]),e?n||(e(a),n=!0):t||(t=setInterval(a,1e3/60))}};var V=e.extend(n,{_class:"View",initialize:function t(e,n){var r;this._project=e,this._scope=e._scope,this._element=n,this._pixelRatio||(this._pixelRatio=window.devicePixelRatio||1),this._id=n.getAttribute("id"),null==this._id&&n.setAttribute("id",this._id="view-"+t._id++),q.add(n,this._viewEvents);var s="none";function a(t){return n[t]||parseInt(n.getAttribute(t),10)}function o(){var t=F.getSize(n);return t.isNaN()||t.isZero()?new l(a("width"),a("height")):t}if(F.setPrefixed(n.style,{userSelect:s,touchAction:s,touchCallout:s,contentZooming:s,userDrag:s,tapHighlightColor:"rgba(0,0,0,0)"}),i.hasAttribute(n,"resize")){var h=this;q.add(window,this._windowEvents={resize:function(){h.setViewSize(o())}})}if(this._setViewSize(r=o()),i.hasAttribute(n,"stats")&&"undefined"!=typeof Stats){this._stats=new Stats;var u=this._stats.domElement,c=u.style,d=F.getOffset(n);c.position="absolute",c.left=d.x+"px",c.top=d.y+"px",document.body.appendChild(u)}t._views.push(this),t._viewsById[this._id]=this,this._viewSize=r,(this._matrix=new _)._owner=this,this._zoom=1,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0},remove:function(){return!!this._project&&(V._focused===this&&(V._focused=null),V._views.splice(V._views.indexOf(this),1),delete V._viewsById[this._id],this._project._view===this&&(this._project._view=null),q.remove(this._element,this._viewEvents),q.remove(window,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0)},_events:e.each(["onResize","onMouseDown","onMouseUp","onMouseMove"],(function(t){this[t]={install:function(t){this._installEvent(t)},uninstall:function(t){this._uninstallEvent(t)}}}),{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,_requestFrame:function(){var t=this;q.requestAnimationFrame((function(){t._requested=!1,t._animate&&(t._requestFrame(),t._handleFrame())}),this._element),this._requested=!0},_handleFrame:function(){paper=this._scope;var t=Date.now()/1e3,n=this._before?t-this._before:0;this._before=t,this._handlingFrame=!0,this.emit("frame",new e({delta:n,time:this._time+=n,count:this._count++})),this._stats&&this._stats.update(),this._handlingFrame=!1,this.update()},_animateItem:function(t,e){var n=this._frameItems;e?(n[t._id]={item:t,time:0,count:0},1==++this._frameItemCount&&this.on("frame",this._handleFrameItems)):(delete n[t._id],0==--this._frameItemCount&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var n in this._frameItems){var i=this._frameItems[n];i.item.emit("frame",new e(t,{time:i.time+=t.delta,count:i.count++}))}},_update:function(){this._project._needsUpdate=!0,this._handlingFrame||(this._animate?this._handleFrame():this.update())},_changed:function(t){1&t&&(this._project._needsUpdate=!0)},_transform:function(t){this._matrix.concatenate(t),this._bounds=null,this._update()},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var t=this._viewSize;return new c(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=l.read(arguments),e=t.subtract(this._viewSize);e.isZero()||(this._viewSize.set(t.width,t.height),this._setViewSize(t),this._bounds=null,this.emit("resize",{size:t,delta:e}),this._update())},_setViewSize:function(t){var e=this._element;e.width=t.width,e.height=t.height},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new d(new h,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=h.read(arguments);this.scrollBy(t.subtract(this.getCenter()))},getZoom:function(){return this._zoom},setZoom:function(t){this._transform((new _).scale(t/this._zoom,this.getCenter())),this._zoom=t},isVisible:function(){return F.isInView(this._element)},scrollBy:function(){this._transform((new _).translate(h.read(arguments).negate()))},play:function(){this._animate=!0,this._requested||this._requestFrame()},pause:function(){this._animate=!1},draw:function(){this.update()},projectToView:function(){return this._matrix._transformPoint(h.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(h.read(arguments))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){return"string"==typeof e&&(e=document.getElementById(e)),new H(t,e)}}},new function(){var t,e,n,i=!1;function r(t){var e=q.getTarget(t);return e.getAttribute&&V._viewsById[e.getAttribute("id")]}function s(t,e){return t.viewToProject(q.getOffset(e,t._element))}function a(){if(!V._focused||!V._focused.isVisible())for(var t=0,e=V._views.length;t<e;t++){var i=V._views[t];if(i&&i.isVisible()){V._focused=n=i;break}}}function o(t,e,n){t._handleEvent("mousemove",e,n);var r=t._scope.tool;return r&&r._handleEvent(i&&r.responds("mousedrag")?"mousedrag":"mousemove",e,n),t.update(),r}var h,u,l,c=window.navigator;c.pointerEnabled||c.msPointerEnabled?(h="pointerdown MSPointerDown",u="pointermove MSPointerMove",l="pointerup pointercancel MSPointerUp MSPointerCancel"):(h="touchstart",u="touchmove",l="touchend touchcancel","ontouchstart"in window&&c.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(h+=" mousedown",u+=" mousemove",l+=" mouseup"));var d={"selectstart dragstart":function(t){i&&t.preventDefault()}},f={mouseout:function(t){var e=V._focused,n=q.getRelatedTarget(t);!e||n&&"HTML"!==n.nodeName||o(e,s(e,t),t)},scroll:a};d[h]=function(e){var n=V._focused=r(e),a=s(n,e);i=!0,n._handleEvent("mousedown",a,e),(t=n._scope.tool)&&t._handleEvent("mousedown",a,e),n.update()},f[u]=function(h){var u=V._focused;if(!i){var l=r(h);l?(u!==l&&o(u,s(u,h),h),e=u,u=V._focused=n=l):n&&n===u&&(u=V._focused=e,a())}if(u){var c=s(u,h);(i||u.getBounds().contains(c))&&(t=o(u,c,h))}},f[l]=function(e){var n=V._focused;if(n&&i){var r=s(n,e);i=!1,n._handleEvent("mouseup",r,e),t&&t._handleEvent("mouseup",r,e),n.update()}},q.add(document,f),q.add(window,{load:a});var _={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:d,_handleEvent:function(){},_installEvent:function(t){var e=this._eventCounters;if(e)for(var n in _)e[n]=(e[n]||0)+(_[n][t]||0)},_uninstallEvent:function(t){var e=this._eventCounters;if(e)for(var n in _)e[n]-=_[n][t]||0},statics:{updateFocus:a}}}),H=V.extend({_class:"CanvasView",initialize:function(t,e){if(!(e instanceof HTMLCanvasElement)){var n=l.read(arguments,1);if(n.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+[].slice.call(arguments,1));e=Y.getCanvas(n)}if(this._context=e.getContext("2d"),this._eventCounters={},this._pixelRatio=1,!/^off|false$/.test(i.getAttribute(e,"hidpi"))){var r=window.devicePixelRatio||1,s=F.getPrefixed(this._context,"backingStorePixelRatio")||1;this._pixelRatio=r/s}V.call(this,t,e)},_setViewSize:function(t){var e=this._element,n=this._pixelRatio,r=t.width,s=t.height;if(e.width=r*n,e.height=s*n,1!==n){if(!i.hasAttribute(e,"resize")){var a=e.style;a.width=r+"px",a.height=s+"px"}this._context.scale(n,n)}},getPixelSize:function(t){var e,n=paper.browser;if(n&&n.firefox){var i=this._element.parentNode,r=document.createElement("div");r.style.fontSize=t,i.appendChild(r),e=parseFloat(F.getStyles(r).fontSize),i.removeChild(r)}else{var s=this._context,a=s.font;s.font=t+" serif",e=parseFloat(s.font),s.font=a}return e},getTextWidth:function(t,e){var n=this._context,i=n.font,r=0;n.font=t;for(var s=0,a=e.length;s<a;s++)r=Math.max(r,n.measureText(e[s]).width);return n.font=i,r},update:function(t){var e=this._project;if(!e||!t&&!e._needsUpdate)return!1;var n=this._context,i=this._viewSize;return n.clearRect(0,0,i.width+1,i.height+1),e.draw(n,this._matrix,this._pixelRatio),e._needsUpdate=!1,!0}},new function(){var t,e,n,i,r,s,a,o,h;function u(t,e,n,i,r,s){var a,o=r;function h(t){if(t.responds(e)&&(a||(a=new G(e,n,i,r,s?i.subtract(s):null)),t.emit(e,a)&&a.isStopped))return n.preventDefault(),!0}for(;o;){if(h(o))return!0;o=o.getParent()}return!!h(t)}return{_handleEvent:function(l,c,d){if(this._eventCounters[l]){var f=this._project.hitTest(c,{tolerance:0,fill:!0,stroke:!0}),_=f&&f.item,g=!1;switch(l){case"mousedown":for(g=u(this,l,d,c,_),o=r==_&&Date.now()-h<300,i=r=_,t=e=n=c,a=!g&&_;a&&!a.responds("mousedrag");)a=a._parent;break;case"mouseup":g=u(this,l,d,c,_,t),a&&(e&&!e.equals(c)&&u(this,"mousedrag",d,c,a,e),_!==a&&u(this,"mousemove",d,c,_,n=c)),!g&&_&&_===i&&(h=Date.now(),u(this,o&&i.responds("doubleclick")?"doubleclick":"click",d,t,_),o=!1),i=a=null;break;case"mousemove":a&&(g=u(this,"mousedrag",d,c,a,e)),g||(_!==s&&(n=c),g=u(this,l,d,c,_,n)),e=n=c,_!==s&&(u(this,"mouseleave",d,c,s),s=_,u(this,"mouseenter",d,c,_))}return g}}}}),Z=e.extend({_class:"Event",initialize:function(t){this.event=t},isPrevented:!1,isStopped:!1,preventDefault:function(){this.isPrevented=!0,this.event.preventDefault()},stopPropagation:function(){this.isStopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getModifiers:function(){return W.modifiers}}),U=Z.extend({_class:"KeyEvent",initialize:function(t,e,n,i){Z.call(this,i),this.type=t?"keydown":"keyup",this.key=e,this.character=n},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),W=new function(){var t,n,i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"option",19:"pause",20:"caps-lock",27:"escape",32:"space",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete",91:"command",93:"command",224:"command"},r={9:!0,13:!0,32:!0},s=new e({shift:!1,control:!1,option:!1,command:!1,capsLock:!1,space:!1}),a={},o={};function h(n,r,u,l){var c,d=u?String.fromCharCode(u):"",f=i[r],_=f||d.toLowerCase(),g=n?"keydown":"keyup",p=V._focused,v=p&&p.isVisible()&&p._scope,m=v&&v.tool;if(o[_]=n,n?a[r]=u:delete a[r],f&&(c=e.camelize(f))in s){s[c]=n;var y=paper.browser;if("command"===c&&y&&y.mac)if(n)t={};else{for(var w in t)w in a&&h(!1,w,t[w],l);t=null}}else n&&t&&(t[r]=u);m&&m.responds(g)&&(paper=v,m.emit(g,new U(n,_,d,l)),p&&p.update())}return q.add(document,{keydown:function(t){var e=t.which||t.keyCode;e in i||s.command?h(!0,e,e in r||s.command?e:0,t):n=e},keypress:function(t){null!=n&&(h(!0,n,t.which||t.keyCode,t),n=null)},keyup:function(t){var e=t.which||t.keyCode;e in a&&h(!1,e,a[e],t)}}),q.add(window,{blur:function(t){for(var e in a)h(!1,e,a[e],t)}}),{modifiers:s,isDown:function(t){return!!o[t]}}},G=Z.extend({_class:"MouseEvent",initialize:function(t,e,n,i,r){Z.call(this,e),this.type=t,this.point=n,this.target=i,this.delta=r},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),$=Z.extend({_class:"ToolEvent",_item:null,initialize:function(t,e,n){this.tool=t,this.type=e,this.event=n},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return/^mouse(down|up)$/.test(this.type)?this.tool._downCount:this.tool._count},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,n=e._parent;/^(Group|CompoundPath)$/.test(n._class);)e=n,n=n._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),X=r.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onActivate","onDeactivate","onEditOptions","onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onKeyDown","onKeyUp"],initialize:function(t){r.call(this),this._firstMove=!0,this._count=0,this._downCount=0,this._set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,null!=t&&null!=this._maxDistance&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,null!=this._minDistance&&null!=t&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_updateEvent:function(t,e,n,i,r,s,a){if(!r){if(null!=n||null!=i){var o=null!=n?n:0,h=e.subtract(this._point),u=h.getLength();if(u<o)return!1;if(null!=i&&0!=i)if(u>i)e=this._point.add(h.normalize(i));else if(a)return!1}if(s&&e.equals(this._point))return!1}switch(this._lastPoint=r&&"mousemove"==t?e:this._point,this._point=e,t){case"mousedown":this._lastPoint=this._downPoint,this._downPoint=this._point,this._downCount++;break;case"mouseup":this._lastPoint=this._downPoint}return this._count=r?0:this._count+1,!0},_fireEvent:function(t,e){var n=paper.project._removeSets;if(n){"mouseup"===t&&(n.mousedrag=null);var i=n[t];if(i){for(var r in i){var s=i[r];for(var a in n){var o=n[a];o&&o!=i&&delete o[s._id]}s.remove()}n[t]=null}}return this.responds(t)&&this.emit(t,new $(this,t,e))},_handleEvent:function(t,e,n){paper=this._scope;var i=!1;switch(t){case"mousedown":this._updateEvent(t,e,null,null,!0,!1,!1),i=this._fireEvent(t,n);break;case"mousedrag":for(var r=!1,s=!1;this._updateEvent(t,e,this.minDistance,this.maxDistance,!1,r,s);)i=this._fireEvent(t,n)||i,r=!0,s=!0;break;case"mouseup":!e.equals(this._point)&&this._updateEvent("mousedrag",e,this.minDistance,this.maxDistance,!1,!1,!1)&&(i=this._fireEvent("mousedrag",n)),this._updateEvent(t,e,null,this.maxDistance,!1,!1,!1),i=this._fireEvent(t,n)||i,this._updateEvent(t,e,null,null,!0,!1,!1),this._firstMove=!0;break;case"mousemove":for(;this._updateEvent(t,e,this.minDistance,this.maxDistance,this._firstMove,!0,!1);)i=this._fireEvent(t,n)||i,this._firstMove=!1}return i&&n.preventDefault(),i}}),J=function(e,n,i,r){r=r===t||r;var s=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");return s.open(e.toUpperCase(),n,r),"overrideMimeType"in s&&s.overrideMimeType("text/plain"),s.onreadystatechange=function(){if(4===s.readyState){var t=s.status;if(0!==t&&200!==t)throw new Error("Could not load "+n+" (Error "+t+")");i.call(s,s.responseText)}},s.send(null)},Y={canvases:[],getCanvas:function(t,e){var n;"object"==typeof t&&(e=t.height,t=t.width);var i=(n=this.canvases.length?this.canvases.pop():document.createElement("canvas")).getContext("2d");return n.width===t&&n.height===e?i.clearRect(0,0,t+1,e+1):(n.width=t,n.height=e),i.save(),n},getContext:function(t,e){return this.getCanvas(t,e).getContext("2d")},release:function(t){var e=t.canvas?t.canvas:t;e.getContext("2d").restore(),this.canvases.push(e)}},K=new function(){var t,n,i,r,s,a,o,h,u,l,c,d=Math.min,f=Math.max,_=Math.abs;function g(t,e,n){return.2989*t+.587*e+.114*n}function p(t,e,n,i){var r=i-g(t,e,n),s=(i=g(u=t+r,l=e+r,c=n+r),d(u,l,c)),a=f(u,l,c);if(s<0){var o=i-s;u=i+(u-i)*i/o,l=i+(l-i)*i/o,c=i+(c-i)*i/o}if(a>255){var h=255-i,_=a-i;u=i+(u-i)*h/_,l=i+(l-i)*h/_,c=i+(c-i)*h/_}}function v(t,e,n){return f(t,e,n)-d(t,e,n)}function m(t,e,n,i){var r,s=[t,e,n],a=f(t,e,n),o=d(t,e,n);r=0===d(o=o===t?0:o===e?1:2,a=a===t?0:a===e?1:2)?1===f(o,a)?2:1:0,s[a]>s[o]?(s[r]=(s[r]-s[o])*i/(s[a]-s[o]),s[a]=i):s[r]=s[a]=0,s[o]=0,u=s[0],l=s[1],c=s[2]}var y={multiply:function(){u=s*t/255,l=a*n/255,c=o*i/255},screen:function(){u=s+t-s*t/255,l=a+n-a*n/255,c=o+i-o*i/255},overlay:function(){u=s<128?2*s*t/255:255-2*(255-s)*(255-t)/255,l=a<128?2*a*n/255:255-2*(255-a)*(255-n)/255,c=o<128?2*o*i/255:255-2*(255-o)*(255-i)/255},"soft-light":function(){var e=t*s/255;u=e+s*(255-(255-s)*(255-t)/255-e)/255,l=(e=n*a/255)+a*(255-(255-a)*(255-n)/255-e)/255,c=(e=i*o/255)+o*(255-(255-o)*(255-i)/255-e)/255},"hard-light":function(){u=t<128?2*t*s/255:255-2*(255-t)*(255-s)/255,l=n<128?2*n*a/255:255-2*(255-n)*(255-a)/255,c=i<128?2*i*o/255:255-2*(255-i)*(255-o)/255},"color-dodge":function(){u=0===s?0:255===t?255:d(255,255*s/(255-t)),l=0===a?0:255===n?255:d(255,255*a/(255-n)),c=0===o?0:255===i?255:d(255,255*o/(255-i))},"color-burn":function(){u=255===s?255:0===t?0:f(0,255-255*(255-s)/t),l=255===a?255:0===n?0:f(0,255-255*(255-a)/n),c=255===o?255:0===i?0:f(0,255-255*(255-o)/i)},darken:function(){u=s<t?s:t,l=a<n?a:n,c=o<i?o:i},lighten:function(){u=s>t?s:t,l=a>n?a:n,c=o>i?o:i},difference:function(){(u=s-t)<0&&(u=-u),(l=a-n)<0&&(l=-l),(c=o-i)<0&&(c=-c)},exclusion:function(){u=s+t*(255-s-s)/255,l=a+n*(255-a-a)/255,c=o+i*(255-o-o)/255},hue:function(){m(t,n,i,v(s,a,o)),p(u,l,c,g(s,a,o))},saturation:function(){m(s,a,o,v(t,n,i)),p(u,l,c,g(s,a,o))},luminosity:function(){p(s,a,o,g(t,n,i))},color:function(){p(t,n,i,g(s,a,o))},add:function(){u=d(s+t,255),l=d(a+n,255),c=d(o+i,255)},subtract:function(){u=f(s-t,0),l=f(a-n,0),c=f(o-i,0)},average:function(){u=(s+t)/2,l=(a+n)/2,c=(o+i)/2},negation:function(){u=255-_(255-t-s),l=255-_(255-n-a),c=255-_(255-i-o)}},w=this.nativeModes=e.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],(function(t){this[t]=!0}),{}),x=Y.getContext(1,1);e.each(y,(function(t,e){var n="darken"===e,i=!1;x.save();try{x.fillStyle=n?"#300":"#a00",x.fillRect(0,0,1,1),x.globalCompositeOperation=e,x.globalCompositeOperation===e&&(x.fillStyle=n?"#a00":"#300",x.fillRect(0,0,1,1),i=x.getImageData(0,0,1,1).data[0]!==n?170:51)}catch(t){}x.restore(),w[e]=i})),Y.release(x),this.process=function(e,d,f,_,g){var p=d.canvas,v="normal"===e;if(v||w[e])f.save(),f.setTransform(1,0,0,1,0,0),f.globalAlpha=_,v||(f.globalCompositeOperation=e),f.drawImage(p,g.x,g.y),f.restore();else{var m=y[e];if(!m)return;for(var x=f.getImageData(g.x,g.y,p.width,p.height),b=x.data,C=d.getImageData(0,0,p.width,p.height).data,S=0,P=b.length;S<P;S+=4){t=C[S],s=b[S],n=C[S+1],a=b[S+1],i=C[S+2],o=b[S+2],r=C[S+3],h=b[S+3],m();var k=r*_/255,I=1-k;b[S]=k*u+I*s,b[S+1]=k*l+I*a,b[S+2]=k*c+I*o,b[S+3]=r*_+I*h}f.putImageData(x,g.x,g.y)}}},Q=e.each({fillColor:["fill","color"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof z||t instanceof x||t instanceof L)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","string"]},(function(t,n){var i=e.capitalize(n),r=t[2];this[n]={type:t[1],property:n,attribute:t[0],toSVG:r,fromSVG:r&&e.each(r,(function(t,e){this[t]=e}),{}),exportFilter:t[3],get:"get"+i,set:"set"+i}}),{}),tt={href:"http://www.w3.org/1999/xlink",xlink:"http://www.w3.org/2000/xmlns"};return new function(){var t;function n(e,n){for(var i in n){var r=n[i],s=tt[i];"number"==typeof r&&(r=t.number(r)),s?e.setAttributeNS(s,i,r):e.setAttribute(i,r)}return e}function i(t,e){return n(document.createElementNS("http://www.w3.org/2000/svg",t),e)}function r(n,i,r){var s=new e,o=n.getTranslation();if(i){var h=(n=n.shiftless())._inverseTransform(o);s[r?"cx":"x"]=h.x,s[r?"cy":"y"]=h.y,o=null}if(!n.isIdentity()){var u=n.decompose();if(u&&!u.shearing){var l=[],c=u.rotation,d=u.scaling;o&&!o.isZero()&&l.push("translate("+t.point(o)+")"),a.isZero(d.x-1)&&a.isZero(d.y-1)||l.push("scale("+t.point(d)+")"),c&&l.push("rotate("+t.number(c)+")"),s.transform=l.join(" ")}else s.transform="matrix("+n.getValues().join(",")+")"}return s}function o(t,e){for(var s=r(t._matrix),a=t._children,o=i("g",s),h=0,u=a.length;h<u;h++){var l=a[h],c=g(l,e);if(c)if(l.isClipMask()){var d=i("clipPath");d.appendChild(c),f(l,d,"clip"),n(o,{"clip-path":"url(#"+d.id+")"})}else o.appendChild(c)}return o}function h(t){var e=t._type,n=t._radius,s=r(t._matrix,!0,"rectangle"!==e);if("rectangle"===e){e="rect";var a=t._size,o=a.width,h=a.height;s.x-=o/2,s.y-=h/2,s.width=o,s.height=h,n.isZero()&&(n=null)}return n&&("circle"===e?s.r=n:(s.rx=n.width,s.ry=n.height)),i(e,s)}var u,l={Group:o,Layer:o,Raster:function(t,e){var n=r(t._matrix,!0),s=t.getSize(),a=t.getImage();return n.x-=s.width/2,n.y-=s.height/2,n.width=s.width,n.height=s.height,n.href=!1===e.embedImages&&a&&a.src||t.toDataURL(),i("image",n)},Path:function(e,n){var s=n.matchShapes;if(s){var a=e.toShape(!1);if(a)return h(a)}var o,u=e._segments,l=r(e._matrix);if(0===u.length)return null;if(s&&!e.hasHandles())if(u.length>=3){o=e._closed?"polygon":"polyline";for(var c=[],d=0,f=u.length;d<f;d++)c.push(t.point(u[d]._point));l.points=c.join(" ")}else{o="line";var _=u[0]._point,g=u[u.length-1]._point;l.set({x1:_.x,y1:_.y,x2:g.x,y2:g.y})}else o="path",l.d=e.getPathData(null,n.precision);return i(o,l)},Shape:h,CompoundPath:function(t,e){var n=r(t._matrix),s=t.getPathData(null,e.precision);return s&&(n.d=s),i("path",n)},PlacedSymbol:function(e,n){var s=r(e._matrix,!0),a=e.getSymbol(),o=d(a,"symbol"),h=a.getDefinition(),u=h.getBounds();return o||((o=i("symbol",{viewBox:t.rectangle(u)})).appendChild(g(h,n)),f(a,o,"symbol")),s.href="#"+o.id,s.x+=u.x,s.y+=u.y,s.width=t.number(u.width),s.height=t.number(u.height),s.overflow="visible",i("use",s)},PointText:function(t){var e=i("text",r(t._matrix,!0));return e.textContent=t._content,e}};function c(r,s,a){var o={},h=!a&&r.getParent();return null!=r._name&&(o.id=r._name),e.each(Q,(function(n){var s=n.get,a=n.type,u=r[s]();if(n.exportFilter?n.exportFilter(r,u):!h||!e.equals(h[s](),u)){if("color"===a&&null!=u){var l=u.getAlpha();l<1&&(o[n.attribute+"-opacity"]=l)}o[n.attribute]=null==u?"none":"number"===a?t.number(u):"color"===a?u.gradient?function(t){var e=d(t,"color");if(!e){var n,r=t.getGradient(),s=r._radial,a=t.getOrigin().transform(),o=t.getDestination().transform();if(s){n={cx:a.x,cy:a.y,r:a.getDistance(o)};var h=t.getHighlight();h&&(h=h.transform(),n.fx=h.x,n.fy=h.y)}else n={x1:a.x,y1:a.y,x2:o.x,y2:o.y};n.gradientUnits="userSpaceOnUse",e=i((s?"radial":"linear")+"Gradient",n);for(var u=r._stops,l=0,c=u.length;l<c;l++){var _=u[l],g=_._color,p=g.getAlpha();n={offset:_._rampPoint,"stop-color":g.toCSS(!0)},p<1&&(n["stop-opacity"]=p),e.appendChild(i("stop",n))}f(t,e,"color")}return"url(#"+e.id+")"}(u):u.toCSS(!0):"array"===a?u.join(","):"lookup"===a?n.toSVG[u]:u}})),1===o.opacity&&delete o.opacity,r._visible||(o.visibility="hidden"),n(s,o)}function d(t,e){return u||(u={ids:{},svgs:{}}),t&&u.svgs[e+"-"+t._id]}function f(t,e,n){u||d();var i=u.ids[n]=(u.ids[n]||0)+1;e.id=n+"-"+i,u.svgs[n+"-"+t._id]=e}function _(t,e){var n=t,r=null;if(u){for(var s in n="svg"===t.nodeName.toLowerCase()&&t,u.svgs)r||(n||(n=i("svg")).appendChild(t),r=n.insertBefore(i("defs"),n.firstChild)),r.appendChild(u.svgs[s]);u=null}return e.asString?(new XMLSerializer).serializeToString(n):n}function g(t,e,n){var i=l[t._class],r=i&&i(t,e);if(r){var s=e.onExport;s&&(r=s(t,r,e)||r);var a=JSON.stringify(t._data);a&&"{}"!==a&&"null"!==a&&r.setAttribute("data-paper-data",a)}return r&&c(t,r,n)}function v(e){return e||(e={}),t=new s(e.precision),e}m.inject({exportSVG:function(t){return _(g(this,t=v(t),!0),t)}}),p.inject({exportSVG:function(t){t=v(t);var e=this.layers,n=this.getView(),s=n.getViewSize(),a=i("svg",{x:0,y:0,width:s.width,height:s.height,version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),o=a,h=n._matrix;h.isIdentity()||(o=a.appendChild(i("g",r(h))));for(var u=0,l=e.length;u<l;u++)o.appendChild(g(e[u],t,!0));return _(a,t)}})},new function(){function n(t,e,n,i){var r=tt[e],s=r?t.getAttributeNS(r,e):t.getAttribute(e);return"null"===s&&(s=null),null==s?i?null:n?"":0:n?s:parseFloat(s)}function i(t,e,i,r){return e=n(t,e,!1,r),i=n(t,i,!1,r),!r||null!=e&&null!=i?new h(e,i):null}function r(t,e,i,r){return e=n(t,e,!1,r),i=n(t,i,!1,r),!r||null!=e&&null!=i?new l(e,i):null}function s(t,e,n){return"none"===t?null:"number"===e?parseFloat(t):"array"===e?t?t.split(/[\s,]+/g).map(parseFloat):[]:"color"===e?k(t)||t:"lookup"===e?n[t]:t}function a(t,e,n,i){var r=t.childNodes,s="clippath"===e,a=new y,o=a._project,h=o._currentStyle,u=[];if(s||(a=S(a,t,i),o._currentStyle=a._style.clone()),i)for(var l=t.querySelectorAll("defs"),c=0,d=l.length;c<d;c++)I(l[c],n,!1);for(c=0,d=r.length;c<d;c++){var f,_=r[c];1!==_.nodeType||"defs"===_.nodeName.toLowerCase()||!(f=I(_,n,!1))||f instanceof v||u.push(f)}return a.addChildren(u),s&&(a=S(a.reduce(),t,i)),o._currentStyle=h,(s||"defs"===e)&&(a.remove(),a=null),a}function o(t,e){for(var n=t.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),i=[],r=0,s=n.length;r<s;r+=2)i.push(new h(parseFloat(n[r]),parseFloat(n[r+1])));var a=new A(i);return"polygon"===e&&a.closePath(),a}function u(t,e){var r,s,a,o,h=(n(t,"href",!0)||"").substring(1),u="radialgradient"===e;if(h)r=P[h].getGradient();else{for(var l=t.childNodes,c=[],d=0,f=l.length;d<f;d++){var _=l[d];1===_.nodeType&&c.push(S(new R,_))}r=new B(c,u)}return u?(a=(s=i(t,"cx","cy")).add(n(t,"r"),0),o=i(t,"fx","fy",!0)):(s=i(t,"x1","y1"),a=i(t,"x2","y2")),S(new j(r,s,a,o),t),null}var c={"#document":function(t,e,n,i){for(var r=t.childNodes,s=0,a=r.length;s<a;s++){var o=r[s];if(1===o.nodeType){var h=o.nextSibling;document.body.appendChild(o);var u=I(o,n,i);return h?t.insertBefore(o,h):t.appendChild(o),u}}},g:a,svg:a,clippath:a,polygon:o,polyline:o,path:function(t){var e=t.getAttribute("d"),n={pathData:e};return(e.match(/m/gi)||[]).length>1||/z\S+/i.test(e)?new O(n):new A(n)},lineargradient:u,radialgradient:u,image:function(t){var e=new b(n(t,"href",!0));return e.on("load",(function(){var e=r(t,"width","height");this.setSize(e);var n=this._matrix._transformPoint(i(t,"x","y").add(e.divide(2)));this.translate(n)})),e},symbol:function(t,e,n,i){return new v(a(t,e,n,i),!0)},defs:a,use:function(t){var e=(n(t,"href",!0)||"").substring(1),r=P[e],s=i(t,"x","y");return r?r instanceof v?r.place(s):r.clone().translate(s):null},circle:function(t){return new x.Circle(i(t,"cx","cy"),n(t,"r"))},ellipse:function(t){return new x.Ellipse({center:i(t,"cx","cy"),radius:r(t,"rx","ry")})},rect:function(t){var e=i(t,"x","y"),n=r(t,"width","height"),s=r(t,"rx","ry");return new x.Rectangle(new d(e,n),s)},line:function(t){return new A.Line(i(t,"x1","y1"),i(t,"x2","y2"))},text:function(t){var e=new N(i(t,"x","y").add(i(t,"dx","dy")));return e.setContent(t.textContent.trim()||""),e}};function f(t,e,n,i){for(var r=(i.getAttribute(n)||"").split(/\)\s*/g),s=new _,a=0,o=r.length;a<o;a++){var h=r[a];if(!h)break;for(var u=h.split(/\(\s*/),l=u[0],c=u[1].split(/[\s,]+/g),d=0,f=c.length;d<f;d++)c[d]=parseFloat(c[d]);switch(l){case"matrix":s.concatenate(new _(c[0],c[1],c[2],c[3],c[4],c[5]));break;case"rotate":s.rotate(c[0],c[1],c[2]);break;case"translate":s.translate(c[0],c[1]);break;case"scale":s.scale(c);break;case"skewX":s.skew(c[0],0);break;case"skewY":s.skew(0,c[0])}}t.transform(s)}function g(t,e,n){var i=t["fill-opacity"===n?"getFillColor":"getStrokeColor"]();i&&i.setAlpha(parseFloat(e))}var w=e.set(e.each(Q,(function(t){this[t.attribute]=function(e,n){if(e[t.set](s(n,t.type,t.fromSVG)),"color"===t.type&&e instanceof x){var i=e[t.get]();i&&i.transform((new _).translate(e.getPosition(!0).negate()))}}}),{}),{id:function(t,e){P[e]=t,t.setName&&t.setName(e)},"clip-path":function(t,e){var n=k(e);if(n){if((n=n.clone()).setClipMask(!0),!(t instanceof y))return new y(n,t);t.insertChild(0,n)}},gradientTransform:f,transform:f,"fill-opacity":g,"stroke-opacity":g,visibility:function(t,e){t.setVisible("visible"===e)},display:function(t,e){t.setVisible(null!==e)},"stop-color":function(t,e){t.setColor&&t.setColor(e)},"stop-opacity":function(t,e){t._color&&t._color.setAlpha(parseFloat(e))},offset:function(t,e){var n=e.match(/(.*)%$/);t.setRampPoint(n?n[1]/100:parseFloat(e))},viewBox:function(t,e,n,i,a){var o=new d(s(e,"array")),h=r(i,"width","height",!0);if(t instanceof y){var u=h?o.getSize().divide(h):1,l=(new _).translate(o.getPoint()).scale(u);t.transform(l.inverted())}else if(t instanceof v){h&&o.setSize(h);var c="visible"!=C(i,"overflow",a),f=t._definition;c&&!o.contains(f.getBounds())&&((c=new x.Rectangle(o).transform(f._matrix)).setClipMask(!0),f.addChild(c))}}});function C(n,i,r){var s=n.attributes[i],a=s&&s.value;if(!a){var o=e.camelize(i);(a=n.style[o])||r.node[o]===r.parent[o]||(a=r.node[o])}return a?"none"===a?null:a:t}function S(n,i,r){var s={node:F.getStyles(i)||{},parent:!r&&F.getStyles(i.parentNode)||{}};return e.each(w,(function(r,a){var o=C(i,a,s);o!==t&&(n=e.pick(r(n,o,a,i,s),n))})),n}var P={};function k(t){var e=t&&t.match(/\((?:#|)([^)']+)/);return e&&P[e[1]]}function I(t,n,i){if(!t)return null;n?"function"==typeof n&&(n={onLoad:n}):n={};var r=t,s=paper;function a(t){paper=s;var e=I(t,n,i),r=n.onLoad,a=s.project&&s.getView();r&&r.call(this,e),a.update()}if(i)if("string"!=typeof t||/^.*</.test(t)){if("undefined"!=typeof File&&t instanceof File){var o=new FileReader;return o.onload=function(){a(o.result)},o.readAsText(t)}}else{if(!(r=document.getElementById(t)))return J("get",t,a);t=null}if("string"==typeof t&&(r=(new DOMParser).parseFromString(t,"image/svg+xml")),!r.nodeName)throw new Error("Unsupported SVG source: "+t);var h,u=r.nodeName.toLowerCase(),l=c[u],d=r.getAttribute&&r.getAttribute("data-paper-data"),f=s.settings,_=f.applyMatrix;if(f.applyMatrix=!1,h=l&&l(r,u,n,i)||null,f.applyMatrix=_,h){"#document"===u||h instanceof y||(h=S(h,r,i));var g=n.onImport;g&&(h=g(r,h,n)||h),n.expandShapes&&h instanceof x&&(h.remove(),h=h.toPath()),d&&(h._data=JSON.parse(d))}return i&&(P={},h&&e.pick(n.applyMatrix,_)&&h.matrix.apply(!0,!0)),h}m.inject({importSVG:function(t,e){return this.addChild(I(t,e,!0))}}),p.inject({importSVG:function(t,e){return this.activate(),I(t,e,!0)}})},e.exports.PaperScript=function(){var t,n,r=this;n=function(t){"use strict";function e(t){for(var e in J=t||{},tt)Object.prototype.hasOwnProperty.call(J,e)||(J[e]=tt[e]);Q=J.sourceFile||null}function n(t,e){var n=et(Y,t);e+=" ("+n.line+":"+n.column+")";var i=new SyntaxError(e);throw i.pos=t,i.loc=n,i.raisedAt=nt,i}function i(t){function e(t){if(1==t.length)return n+="return str === "+JSON.stringify(t[0])+";";n+="switch(str){";for(var e=0;e<t.length;++e)n+="case "+JSON.stringify(t[e])+":";n+="return true}return false;"}t=t.split(" ");var n="",i=[];t:for(var r=0;r<t.length;++r){for(var s=0;s<i.length;++s)if(i[s][0].length==t[r].length){i[s].push(t[r]);continue t}i.push([t[r]])}if(i.length>3){for(i.sort((function(t,e){return e.length-t.length})),n+="switch(str.length){",r=0;r<i.length;++r){var a=i[r];n+="case "+a[0].length+":",e(a)}n+="}"}else e(t);return new Function("str",n)}function r(){this.line=lt,this.column=nt-ct}function s(){lt=1,nt=ct=0,ut=!0,u()}function a(t,e){rt=nt,J.locations&&(at=new r),ot=t,u(),ht=e,ut=t.beforeExpr}function o(){var t=J.onComment&&J.locations&&new r,e=nt,i=Y.indexOf("*/",nt+=2);if(-1===i&&n(nt-2,"Unterminated comment"),nt=i+2,J.locations){Le.lastIndex=e;for(var s;(s=Le.exec(Y))&&s.index<nt;)++lt,ct=s.index+s[0].length}J.onComment&&J.onComment(!0,Y.slice(e+2,i),e,nt,t,J.locations&&new r)}function h(){for(var t=nt,e=J.onComment&&J.locations&&new r,n=Y.charCodeAt(nt+=2);K>nt&&10!==n&&13!==n&&8232!==n&&8233!==n;)++nt,n=Y.charCodeAt(nt);J.onComment&&J.onComment(!1,Y.slice(t+2,nt),t,nt,e,J.locations&&new r)}function u(){for(;K>nt;){var t=Y.charCodeAt(nt);if(32===t)++nt;else if(13===t)++nt,10===(e=Y.charCodeAt(nt))&&++nt,J.locations&&(++lt,ct=nt);else if(10===t||8232===t||8233===t)++nt,J.locations&&(++lt,ct=nt);else if(t>8&&14>t)++nt;else if(47===t){var e;if(42===(e=Y.charCodeAt(nt+1)))o();else{if(47!==e)break;h()}}else if(160===t)++nt;else{if(!(t>=5760&&ze.test(String.fromCharCode(t))))break;++nt}}}function l(t){switch(t){case 46:return function(){var t=Y.charCodeAt(nt+1);return t>=48&&57>=t?g(!0):(++nt,a(se))}();case 40:return++nt,a(te);case 41:return++nt,a(ee);case 59:return++nt,a(ie);case 44:return++nt,a(ne);case 91:return++nt,a(Jt);case 93:return++nt,a(Yt);case 123:return++nt,a(Kt);case 125:return++nt,a(Qt);case 58:return++nt,a(re);case 63:return++nt,a(ae);case 48:var e=Y.charCodeAt(nt+1);if(120===e||88===e)return function(){nt+=2;var t=_(16);return null==t&&n(it+2,"Expected hexadecimal number"),Ne(Y.charCodeAt(nt))&&n(nt,"Identifier directly after number"),a(yt,t)}();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return g(!1);case 34:case 39:return function(t){nt++;for(var e="";;){nt>=K&&n(it,"Unterminated string constant");var i=Y.charCodeAt(nt);if(i===t)return++nt,a(xt,e);if(92===i){i=Y.charCodeAt(++nt);var r=/^[0-7]+/.exec(Y.slice(nt,nt+3));for(r&&(r=r[0]);r&&parseInt(r,8)>255;)r=r.slice(0,r.length-1);if("0"===r&&(r=null),++nt,r)vt&&n(nt-2,"Octal literal in strict mode"),e+=String.fromCharCode(parseInt(r,8)),nt+=r.length-1;else switch(i){case 110:e+="\n";break;case 114:e+="\r";break;case 120:e+=String.fromCharCode(p(2));break;case 117:e+=String.fromCharCode(p(4));break;case 85:e+=String.fromCharCode(p(8));break;case 116:e+="\t";break;case 98:e+="\b";break;case 118:e+="\v";break;case 102:e+="\f";break;case 48:e+="\0";break;case 13:10===Y.charCodeAt(nt)&&++nt;case 10:J.locations&&(ct=nt,++lt);break;default:e+=String.fromCharCode(i)}}else(13===i||10===i||8232===i||8233===i)&&n(it,"Unterminated string constant"),e+=String.fromCharCode(i),++nt}}(t);case 47:return function(){var t=Y.charCodeAt(nt+1);return ut?(++nt,f()):61===t?d(ue,2):d(oe,1)}();case 37:case 42:return 61===Y.charCodeAt(nt+1)?d(ue,2):d(xe,1);case 124:case 38:return function(t){var e=Y.charCodeAt(nt+1);return e===t?d(124===t?fe:_e,2):61===e?d(ue,2):d(124===t?ge:ve,1)}(t);case 94:return 61===Y.charCodeAt(nt+1)?d(ue,2):d(pe,1);case 43:case 45:return function(t){var e=Y.charCodeAt(nt+1);return e===t?45==e&&62==Y.charCodeAt(nt+2)&&Ee.test(Y.slice(ft,nt))?(nt+=3,h(),u(),c()):d(ce,2):61===e?d(ue,2):d(le,1)}(t);case 60:case 62:return function(t){var e=Y.charCodeAt(nt+1),n=1;return e===t?(n=62===t&&62===Y.charCodeAt(nt+2)?3:2,61===Y.charCodeAt(nt+n)?d(ue,n+1):d(we,n)):33==e&&60==t&&45==Y.charCodeAt(nt+2)&&45==Y.charCodeAt(nt+3)?(nt+=4,h(),u(),c()):(61===e&&(n=61===Y.charCodeAt(nt+2)?3:2),d(ye,n))}(t);case 61:case 33:return function(t){return 61===Y.charCodeAt(nt+1)?d(me,61===Y.charCodeAt(nt+2)?3:2):d(61===t?he:de,1)}(t);case 126:return d(de,1)}return!1}function c(t){if(t?nt=it+1:it=nt,J.locations&&(st=new r),t)return f();if(nt>=K)return a(Ct);var e=Y.charCodeAt(nt);if(Ne(e)||92===e)return m();var i=l(e);if(!1===i){var s=String.fromCharCode(e);if("\\"===s||Oe.test(s))return m();n(nt,"Unexpected character '"+s+"'")}return i}function d(t,e){var n=Y.slice(nt,nt+e);nt+=e,a(t,n)}function f(){for(var t,e,i=nt;;){nt>=K&&n(i,"Unterminated regular expression");var r=Y.charAt(nt);if(Ee.test(r)&&n(i,"Unterminated regular expression"),t)t=!1;else{if("["===r)e=!0;else if("]"===r&&e)e=!1;else if("/"===r&&!e)break;t="\\"===r}++nt}var s=Y.slice(i,nt);++nt;var o=v();return o&&!/^[gmsiy]*$/.test(o)&&n(i,"Invalid regexp flag"),a(wt,new RegExp(s,o))}function _(t,e){for(var n=nt,i=0,r=0,s=null==e?1/0:e;s>r;++r){var a,o=Y.charCodeAt(nt);if((a=o>=97?o-97+10:o>=65?o-65+10:o>=48&&57>=o?o-48:1/0)>=t)break;++nt,i=i*t+a}return nt===n||null!=e&&nt-n!==e?null:i}function g(t){var e=nt,i=!1,r=48===Y.charCodeAt(nt);t||null!==_(10)||n(e,"Invalid number"),46===Y.charCodeAt(nt)&&(++nt,_(10),i=!0);var s=Y.charCodeAt(nt);(69===s||101===s)&&((43===(s=Y.charCodeAt(++nt))||45===s)&&++nt,null===_(10)&&n(e,"Invalid number"),i=!0),Ne(Y.charCodeAt(nt))&&n(nt,"Identifier directly after number");var o,h=Y.slice(e,nt);return i?o=parseFloat(h):r&&1!==h.length?/[89]/.test(h)||vt?n(e,"Invalid number"):o=parseInt(h,8):o=parseInt(h,10),a(yt,o)}function p(t){var e=_(16,t);return null===e&&n(it,"Bad character escape sequence"),e}function v(){Ce=!1;for(var t,e=!0,i=nt;;){var r=Y.charCodeAt(nt);if(je(r))Ce&&(t+=Y.charAt(nt)),++nt;else{if(92!==r)break;Ce||(t=Y.slice(i,nt)),Ce=!0,117!=Y.charCodeAt(++nt)&&n(nt,"Expecting Unicode escape sequence \\uXXXX"),++nt;var s=p(4),a=String.fromCharCode(s);a||n(nt-1,"Invalid Unicode escape"),(e?Ne(s):je(s))||n(nt-4,"Invalid Unicode escape"),t+=a}e=!1}return Ce?t:Y.slice(i,nt)}function m(){var t=v(),e=bt;return Ce||(Me(t)?e=Xt[t]:(J.forbidReserved&&(3===J.ecmaVersion?Se:Pe)(t)||vt&&ke(t))&&n(it,"The keyword '"+t+"' is reserved")),a(e,t)}function y(){dt=it,ft=rt,_t=at,c()}function w(t){if(vt=t,nt=ft,J.locations)for(;ct>nt;)ct=Y.lastIndexOf("\n",ct-2)+1,--lt;u(),c()}function x(){this.type=null,this.start=it,this.end=null}function b(){this.start=st,this.end=null,null!==Q&&(this.source=Q)}function C(){var t=new x;return J.locations&&(t.loc=new b),J.ranges&&(t.range=[it,0]),t}function S(t){var e=new x;return e.start=t.start,J.locations&&(e.loc=new b,e.loc.start=t.loc.start),J.ranges&&(e.range=[t.range[0],0]),e}function P(t,e){return t.type=e,t.end=ft,J.locations&&(t.loc.end=_t),J.ranges&&(t.range[1]=ft),t}function k(t){return J.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.value}function I(t){return ot===t?(y(),!0):void 0}function M(){return!J.strictSemicolons&&(ot===Ct||ot===Qt||Ee.test(Y.slice(ft,it)))}function z(){I(ie)||M()||O()}function A(t){ot===t?y():O()}function O(){n(it,"Unexpected token")}function T(t){"Identifier"!==t.type&&"MemberExpression"!==t.type&&n(t.start,"Assigning to rvalue"),vt&&"Identifier"===t.type&&Ie(t.name)&&n(t.start,"Assigning to "+t.name+" in strict mode")}function E(){(ot===oe||ot===ue&&"/="==ht)&&c(!0);var t=ot,e=C();switch(t){case St:case It:y();var i=t===St;I(ie)||M()?e.label=null:ot!==bt?O():(e.label=X(),z());for(var r=0;r<pt.length;++r){var s=pt[r];if(null==e.label||s.name===e.label.name){if(null!=s.kind&&(i||"loop"===s.kind))break;if(e.label&&i)break}}return r===pt.length&&n(e.start,"Unsyntactic "+t.keyword),P(e,i?"BreakStatement":"ContinueStatement");case Mt:return y(),z(),P(e,"DebuggerStatement");case At:return y(),pt.push(Be),e.body=E(),pt.pop(),A(qt),e.test=L(),z(),P(e,"DoWhileStatement");case Et:if(y(),pt.push(Be),A(te),ot===ie)return j(e,null);if(ot===Ft){var a=C();return y(),R(a,!0),P(a,"VariableDeclaration"),1===a.declarations.length&&I($t)?B(e,a):j(e,a)}return a=D(!1,!0),I($t)?(T(a),B(e,a)):j(e,a);case Lt:return y(),G(e,!0);case Nt:return y(),e.test=L(),e.consequent=E(),e.alternate=I(Ot)?E():null,P(e,"IfStatement");case jt:return gt||n(it,"'return' outside of function"),y(),I(ie)||M()?e.argument=null:(e.argument=D(),z()),P(e,"ReturnStatement");case Bt:y(),e.discriminant=L(),e.cases=[],A(Kt),pt.push(Re);for(var o,h;ot!=Qt;)if(ot===Pt||ot===zt){var u=ot===Pt;o&&P(o,"SwitchCase"),e.cases.push(o=C()),o.consequent=[],y(),u?o.test=D():(h&&n(dt,"Multiple default clauses"),h=!0,o.test=null),A(re)}else o||O(),o.consequent.push(E());return o&&P(o,"SwitchCase"),y(),pt.pop(),P(e,"SwitchStatement");case Rt:return y(),Ee.test(Y.slice(ft,it))&&n(ft,"Illegal newline after throw"),e.argument=D(),z(),P(e,"ThrowStatement");case Dt:if(y(),e.block=N(),e.handler=null,ot===kt){var l=C();y(),A(te),l.param=X(),vt&&Ie(l.param.name)&&n(l.param.start,"Binding "+l.param.name+" in strict mode"),A(ee),l.guard=null,l.body=N(),e.handler=P(l,"CatchClause")}return e.guardedHandlers=mt,e.finalizer=I(Tt)?N():null,e.handler||e.finalizer||n(e.start,"Missing catch or finally clause"),P(e,"TryStatement");case Ft:return y(),R(e),z(),P(e,"VariableDeclaration");case qt:return y(),e.test=L(),pt.push(Be),e.body=E(),pt.pop(),P(e,"WhileStatement");case Vt:return vt&&n(it,"'with' in strict mode"),y(),e.object=L(),e.body=E(),P(e,"WithStatement");case Kt:return N();case ie:return y(),P(e,"EmptyStatement");default:var d=ht,f=D();if(t===bt&&"Identifier"===f.type&&I(re)){for(r=0;r<pt.length;++r)pt[r].name===d&&n(f.start,"Label '"+d+"' is already declared");var _=ot.isLoop?"loop":ot===Bt?"switch":null;return pt.push({name:d,kind:_}),e.body=E(),pt.pop(),e.label=f,P(e,"LabeledStatement")}return e.expression=f,z(),P(e,"ExpressionStatement")}}function L(){A(te);var t=D();return A(ee),t}function N(t){var e,n=C(),i=!0,r=!1;for(n.body=[],A(Kt);!I(Qt);){var s=E();n.body.push(s),i&&t&&k(s)&&(e=r,w(r=!0)),i=!1}return r&&!e&&w(!1),P(n,"BlockStatement")}function j(t,e){return t.init=e,A(ie),t.test=ot===ie?null:D(),A(ie),t.update=ot===ee?null:D(),A(ee),t.body=E(),pt.pop(),P(t,"ForStatement")}function B(t,e){return t.left=e,t.right=D(),A(ee),t.body=E(),pt.pop(),P(t,"ForInStatement")}function R(t,e){for(t.declarations=[],t.kind="var";;){var i=C();if(i.id=X(),vt&&Ie(i.id.name)&&n(i.id.start,"Binding "+i.id.name+" in strict mode"),i.init=I(he)?D(!0,e):null,t.declarations.push(P(i,"VariableDeclarator")),!I(ne))break}return t}function D(t,e){var n=F(e);if(!t&&ot===ne){var i=S(n);for(i.expressions=[n];I(ne);)i.expressions.push(F(e));return P(i,"SequenceExpression")}return n}function F(t){var e=function(t){var e=function(t){return q(V(),-1,t)}(t);if(I(ae)){var n=S(e);return n.test=e,n.consequent=D(!0),A(re),n.alternate=D(!0,t),P(n,"ConditionalExpression")}return e}(t);if(ot.isAssign){var n=S(e);return n.operator=ht,n.left=e,y(),n.right=F(t),T(e),P(n,"AssignmentExpression")}return e}function q(t,e,n){var i=ot.binop;if(null!=i&&(!n||ot!==$t)&&i>e){var r=S(t);return r.left=t,r.operator=ht,y(),r.right=q(V(),i,n),q(P(r,/&&|\|\|/.test(r.operator)?"LogicalExpression":"BinaryExpression"),e,n)}return t}function V(){if(ot.prefix){var t=C(),e=ot.isUpdate;return t.operator=ht,t.prefix=!0,ut=!0,y(),t.argument=V(),e?T(t.argument):vt&&"delete"===t.operator&&"Identifier"===t.argument.type&&n(t.start,"Deleting local variable in strict mode"),P(t,e?"UpdateExpression":"UnaryExpression")}for(var i=H(Z());ot.postfix&&!M();)(t=S(i)).operator=ht,t.prefix=!1,t.argument=i,T(i),y(),i=P(t,"UpdateExpression");return i}function H(t,e){var n;return I(se)?((n=S(t)).object=t,n.property=X(!0),n.computed=!1,H(P(n,"MemberExpression"),e)):I(Jt)?((n=S(t)).object=t,n.property=D(),n.computed=!0,A(Yt),H(P(n,"MemberExpression"),e)):!e&&I(te)?((n=S(t)).callee=t,n.arguments=$(ee,!1),H(P(n,"CallExpression"),e)):t}function Z(){switch(ot){case Zt:var t=C();return y(),P(t,"ThisExpression");case bt:return X();case yt:case xt:case wt:return(t=C()).value=ht,t.raw=Y.slice(it,rt),y(),P(t,"Literal");case Ut:case Wt:case Gt:return(t=C()).value=ot.atomValue,t.raw=ot.keyword,y(),P(t,"Literal");case te:var e=st,n=it;y();var i=D();return i.start=n,i.end=rt,J.locations&&(i.loc.start=e,i.loc.end=at),J.ranges&&(i.range=[n,rt]),A(ee),i;case Jt:return t=C(),y(),t.elements=$(Yt,!0,!0),P(t,"ArrayExpression");case Kt:return U();case Lt:return t=C(),y(),G(t,!1);case Ht:return function(){var t=C();return y(),t.callee=H(Z(),!0),t.arguments=I(te)?$(ee,!1):mt,P(t,"NewExpression")}();default:O()}}function U(){var t=C(),e=!0,i=!1;for(t.properties=[],y();!I(Qt);){if(e)e=!1;else if(A(ne),J.allowTrailingCommas&&I(Qt))break;var r,s={key:W()},a=!1;if(I(re)?(s.value=D(!0),r=s.kind="init"):J.ecmaVersion>=5&&"Identifier"===s.key.type&&("get"===s.key.name||"set"===s.key.name)?(a=i=!0,r=s.kind=s.key.name,s.key=W(),ot!==te&&O(),s.value=G(C(),!1)):O(),"Identifier"===s.key.type&&(vt||i))for(var o=0;o<t.properties.length;++o){var h=t.properties[o];if(h.key.name===s.key.name){var u=r==h.kind||a&&"init"===h.kind||"init"===r&&("get"===h.kind||"set"===h.kind);u&&!vt&&"init"===r&&"init"===h.kind&&(u=!1),u&&n(s.key.start,"Redefinition of property")}}t.properties.push(s)}return P(t,"ObjectExpression")}function W(){return ot===yt||ot===xt?Z():X(!0)}function G(t,e){ot===bt?t.id=X():e?O():t.id=null,t.params=[];var i=!0;for(A(te);!I(ee);)i?i=!1:A(ne),t.params.push(X());var r=gt,s=pt;if(gt=!0,pt=[],t.body=N(!0),gt=r,pt=s,vt||t.body.body.length&&k(t.body.body[0]))for(var a=t.id?-1:0;a<t.params.length;++a){var o=0>a?t.id:t.params[a];if((ke(o.name)||Ie(o.name))&&n(o.start,"Defining '"+o.name+"' in strict mode"),a>=0)for(var h=0;a>h;++h)o.name===t.params[h].name&&n(o.start,"Argument name clash in strict mode")}return P(t,e?"FunctionDeclaration":"FunctionExpression")}function $(t,e,n){for(var i=[],r=!0;!I(t);){if(r)r=!1;else if(A(ne),e&&J.allowTrailingCommas&&I(t))break;n&&ot===ne?i.push(null):i.push(D(!0))}return i}function X(t){var e=C();return e.name=ot===bt?ht:t&&!J.forbidReserved&&ot.keyword||O(),ut=!1,y(),P(e,"Identifier")}var J,Y,K,Q;t.version="0.4.0",t.parse=function(t,n){return Y=String(t),K=Y.length,e(n),s(),function(t){dt=ft=nt,J.locations&&(_t=new r),gt=vt=null,pt=[],c();var e=t||C(),n=!0;for(t||(e.body=[]);ot!==Ct;){var i=E();e.body.push(i),n&&k(i)&&w(!0),n=!1}return P(e,"Program")}(J.program)};var tt=t.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null},et=t.getLineInfo=function(t,e){for(var n=1,i=0;;){Le.lastIndex=i;var r=Le.exec(t);if(!(r&&r.index<e))break;++n,i=r.index+r[0].length}return{line:n,column:e-i}};t.tokenize=function(t,n){function i(t){return c(t),r.start=it,r.end=rt,r.startLoc=st,r.endLoc=at,r.type=ot,r.value=ht,r}Y=String(t),K=Y.length,e(n),s();var r={};return i.jumpTo=function(t,e){if(nt=t,J.locations){lt=1,ct=Le.lastIndex=0;for(var n;(n=Le.exec(Y))&&n.index<t;)++lt,ct=n.index+n[0].length}ut=e,u()},i};var nt,it,rt,st,at,ot,ht,ut,lt,ct,dt,ft,_t,gt,pt,vt,mt=[],yt={type:"num"},wt={type:"regexp"},xt={type:"string"},bt={type:"name"},Ct={type:"eof"},St={keyword:"break"},Pt={keyword:"case",beforeExpr:!0},kt={keyword:"catch"},It={keyword:"continue"},Mt={keyword:"debugger"},zt={keyword:"default"},At={keyword:"do",isLoop:!0},Ot={keyword:"else",beforeExpr:!0},Tt={keyword:"finally"},Et={keyword:"for",isLoop:!0},Lt={keyword:"function"},Nt={keyword:"if"},jt={keyword:"return",beforeExpr:!0},Bt={keyword:"switch"},Rt={keyword:"throw",beforeExpr:!0},Dt={keyword:"try"},Ft={keyword:"var"},qt={keyword:"while",isLoop:!0},Vt={keyword:"with"},Ht={keyword:"new",beforeExpr:!0},Zt={keyword:"this"},Ut={keyword:"null",atomValue:null},Wt={keyword:"true",atomValue:!0},Gt={keyword:"false",atomValue:!1},$t={keyword:"in",binop:7,beforeExpr:!0},Xt={break:St,case:Pt,catch:kt,continue:It,debugger:Mt,default:zt,do:At,else:Ot,finally:Tt,for:Et,function:Lt,if:Nt,return:jt,switch:Bt,throw:Rt,try:Dt,var:Ft,while:qt,with:Vt,null:Ut,true:Wt,false:Gt,new:Ht,in:$t,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Zt,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},Jt={type:"[",beforeExpr:!0},Yt={type:"]"},Kt={type:"{",beforeExpr:!0},Qt={type:"}"},te={type:"(",beforeExpr:!0},ee={type:")"},ne={type:",",beforeExpr:!0},ie={type:";",beforeExpr:!0},re={type:":",beforeExpr:!0},se={type:"."},ae={type:"?",beforeExpr:!0},oe={binop:10,beforeExpr:!0},he={isAssign:!0,beforeExpr:!0},ue={isAssign:!0,beforeExpr:!0},le={binop:9,prefix:!0,beforeExpr:!0},ce={postfix:!0,prefix:!0,isUpdate:!0},de={prefix:!0,beforeExpr:!0},fe={binop:1,beforeExpr:!0},_e={binop:2,beforeExpr:!0},ge={binop:3,beforeExpr:!0},pe={binop:4,beforeExpr:!0},ve={binop:5,beforeExpr:!0},me={binop:6,beforeExpr:!0},ye={binop:7,beforeExpr:!0},we={binop:8,beforeExpr:!0},xe={binop:10,beforeExpr:!0};for(var be in t.tokTypes={bracketL:Jt,bracketR:Yt,braceL:Kt,braceR:Qt,parenL:te,parenR:ee,comma:ne,semi:ie,colon:re,dot:se,question:ae,slash:oe,eq:he,name:bt,eof:Ct,num:yt,regexp:wt,string:xt},Xt)t.tokTypes["_"+be]=Xt[be];var Ce,Se=i("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Pe=i("class enum extends super const export import"),ke=i("implements interface let package private protected public static yield"),Ie=i("eval arguments"),Me=i("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),ze=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ae="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Oe=new RegExp("["+Ae+"]"),Te=new RegExp("["+Ae+"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿]"),Ee=/[\n\r\u2028\u2029]/,Le=/\r\n|[\n\r\u2028\u2029]/g,Ne=t.isIdentifierStart=function(t){return 65>t?36===t:91>t||(97>t?95===t:123>t||t>=170&&Oe.test(String.fromCharCode(t)))},je=t.isIdentifierChar=function(t){return 48>t?36===t:58>t||!(65>t)&&(91>t||(97>t?95===t:123>t||t>=170&&Te.test(String.fromCharCode(t))))},Be={kind:"loop"},Re={kind:"switch"}},n((t=this).acorn||(t.acorn={}));var s={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"equals","!=":"equals"},a={"-":"__negate","+":null},o=e.each(["add","subtract","multiply","divide","modulo","negate"],(function(t){this["__"+t]="#"+t}),{});function u(t,e,n){var i=s[e];if(t&&t[i]){var r=t[i](n);return"!="===e?!r:r}switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;case"%":return t%n;case"==":return t==n;case"!=":return t!=n}}function c(t,e){var n=a[t];if(n&&e&&e[n])return e[n]();switch(t){case"+":return+e;case"-":return-e}}function d(t,e){return r.acorn.parse(t,e)}function f(t,e,n){if(!t)return"";n=n||{},e=e||"";var i=[];function r(t){for(var e=0,n=i.length;e<n;e++){var r=i[e];if(r[0]>=t)break;t+=r[1]}return t}function o(e){return t.substring(r(e.range[0]),r(e.range[1]))}function h(e,n){for(var s=r(e.range[0]),a=r(e.range[1]),o=0,h=i.length-1;h>=0;h--)if(s>i[h][0]){o=h+1;break}i.splice(o,0,[s,n.length-a+s]),t=t.substring(0,s)+n+t.substring(a)}var u=null,l=paper.browser,c=l.versionNumber,f=/\r\n|\n|\r/gm;if(l.chrome&&c>=30||l.webkit&&c>=537.76||l.firefox&&c>=23){var _=0;if(0===window.location.href.indexOf(e)){var g=document.getElementsByTagName("html")[0].innerHTML;_=g.substr(0,g.indexOf(t)+1).match(f).length+1}var p=["AAAA"];p.length=(t.match(f)||[]).length+1+_,u={version:3,file:e,names:[],mappings:p.join(";AACA"),sourceRoot:"",sources:[e]};var v=n.source||!e&&t;v&&(u.sourcesContent=[v])}return function e(n,i){if(n){for(var u in n)if("range"!==u&&"loc"!==u){var l=n[u];if(Array.isArray(l))for(var c=0,d=l.length;c<d;c++)e(l[c],n);else l&&"object"==typeof l&&e(l,n)}switch(n.type){case"UnaryExpression":if(n.operator in a&&"Literal"!==n.argument.type){var f=o(n.argument);h(n,'$__("'+n.operator+'", '+f+")")}break;case"BinaryExpression":if(n.operator in s&&"Literal"!==n.left.type){var _=o(n.left),g=o(n.right),p=function(e,n){return t.substring(r(e.range[1]),r(n.range[0]))}(n.left,n.right),v=n.operator;h(n,"__$__("+_+","+p.replace(new RegExp("\\"+v),'"'+v+'"')+", "+g+")")}break;case"UpdateExpression":case"AssignmentExpression":var m=i&&i.type;if(!("ForStatement"===m||"BinaryExpression"===m&&/^[=!<>]/.test(i.operator)||"MemberExpression"===m&&i.computed))if("UpdateExpression"===n.type){var y="__$__("+(f=o(n.argument))+', "'+n.operator[0]+'", 1)',w=f+" = "+y;n.prefix||"AssignmentExpression"!==m&&"VariableDeclarator"!==m||(o(i.left||i.id)===f&&(w=y),w=f+"; "+w),h(n,w)}else if(/^.=$/.test(n.operator)&&"Literal"!==n.left.type){_=o(n.left),g=o(n.right);h(n,_+" = __$__("+_+', "'+n.operator[0]+'", '+g+")")}}}}(d(t,{ranges:!0})),u&&(t=new Array(_+1).join("\n")+t+"\n//# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(u))))+"\n//# sourceURL="+(e||"paperscript")),t}function _(t,n,i,r){paper=n;var s,a=n.getView(),o=/\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(t)?new X:null,l=o?o._events:[],d=["onFrame","onResize"].concat(l),_=[],g=[];function p(e,n){for(var i in e)!n&&/^_/.test(i)||!new RegExp("([\\b\\s\\W]|^)"+i.replace(/\$/g,"\\$")+"\\b").test(t)||(_.push(i),g.push(e[i]))}t=f(t,i,r),p({__$__:u,$__:c,paper:n,view:a,tool:o},!0),p(n),(d=e.each(d,(function(e){new RegExp("\\s+"+e+"\\b").test(t)&&(_.push(e),this.push(e+": "+e))}),[]).join(", "))&&(t+="\nreturn { "+d+" };");var v=paper.browser;if(v.chrome||v.firefox){var m=document.createElement("script"),y=document.head||document.getElementsByTagName("head")[0];v.firefox&&(t="\n"+t),m.appendChild(document.createTextNode("paper._execute = function("+_+") {"+t+"\n}")),y.appendChild(m),s=paper._execute,delete paper._execute,y.removeChild(m)}else s=Function(_,t);var w=s.apply(n,g)||{};e.each(l,(function(t){var e=w[t];e&&(o[t]=e)})),a&&(w.onResize&&a.setOnResize(w.onResize),a.emit("resize",{size:a.size,delta:new h}),w.onFrame&&a.setOnFrame(w.onFrame),a.update())}function g(t){if(/^text\/(?:x-|)paperscript$/.test(t.type)&&"true"!==i.getAttribute(t,"ignore")){var e=i.getAttribute(t,"canvas"),n=document.getElementById(e),r=t.src||t.getAttribute("data-src"),s=i.hasAttribute(t,"async"),a="data-paper-scope";if(!n)throw new Error('Unable to find canvas with id "'+e+'"');var o=i.get(n.getAttribute(a))||(new i).setup(n);return n.setAttribute(a,o._id),r?J("get",r,(function(t){_(t,o,r)}),s):_(t.innerHTML,o,t.baseURI),t.setAttribute("data-paper-ignore","true"),o}}function p(){e.each(document.getElementsByTagName("script"),g)}return h.inject(o),l.inject(o),j.inject(o),"complete"===document.readyState?setTimeout(p):q.add(window,{load:p}),{compile:f,execute:_,load:function(t){return t?g(t):p()},parse:d}}.call(this),paper=new(i.inject(e.exports,{enumerable:!0,Base:e,Numerical:a,Key:W})),"function"==typeof define&&define.amd?define("paper",paper):"object"==typeof module&&module&&(module.exports=paper),paper};
